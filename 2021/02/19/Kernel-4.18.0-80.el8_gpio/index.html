<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>Kernel-4.18.0-80.el8_gpio | oosTech.com</title>
  <meta name="description" content="Chinese translated version of Documentation&#x2F;gpio If you have any comment or update to the content, please contact theoriginal document maintainer directly.  However, if you have a problemcommunicating">
<meta property="og:type" content="article">
<meta property="og:title" content="Kernel-4.18.0-80.el8_gpio">
<meta property="og:url" content="http://www.oostech.com/2021/02/19/Kernel-4.18.0-80.el8_gpio/index.html">
<meta property="og:site_name" content="oosTech">
<meta property="og:description" content="Chinese translated version of Documentation&#x2F;gpio If you have any comment or update to the content, please contact theoriginal document maintainer directly.  However, if you have a problemcommunicating">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-02-18T16:00:00.000Z">
<meta property="article:modified_time" content="2021-02-18T16:00:00.000Z">
<meta property="article:author" content="Sam Lee">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.oostech.com/2021/02/19/Kernel-4.18.0-80.el8_gpio/index.html">
  
    <link rel="alternate" href="/atom.xml" title="oosTech" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img src="/images/avatar.png" width="400" height="400">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">oosTech by Sam Lee</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="站内搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">站点首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档文档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">文档分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">常用链接</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">共享白板</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告牌</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p> 欢迎来到oosTech ，我是一个Linux 拥趸：D。 目前正在用的Linux 版本是 Red Hat Enterprise Linux release 8.3 </p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">文档分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a><span class="category-list-count">1658</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-4-18-0-80-el8-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_4.18.0-80.el8_内核文档</a><span class="category-list-count">3937</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_mpc5200/" class="title">Kernel-3.10.0-957.el7_mpc5200</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3270/" class="title">Kernel-3.10.0-957.el7_3270</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_4CCs/" class="title">Kernel-3.10.0-957.el7_4CCs</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_53c700/" class="title">Kernel-3.10.0-957.el7_53c700</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_6pack/" class="title">Kernel-3.10.0-957.el7_6pack</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#a%C2%BB%C2%A5a%C2%B8%C2%8Ba%C2%B8%C2%BAae%C2%AD%C2%A3ae%C2%96%C2%87"><span class="toc-number">1.</span> <span class="toc-text">ä»¥ä¸ä¸ºæ­£æ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#a%C2%BB%C2%80a%C2%B9%C2%88ae%C2%98%C2%AFGPIO"><span class="toc-number"></span> <span class="toc-text">ä»ä¹æ¯GPIO?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GPIO-a%C2%85%C2%ACc%C2%BA%C2%A6"><span class="toc-number"></span> <span class="toc-text">GPIO å¬çº¦</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ae-%C2%87e%C2%AF%C2%86-GPIO"><span class="toc-number">1.</span> <span class="toc-text">æ è¯ GPIO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a%C2%BD%C2%BFc%C2%94%C2%A8-GPIO"><span class="toc-number">2.</span> <span class="toc-text">ä½¿ç¨ GPIO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#e%C2%AE%C2%BFe%C2%97%C2%AEe%C2%87%C2%AAae%C2%97%C2%8Be%C2%94%C2%81a%C2%AE%C2%89a%C2%85%C2%A8c%C2%9A%C2%84-GPIO"><span class="toc-number">3.</span> <span class="toc-text">è®¿é®èªæéå®å¨ç GPIO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#e%C2%AE%C2%BFe%C2%97%C2%AEa%C2%8F%C2%AFe%C2%83%C2%BDa%C2%BC%C2%91coe-c%C2%9A%C2%84-GPIO"><span class="toc-number">4.</span> <span class="toc-text">è®¿é®å¯è½ä¼ç ç GPIO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gpio-request-one"><span class="toc-number">5.</span> <span class="toc-text">gpio_request_one()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gpio-request-array"><span class="toc-number">6.</span> <span class="toc-text">gpio_request_array()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gpio-free-array"><span class="toc-number">7.</span> <span class="toc-text">gpio_free_array()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a%C2%A3%C2%B0ae%C2%98%C2%8Ea%C2%92OEe%C2%87%C2%8Aae%C2%94%C2%BE-GPIO"><span class="toc-number">8.</span> <span class="toc-text">å£°æåéæ¾ GPIO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GPIO-ae%C2%98-a%C2%B0%C2%84a%C2%88%C2%B0-IRQ"><span class="toc-number">9.</span> <span class="toc-text">GPIO æ å°å° IRQ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ae%C2%A8%C2%A1ae%C2%8B%C2%9Fa%C2%BC%C2%80ae%C2%BC%C2%8Fa%C2%BF%C2%A1a%C2%8F%C2%B7"><span class="toc-number">10.</span> <span class="toc-text">æ¨¡æå¼æ¼ä¿¡å·</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#e%C2%BF%C2%99a%C2%BA%C2%9Ba%C2%85%C2%ACc%C2%BA%C2%A6a%C2%BF%C2%BDc%C2%95%C2%A5a%C2%BA%C2%86a%C2%BB%C2%80a%C2%B9%C2%88"><span class="toc-number"></span> <span class="toc-text">è¿äºå¬çº¦å¿½ç¥äºä»ä¹?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GPIO-a%C2%AE%C2%9Ec%C2%8E%C2%B0e%C2%80%C2%85c%C2%9A%C2%84ae%C2%A1%C2%86ae%C2%9E%C2%B6-a%C2%8F%C2%AFe%C2%80%C2%89"><span class="toc-number"></span> <span class="toc-text">GPIO å®ç°èçæ¡æ¶ (å¯é)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ae%C2%8E%C2%A7a%C2%88%C2%B6a%C2%99%C2%A8e%C2%A9%C2%B1a%C2%8A%C2%A8-gpio-chip"><span class="toc-number">1.</span> <span class="toc-text">æ§å¶å¨é©±å¨: gpio_chip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a%C2%B9%C2%B3a%C2%8F%C2%B0ae%C2%94%C2%AFaeOE%C2%81"><span class="toc-number">2.</span> <span class="toc-text">å¹³å°æ¯æ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ae%C2%9D%C2%BFc%C2%BA%C2%A7ae%C2%94%C2%AFaeOE%C2%81"><span class="toc-number">3.</span> <span class="toc-text">æ¿çº§æ¯æ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#c%C2%94%C2%A8ae%C2%88%C2%B7c%C2%A9%C2%BAe%C2%97%C2%B4c%C2%9A%C2%84-Sysfs-ae%C2%8E%C2%A5a%C2%8F%C2%A3-a%C2%8F%C2%AFe%C2%80%C2%89"><span class="toc-number"></span> <span class="toc-text">ç¨æ·ç©ºé´ç Sysfs æ¥å£(å¯é)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Sysfs-a%C2%B8%C2%ADc%C2%9A%C2%84e%C2%B7%C2%AFa%C2%BE%C2%84"><span class="toc-number">1.</span> <span class="toc-text">Sysfs ä¸­çè·¯å¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a%C2%BB%C2%8Ea%C2%86%C2%85ae-%C2%B8a%C2%BB%C2%A3c-%C2%81a%C2%B8%C2%ADa%C2%AF%C2%BCa%C2%87%C2%BA"><span class="toc-number">2.</span> <span class="toc-text">ä»åæ ¸ä»£ç ä¸­å¯¼åº</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Kernel-4.18.0-80.el8_gpio" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Kernel-4.18.0-80.el8_gpio
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/02/19/Kernel-4.18.0-80.el8_gpio/" class="article-date">
	 published: <time datetime="2021-02-18T16:00:00.000Z" itemprop="datePublished">2021-02-19</time>
	</a>
</span>

        
	<a href="/2021/02/19/Kernel-4.18.0-80.el8_gpio/" class="article-date">
	   updated: <time datetime="2021-02-18T16:00:00.000Z" itemprop="dateUpdated">2021-02-19</time>
	</a>


        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Kernel-4-18-0-80-el8-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_4.18.0-80.el8_内核文档</a>
  </span>

        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill"></i>
	    <!--<span id="busuanzi_container_page_pv" style="display:inline;">-->
			<span id="busuanzi_value_page_pv" style="display:inline;"></span>
		<!--</span>-->
	</span>



        <!--<span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/02/19/Kernel-4.18.0-80.el8_gpio/#comments" class="article-comment-link">评论</a></span> -->
        
	
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p>Chinese translated version of Documentation/gpio</p>
<p>If you have any comment or update to the content, please contact the<br>original document maintainer directly.  However, if you have a problem<br>communicating in English you can also ask the Chinese maintainer for<br>help.  Contact the Chinese maintainer if this translation is outdated<br>or if there is a problem with the translation.</p>
<p>Maintainer: Grant Likely <a href="mailto:&#x67;&#114;&#97;&#x6e;&#116;&#x2e;&#108;&#x69;&#x6b;&#x65;&#108;&#x79;&#64;&#x73;&#x65;&#x63;&#114;&#x65;&#116;&#x6c;&#97;&#98;&#x2e;&#x63;&#97;">&#x67;&#114;&#97;&#x6e;&#116;&#x2e;&#108;&#x69;&#x6b;&#x65;&#108;&#x79;&#64;&#x73;&#x65;&#x63;&#114;&#x65;&#116;&#x6c;&#97;&#98;&#x2e;&#x63;&#97;</a><br>        Linus Walleij <a href="mailto:&#108;&#x69;&#110;&#x75;&#115;&#46;&#x77;&#97;&#108;&#x6c;&#101;&#105;&#106;&#64;&#108;&#x69;&#110;&#x61;&#x72;&#x6f;&#46;&#x6f;&#114;&#x67;">&#108;&#x69;&#110;&#x75;&#115;&#46;&#x77;&#97;&#108;&#x6c;&#101;&#105;&#106;&#64;&#108;&#x69;&#110;&#x61;&#x72;&#x6f;&#46;&#x6f;&#114;&#x67;</a><br>Chinese maintainer: Fu Wei <a href="mailto:&#116;&#101;&#x6b;&#107;&#x61;&#109;&#97;&#x6e;&#x6e;&#x69;&#110;&#106;&#x61;&#64;&#103;&#x6d;&#97;&#105;&#x6c;&#x2e;&#x63;&#x6f;&#x6d;">&#116;&#101;&#x6b;&#107;&#x61;&#109;&#97;&#x6e;&#x6e;&#x69;&#110;&#106;&#x61;&#64;&#103;&#x6d;&#97;&#105;&#x6c;&#x2e;&#x63;&#x6f;&#x6d;</a></p>
<hr>
<p>Documentation/gpio çä¸­æç¿»è¯</p>
<p>å¦ææ³è¯è®ºææ´æ°æ¬æçåå®¹ï¼è¯·ç´æ¥èç³»åææ¡£çç»´æ¤èãå¦æä½ ä½¿ç¨è±æ<br>äº¤æµæå°é¾çè¯ï¼ä¹å¯ä»¥åä¸­æçç»´æ¤èæ±å©ãå¦ææ¬ç¿»è¯æ´æ°ä¸åæ¶æèç¿»<br>è¯å­å¨é®é¢ï¼è¯·èç³»ä¸­æçç»´æ¤èã<br>è±æçç»´æ¤èï¼ Grant Likely <a href="mailto:&#x67;&#x72;&#97;&#110;&#116;&#46;&#108;&#105;&#x6b;&#101;&#x6c;&#x79;&#64;&#115;&#101;&#x63;&#x72;&#101;&#x74;&#x6c;&#97;&#x62;&#46;&#x63;&#97;">&#x67;&#x72;&#97;&#110;&#116;&#46;&#108;&#105;&#x6b;&#101;&#x6c;&#x79;&#64;&#115;&#101;&#x63;&#x72;&#101;&#x74;&#x6c;&#97;&#x62;&#46;&#x63;&#97;</a><br>        Linus Walleij <a href="mailto:&#x6c;&#105;&#x6e;&#117;&#x73;&#46;&#x77;&#97;&#x6c;&#x6c;&#101;&#x69;&#x6a;&#x40;&#108;&#x69;&#x6e;&#97;&#x72;&#111;&#46;&#111;&#114;&#103;">&#x6c;&#105;&#x6e;&#117;&#x73;&#46;&#x77;&#97;&#x6c;&#x6c;&#101;&#x69;&#x6a;&#x40;&#108;&#x69;&#x6e;&#97;&#x72;&#111;&#46;&#111;&#114;&#103;</a><br>ä¸­æçç»´æ¤èï¼ åç Fu Wei <a href="mailto:&#116;&#101;&#107;&#107;&#x61;&#x6d;&#x61;&#110;&#x6e;&#105;&#x6e;&#106;&#x61;&#64;&#x67;&#x6d;&#97;&#x69;&#108;&#46;&#x63;&#x6f;&#x6d;">&#116;&#101;&#107;&#107;&#x61;&#x6d;&#x61;&#110;&#x6e;&#105;&#x6e;&#106;&#x61;&#64;&#x67;&#x6d;&#97;&#x69;&#108;&#46;&#x63;&#x6f;&#x6d;</a><br>ä¸­æçç¿»è¯èï¼ åç Fu Wei <a href="mailto:&#x74;&#101;&#x6b;&#107;&#x61;&#109;&#x61;&#x6e;&#110;&#x69;&#x6e;&#106;&#x61;&#64;&#x67;&#x6d;&#x61;&#105;&#x6c;&#46;&#99;&#x6f;&#x6d;">&#x74;&#101;&#x6b;&#107;&#x61;&#109;&#x61;&#x6e;&#110;&#x69;&#x6e;&#106;&#x61;&#64;&#x67;&#x6d;&#x61;&#105;&#x6c;&#46;&#99;&#x6f;&#x6d;</a><br>ä¸­æçæ ¡è¯èï¼ åç Fu Wei <a href="mailto:&#x74;&#101;&#107;&#x6b;&#x61;&#109;&#97;&#x6e;&#x6e;&#x69;&#110;&#x6a;&#97;&#64;&#x67;&#x6d;&#x61;&#105;&#x6c;&#46;&#99;&#x6f;&#109;">&#x74;&#101;&#107;&#x6b;&#x61;&#109;&#97;&#x6e;&#x6e;&#x69;&#110;&#x6a;&#97;&#64;&#x67;&#x6d;&#x61;&#105;&#x6c;&#46;&#99;&#x6f;&#109;</a></p>
<h2 id="a»¥a¸a¸ºae­£ae"><a href="#a»¥a¸a¸ºae­£ae" class="headerlink" title="ä»¥ä¸ä¸ºæ­£æ"></a>ä»¥ä¸ä¸ºæ­£æ</h2><p>GPIO æ¥å£</p>
<p>æ¬ææ¡£æä¾äºä¸ä¸ªå¨Linuxä¸è®¿é®GPIOçå¬çº¦æ¦è¿°ã</p>
<p>è¿äºå½æ°ä»¥ gpio_* ä½ä¸ºåç¼ãå¶ä»çå½æ°ä¸åè®¸ä½¿ç¨è¿æ ·çåç¼æç¸å³ç<br>__gpio_* åç¼ã</p>
<h1 id="a»a¹ae¯GPIO"><a href="#a»a¹ae¯GPIO" class="headerlink" title="ä»ä¹æ¯GPIO?"></a>ä»ä¹æ¯GPIO?</h1><p>“éç¨è¾å¥/è¾åºå£”(GPIO)æ¯ä¸ä¸ªçµæ´»çç±è½¯ä»¶æ§å¶çæ°å­ä¿¡å·ãä»ä»¬å¯<br>ç±å¤ç§è¯çæä¾,ä¸å¯¹äºä»äºåµå¥å¼åå®å¶ç¡¬ä»¶ç Linux å¼åèæ¥è¯´æ¯<br>æ¯è¾çæãæ¯ä¸ªGPIO é½ä»£è¡¨ä¸ä¸ªè¿æ¥å°ç¹å®å¼èæçæ éµå(BGA)å°è£ä¸­<br>âçç âçä¸ä¸ªä½ãçµè·¯æ¿åçå¾æ¾ç¤ºäº GPIO ä¸å¤é¨ç¡¬ä»¶çè¿æ¥å³ç³»ã<br>é©±å¨å¯ä»¥ç¼åæéç¨ä»£ç ï¼ä»¥ä½¿æ¿çº§å¯å¨ä»£ç å¯ä¼ éå¼èéç½®æ°æ®ç»é©±å¨ã</p>
<p>çä¸ç³»ç» (SOC) å¤çå¨å¯¹ GPIO æå¾å¤§çä¾èµãå¨æäºæåµä¸,æ¯ä¸ª<br>éä¸ç¨å¼èé½å¯éç½®ä¸º GPIO,ä¸å¤§å¤æ°è¯çé½æå°æä¸äº GPIOã<br>å¯ç¼ç¨é»è¾å¨ä»¶(ç±»ä¼¼ FPGA) å¯ä»¥æ¹ä¾¿å°æä¾ GPIOãåçµæºç®¡çå<br>é³é¢ç¼è§£ç å¨è¿æ ·çå¤åè½è¯çç»å¸¸çæä¸äºè¿æ ·çå¼èæ¥å¸®å©é£äºå¼è<br>å®ä¹ç SOCãåæ¶è¿æéè¿ I2C æ SPI ä¸²è¡æ»çº¿è¿æ¥çâGPIOæ©å±å¨â<br>è¯çãå¤§å¤æ° PC çåæ¡¥æä¸äºæ¥æ GPIO è½åçå¼è (åªæBIOS<br>åºä»¶æç¥éå¦ä½ä½¿ç¨ä»ä»¬)ã</p>
<p>GPIO çå®éåè½å ç³»ç»èå¼ãéå¸¸ç¨æ³æ:</p>
<ul>
<li><p>è¾åºå¼å¯å (é«çµå¹³=1ï¼ä½çµå¹³=0)ãä¸äºè¯çä¹æå¦ä½é©±å¨è¿äºå¼çéé¡¹,<br>ä¾å¦åªåè®¸è¾åºä¸ä¸ªå¼ãæ¯æâçº¿ä¸âåå¶ä»åå¼ç±»ä¼¼çæ¨¡å¼(å¼å¾æ³¨æçæ¯<br>âå¼æ¼âä¿¡å·)</p>
</li>
<li><p>è¾å¥å¼å¯è¯»(1ã0)ãä¸äºè¯çæ¯æå¼èå¨éç½®ä¸ºâè¾åºâæ¶åè¯»ï¼è¿å¯¹äºç±»ä¼¼<br>âçº¿ä¸âçæåµ(ä»¥æ¯æååä¿¡å·)æ¯éå¸¸æç¨çãGPIO æ§å¶å¨å¯è½æè¾å¥<br>å»æ¯åº/æ¶æé»è¾,è¿ææ¶éè¦è½¯ä»¶æ§å¶ã</p>
</li>
<li><p>è¾å¥éå¸¸å¯ä½ä¸º IRQ ä¿¡å·,ä¸è¬æ¯æ²¿è§¦å,ä½ææ¶æ¯çµå¹³è§¦åãè¿æ ·ç IRQ<br>å¯è½éç½®ä¸ºç³»ç»å¤éäºä»¶,ä»¥å°ç³»ç»ä»ä½åèç¶æä¸å¤éã</p>
</li>
<li><p>éå¸¸ä¸ä¸ª GPIO æ ¹æ®ä¸åäº§åçµè·¯æ¿çéæ±,å¯ä»¥éç½®ä¸ºè¾å¥æè¾åº,ä¹æä»<br>æ¯æååçã</p>
</li>
<li><p>å¤§é¨å GPIO å¯ä»¥å¨ææèªæéæ¶è®¿é®,ä½æ¯éå¸¸ç±ä¸²è¡æ»çº¿æ©å±ç GPIO<br>ä¸åè®¸ææèªæéãä½æäºç³»ç»ä¹æ¯æè¿ç§ç±»åã</p>
</li>
</ul>
<p>å¯¹äºç»å®ççµè·¯æ¿,æ¯ä¸ª GPIO é½ç¨äºæä¸ªç¹å®çç®ç,å¦çæ§ MMC/SD å¡ç<br>æå¥/ç§»é¤ãæ£æµå¡çåä¿æ¤ç¶æãé©±å¨ LEDãéç½®æ¶åå¨ãæ¨¡æä¸²è¡æ»çº¿ã<br>å¤ä½ç¡¬ä»¶çé¨çãæç¥å¼å³ç¶æç­ç­ã</p>
<h1 id="GPIO-a¬cº¦"><a href="#GPIO-a¬cº¦" class="headerlink" title="GPIO å¬çº¦"></a>GPIO å¬çº¦</h1><p>æ³¨æ,è¿ä¸ªå«åâå¬çº¦âï¼å ä¸ºè¿ä¸æ¯å¼ºå¶æ§çï¼ä¸éµå¾ªè¿ä¸ªå¬çº¦æ¯æ ä¼¤å¤§éçï¼<br>å ä¸ºæ­¤æ¶å¯ç§»æ¤æ§å¹¶ä¸éè¦ãGPIO å¸¸ç¨äºæ¿çº§ç¹å®ççµè·¯é»è¾,çè³å¯è½<br>éççµè·¯æ¿ççæ¬èæ¹åï¼ä¸ä¸å¯è½å¨ä¸åèµ°çº¿ççµè·¯æ¿ä¸ä½¿ç¨ãä»æå¨å°æ°<br>åè½ä¸æå·æå¯ç§»æ¤æ§ï¼å¶ä»åè½æ¯å¹³å°ç¹å®ãè¿ä¹æ¯ç±äºâè¶åâçé»è¾é æçã</p>
<p>æ­¤å¤ï¼è¿ä¸éè¦ä»»ä½çæ§è¡æ¡æ¶ï¼åªæ¯ä¸ä¸ªæ¥å£ãæä¸ªå¹³å°å¯è½éè¿ä¸ä¸ªç®åå°<br>è®¿é®è¯çå¯å­å¨çåèå½æ°æ¥å®ç°å®ï¼å¶ä»å¹³å°å¯è½éè¿å§æä¸ç³»åä¸åçGPIO<br>æ§å¶å¨çæ½è±¡å½æ°æ¥å®ç°å®ã(æä¸äºå¯éçä»£ç è½æ¯æè¿ç§ç­ç¥çå®ç°,æ¬ææ¡£<br>åé¢ä¼ä»ç»ï¼ä½ä½ä¸º GPIO æ¥å£çå®¢æ·ç«¯é©±å¨ç¨åºå¿é¡»ä¸å®çå®ç°æ å³ã)</p>
<p>ä¹å°±æ¯è¯´,å¦æå¨ä»ä»¬çå¹³å°ä¸æ¯æè¿ä¸ªå¬çº¦ï¼é©±å¨åºå°½å¯è½çä½¿ç¨å®ãåæ¶ï¼å¹³å°<br>å¿é¡»å¨ Kconfig ä¸­éæ© ARCH_REQUIRE_GPIOLIB æè ARCH_WANT_OPTIONAL_GPIOLIB<br>éé¡¹ãé£äºè°ç¨æ å GPIO å½æ°çé©±å¨åºè¯¥å¨ Kconfig å¥å£ä¸­å£°æä¾èµGENERIC_GPIOã<br>å½é©±å¨åå«æä»¶:</p>
<pre><code>#include &lt;linux/gpio.h&gt;
</code></pre>
<p>å GPIO å½æ°æ¯å¯ç¨,æ è®ºæ¯âçå®ä»£ç âè¿æ¯ç»ä¼åè¿çè¯­å¥ãå¦æä½ éµå®<br>è¿ä¸ªå¬çº¦ï¼å½ä½ çä»£ç å®æåï¼å¯¹å¶ä»çå¼åèæ¥è¯´ä¼æ´å®¹æçæåç»´æ¤ã</p>
<p>æ³¨æï¼è¿äºæä½åå«æç¨å¹³å°ç I/O å±éä»£ç ï¼é©±å¨æ é¡»æ¾å¼å°è°ç¨ä»ä»¬ã</p>
<h2 id="ae-e¯-GPIO"><a href="#ae-e¯-GPIO" class="headerlink" title="æ è¯ GPIO"></a>æ è¯ GPIO</h2><p>GPIO æ¯éè¿æ ç¬¦å·æ´åæ¥æ è¯ç,èå´æ¯ 0 å° MAX_INTãä¿çâè´âæ°<br>ç¨äºå¶ä»ç®ç,ä¾å¦æ è¯ä¿¡å·âå¨è¿ä¸ªæ¿å­ä¸ä¸å¯ç¨âææç¤ºéè¯¯ãæªæ¥è§¦åºå±<br>ç¡¬ä»¶çä»£ç ä¼å¿½ç¥è¿äºæ´æ°ã</p>
<p>å¹³å°ä¼å®ä¹è¿äºæ´æ°çç¨æ³,ä¸éå¸¸ä½¿ç¨ #define æ¥å®ä¹ GPIOï¼è¿æ ·<br>æ¿çº§ç¹å®çå¯å¨ä»£ç å¯ä»¥ç´æ¥å³èç¸åºçåçå¾ãç¸å¯¹æ¥è¯´ï¼é©±å¨åºè¯¥ä»ä½¿ç¨<br>å¯å¨ä»£ç ä¼ éè¿æ¥ç GPIO ç¼å·ï¼ä½¿ç¨ platform_data ä¿å­æ¿çº§ç¹å®<br>å¼èéç½®æ°æ® (åæ¶è¿æå¶ä»é¡»è¦çæ¿çº§ç¹å®æ°æ®)ï¼é¿åå¯è½åºç°çé®é¢ã</p>
<p>ä¾å¦ä¸ä¸ªå¹³å°ä½¿ç¨ç¼å· 32-159 æ¥æ è¯ GPIO,èå¨å¦ä¸ä¸ªå¹³å°ä½¿ç¨ç¼å·0-63<br>æ è¯ä¸ç» GPIO æ§å¶å¨,64-79æ è¯å¦ä¸ç±» GPIO æ§å¶å¨,ä¸å¨ä¸ä¸ªå«æ<br>FPGA çç¹å®æ¿å­ä¸ä½¿ç¨ 80-95ãç¼å·ä¸ä¸å®è¦è¿ç»­,é£äºå¹³å°ä¸­ï¼ä¹å¯ä»¥<br>ä½¿ç¨ç¼å·2000-2063æ¥æ è¯ä¸ä¸ª I2C æ¥å£ç GPIO æ©å±å¨ä¸­ç GPIOã</p>
<p>å¦æä½ è¦åå§åä¸ä¸ªå¸¦ææ æ GPIO ç¼å·çç»æä½,å¯ä»¥ä½¿ç¨ä¸äºè´ç¼ç <br>(å¦”-EINVAL”)ï¼é£å°ä½¿å¶æ°¸è¿ä¸ä¼æ¯ææãæ¥æµè¯è¿æ ·ä¸ä¸ªç»æä½ä¸­çç¼å·<br>æ¯å¦å³èä¸ä¸ª GPIOï¼ä½ å¯ä½¿ç¨ä»¥ä¸æ­è¨:</p>
<pre><code>int gpio_is_valid(int number);
</code></pre>
<p>å¦æç¼å·ä¸å­å¨ï¼åè¯·æ±åéæ¾ GPIO çå½æ°å°æç»æ§è¡ç¸å³æä½(è§ä¸æ)ã<br>å¶ä»ç¼å·ä¹å¯è½è¢«æç»,æ¯å¦ä¸ä¸ªç¼å·å¯è½å­å¨ï¼ä½ææ¶å¨ç»å®ççµè·¯ä¸ä¸å¯ç¨ã</p>
<p>ä¸ä¸ªå¹³å°æ¯å¦æ¯æå¤ä¸ª GPIO æ§å¶å¨ä¸ºå¹³å°ç¹å®çå®ç°é®é¢ï¼å°±åæ¯å¦å¯ä»¥<br>å¨ GPIO ç¼å·ç©ºé´ä¸­æâç©ºæ´âåæ¯å¦å¯ä»¥å¨è¿è¡æ¶æ·»å æ°çæ§å¶å¨ä¸æ ·ã<br>è¿äºé®é¢ä¼å½±åå¶ä»äºæï¼åæ¬ç¸é»ç GPIO ç¼å·æ¯å¦å­å¨ç­ã</p>
<h2 id="a½¿c¨-GPIO"><a href="#a½¿c¨-GPIO" class="headerlink" title="ä½¿ç¨ GPIO"></a>ä½¿ç¨ GPIO</h2><p>å¯¹äºä¸ä¸ª GPIOï¼ç³»ç»åºè¯¥åçç¬¬ä¸ä»¶äºæå°±æ¯éè¿ gpio_request()<br>å½æ°åéå®ï¼è§ä¸æã</p>
<p>æ¥ä¸æ¥æ¯è®¾ç½®I/Oæ¹åï¼è¿éå¸¸æ¯å¨æ¿çº§å¯å¨ä»£ç ä¸­ä¸ºæä½¿ç¨ç GPIO è®¾ç½®<br>platform_device æ¶å®æã</p>
<pre><code>/* è®¾ç½®ä¸ºè¾å¥æè¾åº, è¿å 0 æè´çéè¯¯ä»£ç  */
int gpio_direction_input(unsigned gpio);
int gpio_direction_output(unsigned gpio, int value);
</code></pre>
<p>è¿åå¼ä¸ºé¶ä»£è¡¨æåï¼å¦åè¿åä¸ä¸ªè´çéè¯¯ä»£ç ãè¿ä¸ªè¿åå¼éè¦æ£æ¥ï¼å ä¸º<br>get/set(è·å/è®¾ç½®)å½æ°è°ç¨æ²¡æ³è¿åéè¯¯,ä¸æå¯è½æ¯éç½®éè¯¯ãéå¸¸ï¼<br>ä½ åºè¯¥å¨è¿ç¨ä¸ä¸æä¸­è°ç¨è¿äºå½æ°ãç¶è,å¯¹äºèªæéå®å¨ç GPIOï¼å¨æ¿å­<br>å¯å¨çæ©æãè¿ç¨å¯å¨åä½¿ç¨ä»ä»¬ä¹æ¯å¯ä»¥çã</p>
<p>å¯¹äºä½ä¸ºè¾åºç GPIOï¼ä¸ºå¶æä¾åå§è¾åºå¼ï¼å¯¹äºé¿åå¨ç³»ç»å¯å¨æé´åºç°<br>ä¿¡å·æ¯åºæ¯å¾æå¸®å©çã</p>
<p>ä¸ºäºä¸ä¼ ç»ç GPIO æ¥å£å¼å®¹, å¨è®¾ç½®ä¸ä¸ª GPIO æ¹åæ¶ï¼å¦æå®è¿æªè¢«ç³è¯·ï¼<br>åéå«äºç³è¯·é£ä¸ª GPIO çæä½(è§ä¸æ)ãè¿ç§å¼å®¹æ§æ­£å¨ä»å¯éç gpiolib<br>æ¡æ¶ä¸­ç§»é¤ã</p>
<p>å¦æè¿ä¸ª GPIO ç¼ç ä¸å­å¨ï¼æèç¹å®ç GPIO ä¸è½ç¨äºé£ç§æ¨¡å¼ï¼åæ¹å<br>è®¾ç½®å¯è½å¤±è´¥ãä¾èµå¯å¨åºä»¶æ¥æ­£ç¡®å°è®¾ç½®æ¹åéå¸¸æ¯ä¸ä¸ªåä¸»æï¼å ä¸ºå®å¯è½<br>é¤äºå¯å¨Linuxï¼å¹¶æ²¡æåæ´å¤çéªè¯å·¥ä½ã(åç, æ¿å­çå¯å¨ä»£ç å¯è½éè¦<br>å°è¿ä¸ªå¤ç¨çå¼èè®¾ç½®ä¸º GPIOï¼å¹¶æ­£ç¡®å°éç½®ä¸æ/ä¸æçµé»ã)</p>
<h2 id="e®¿e®eªaeea®a¨c-GPIO"><a href="#e®¿e®eªaeea®a¨c-GPIO" class="headerlink" title="è®¿é®èªæéå®å¨ç GPIO"></a>è®¿é®èªæéå®å¨ç GPIO</h2><p>å¤§å¤æ° GPIO æ§å¶å¨å¯ä»¥éè¿åå­è¯»/åæä»¤æ¥è®¿é®ãè¿äºæä»¤ä¸ä¼ä¼ç ,å¯ä»¥<br>å®å¨å°å¨ç¡¬(éçº¿ç¨)ä¸­æ­ä¾ç¨åç±»ä¼¼çä¸ä¸æä¸­å®æã</p>
<p>å¯¹äºé£äºç¨ gpio_cansleep()æµè¯æ»æ¯è¿åå¤±è´¥ç GPIO(è§ä¸æ)ï¼ä½¿ç¨<br>ä»¥ä¸çå½æ°è®¿é®:</p>
<pre><code>/* GPIO è¾å¥:è¿åé¶æéé¶ */
int gpio_get_value(unsigned gpio);

/* GPIO è¾åº */
void gpio_set_value(unsigned gpio, int value);
</code></pre>
<p>GPIOå¼æ¯å¸å°å¼ï¼é¶è¡¨ç¤ºä½çµå¹³ï¼éé¶è¡¨ç¤ºé«çµå¹³ãå½è¯»åä¸ä¸ªè¾åºå¼èçå¼æ¶ï¼<br>è¿åå¼åºè¯¥æ¯å¼èä¸çå¼ãè¿ä¸ªå¼ä¸æ»æ¯åè¾åºå¼ç¸ç¬¦ï¼å ä¸ºå­å¨å¼æ¼è¾åºä¿¡å·å<br>è¾åºå»¶è¿é®é¢ã</p>
<p>ä»¥ä¸ç get/set å½æ°æ éè¯¯è¿åå¼ï¼å ä¸ºä¹å gpio_direction_*()åºå·²æ£æ¥è¿<br>å¶æ¯å¦ä¸ºâæ æGPIOâãæ­¤å¤ï¼è¿éè¦æ³¨æçæ¯å¹¶ä¸æ¯ææå¹³å°é½å¯ä»¥ä»è¾åºå¼è<br>ä¸­è¯»åæ°æ®ï¼å¯¹äºä¸è½è¯»åçå¼èåºæ»è¿åé¶ãå¦å¤ï¼å¯¹é£äºå¨åå­ä¸ä¸æä¸­æ æ³<br>å®å¨è®¿é®ç GPIO (è¯èæ³¨ï¼å ä¸ºè®¿é®å¯è½å¯¼è´ä¼ç )ä½¿ç¨è¿äºå½æ°æ¯ä¸åéç<br>(è§ä¸æ)ã</p>
<p>å¨ GPIO ç¼å·(è¿æè¾åºãå¼)ä¸ºå¸¸æ°çæåµä¸,é¼å±éè¿å¹³å°ç¹å®çå®ç°æ¥ä¼å<br>è¿ä¸¤ä¸ªå½æ°æ¥è®¿é® GPIO å¼ãè¿ç§æåµ(è¯»åä¸ä¸ªç¡¬ä»¶å¯å­å¨)ä¸åªéè¦å æ¡æä»¤<br>æ¯å¾æ­£å¸¸ç,ä¸æ é¡»èªæéãè¿ç§ä¼åå½æ°æ¯èµ·é£äºå¨å­ç¨åºä¸è±è´¹è®¸å¤æä»¤ç<br>å½æ°å¯ä»¥ä½¿å¾æ¨¡ææ¥å£(è¯èæ³¨:ä¾å¦ GPIO æ¨¡æ I2Cã1-wire æ SPI)ç<br>åºç¨(å¨ç©ºé´åæ¶é´ä¸é½)æ´å·æçã</p>
<h2 id="e®¿e®a¯e½a¼coe-c-GPIO"><a href="#e®¿e®a¯e½a¼coe-c-GPIO" class="headerlink" title="è®¿é®å¯è½ä¼ç ç GPIO"></a>è®¿é®å¯è½ä¼ç ç GPIO</h2><p>æäº GPIO æ§å¶å¨å¿é¡»éè¿åºäºæ»çº¿(å¦ I2C æ SPI)çæ¶æ¯è®¿é®ãè¯»æåè¿äº<br>GPIO å¼çå½ä»¤éè¦ç­å¾å¶ä¿¡æ¯æå°éé¦æåéå½ä»¤ï¼åè·å¾å¶åé¦ãæé´éè¦<br>ä¼ç ï¼è¿ä¸è½å¨ IRQ ä¾ç¨(ä¸­æ­ä¸ä¸æ)ä¸­æ§è¡ã</p>
<p>æ¯ææ­¤ç±» GPIO çå¹³å°éè¿ä»¥ä¸å½æ°è¿åéé¶å¼æ¥åºååºè¿ç§ GPIOã(æ­¤å½æ°éè¦<br>ä¸ä¸ªä¹åéè¿ gpio_request åéå°çææ GPIO ç¼å·):</p>
<pre><code>int gpio_cansleep(unsigned gpio);
</code></pre>
<p>ä¸ºäºè®¿é®è¿ç§ GPIO,åæ ¸å®ä¹äºä¸å¥ä¸åçå½æ°:</p>
<pre><code>/* GPIO è¾å¥:è¿åé¶æéé¶ ,å¯è½ä¼ä¼ç  */
int gpio_get_value_cansleep(unsigned gpio);

/* GPIO è¾åº,å¯è½ä¼ä¼ç  */
void gpio_set_value_cansleep(unsigned gpio, int value);
</code></pre>
<p>è®¿é®è¿æ ·ç GPIO éè¦ä¸ä¸ªåè®¸ä¼ç çä¸ä¸æï¼ä¾å¦çº¿ç¨ IRQ å¤çä¾ç¨ï¼å¹¶ç¨ä»¥ä¸ç<br>è®¿é®å½æ°æ¿æ¢é£äºæ²¡æ cansleep()åç¼çèªæéå®å¨è®¿é®å½æ°ã</p>
<p>é¤äºè¿äºè®¿é®å½æ°å¯è½ä¼ç ï¼ä¸å®ä»¬æä½ç GPIO ä¸è½å¨ç¡¬ä»¶ IRQ å¤çä¾ç¨ä¸­è®¿é®ç<br>äºå®ï¼è¿äºå¤çä¾ç¨å®éä¸åèªæéå®å¨çå½æ°æ¯ä¸æ ·çã</p>
<p>** é¤æ­¤ä¹å¤ ** è°ç¨è®¾ç½®åéç½®æ­¤ç±» GPIO çå½æ°ä¹å¿é¡»å¨åè®¸ä¼ç çä¸ä¸æä¸­ï¼<br>å ä¸ºå®ä»¬å¯è½ä¹éè¦è®¿é® GPIO æ§å¶å¨è¯ç: (è¿äºè®¾ç½®å½æ°éå¸¸å¨æ¿çº§å¯å¨ä»£ç æè<br>é©±å¨æ¢æµ/æ­å¼ä»£ç ä¸­ï¼æä»¥è¿æ¯ä¸ä¸ªå®¹ææ»¡è¶³ççº¦ææ¡ä»¶ã)</p>
<pre><code>gpio_direction_input()
gpio_direction_output()
gpio_request()
</code></pre>
<h2 id="gpio-request-one"><a href="#gpio-request-one" class="headerlink" title="gpio_request_one()"></a>gpio_request_one()</h2><h2 id="gpio-request-array"><a href="#gpio-request-array" class="headerlink" title="gpio_request_array()"></a>gpio_request_array()</h2><h2 id="gpio-free-array"><a href="#gpio-free-array" class="headerlink" title="gpio_free_array()"></a>gpio_free_array()</h2><pre><code>gpio_free()
gpio_set_debounce()
</code></pre>
<h2 id="a£°aeaOEeae¾-GPIO"><a href="#a£°aeaOEeae¾-GPIO" class="headerlink" title="å£°æåéæ¾ GPIO"></a>å£°æåéæ¾ GPIO</h2><p>ä¸ºäºæå©äºæè·ç³»ç»éç½®éè¯¯,å®ä¹äºä¸¤ä¸ªå½æ°ã</p>
<pre><code>/* ç³è¯· GPIO, è¿å 0 æè´çéè¯¯ä»£ç .
 * éç©ºæ ç­¾å¯è½æå©äºè¯æ­.
 */
int gpio_request(unsigned gpio, const char *label);

/* éæ¾ä¹åå£°æç GPIO */
void gpio_free(unsigned gpio);
</code></pre>
<p>å°æ æç GPIO ç¼ç ä¼ éç» gpio_request()ä¼å¯¼è´å¤±è´¥ï¼ç³è¯·ä¸ä¸ªå·²ä½¿ç¨è¿ä¸ª<br>å½æ°å£°æè¿ç GPIO ä¹ä¼å¤±è´¥ãgpio_request()çè¿åå¼å¿é¡»æ£æ¥ãä½ åºè¯¥å¨<br>è¿ç¨ä¸ä¸æä¸­è°ç¨è¿äºå½æ°ãç¶è,å¯¹äºèªæéå®å¨ç GPIO,å¨æ¿å­å¯å¨çæ©æã<br>è¿å¥è¿ç¨ä¹åæ¯å¯ä»¥ç³è¯·çã</p>
<p>è¿ä¸ªå½æ°å®æä¸¤ä¸ªåºæ¬çç®æ ãä¸æ¯æ è¯é£äºå®éä¸å·²ä½ä¸º GPIO ä½¿ç¨çä¿¡å·çº¿ï¼<br>è¿æ ·ä¾¿äºæ´å¥½å°è¯æ­;ç³»ç»å¯è½éè¦æå¡å ç¾ä¸ªå¯ç¨ç GPIOï¼ä½æ¯å¯¹äºä»»ä½ä¸ä¸ª<br>ç»å®ççµè·¯æ¿éå¸¸åªæä¸äºè¢«ä½¿ç¨ãå¦ä¸ä¸ªç®çæ¯æè·å²çªï¼æ¥æéè¯¯:å¦ä¸¤ä¸ªæ<br>æ´å¤é©±å¨éè¯¯å°è®¤ä¸ºä»ä»¬å·²ç»ç¬å äºæä¸ªä¿¡å·çº¿,ææ¯éè¯¯å°è®¤ä¸ºç§»é¤ä¸ä¸ªç®¡çç<br>æä¸ªå·²æ¿æ´»ä¿¡å·çé©±å¨æ¯å®å¨çãä¹å°±æ¯è¯´ï¼ç³è¯· GPIO çä½ç¨ç±»ä¼¼ä¸ç§éæºå¶ã</p>
<p>æäºå¹³å°å¯è½ä¹ä½¿ç¨ GPIO ä½ä¸ºçµæºç®¡çæ¿æ´»ä¿¡å·(ä¾å¦éè¿å³é­æªä½¿ç¨è¯çåºå<br>ç®åå°å³é­æªä½¿ç¨æ¶é)ã</p>
<p>å¯¹äº GPIO ä½¿ç¨ pinctrl å­ç³»ç»å·²ç¥çå¼èï¼å­ç³»ç»åºè¯¥è¢«åç¥å¶ä½¿ç¨æåµï¼<br>ä¸ä¸ª gpiolib é©±å¨ç .request()æä½åºè°ç¨ pinctrl_gpio_request()ï¼<br>è gpiolib é©±å¨ç .free()æä½åºè°ç¨ pinctrl_gpio_free()ãpinctrl<br>å­ç³»ç»åè®¸ pinctrl_gpio_request()å¨æä¸ªå¼èæå¼èç»ä»¥å¤ç¨å½¢å¼âå±äºâ<br>ä¸ä¸ªè®¾å¤æ¶é½æåè¿åã</p>
<p>ä»»ä½é¡»å° GPIO ä¿¡å·å¯¼åéå½å¼èçå¼èå¤ç¨ç¡¬ä»¶çç¼ç¨åºè¯¥åçå¨ GPIO<br>é©±å¨ç .direction_input()æ .direction_output()å½æ°ä¸­ï¼ä»¥å<br>ä»»ä½è¾åº GPIO å¼çè®¾ç½®ä¹åãè¿æ ·å¯ä½¿ä»å¼èç¹æ®åè½å° GPIO çè½¬æ¢<br>ä¸ä¼å¨å¼èäº§çæ¯åºæ³¢å½¢ãææ¶å½ç¨ä¸ä¸ª GPIO å®ç°å¶ä¿¡å·é©±å¨ä¸ä¸ªé GPIO<br>ç¡¬ä»¶æ¨¡åçè§£å³æ¹æ¡æ¶ï¼å°±éè¦è¿ç§æºå¶ã</p>
<p>æäºå¹³å°åè®¸é¨åæææ GPIO ä¿¡å·ä½¿ç¨ä¸åçå¼èãç±»ä¼¼çï¼GPIO æå¼èç<br>å¶ä»æ¹é¢ä¹éè¦éç½®ï¼å¦ä¸æ/ä¸æãå¹³å°è½¯ä»¶åºè¯¥å¨å¯¹è¿äº GPIO è°ç¨<br>gpio_request()åå°è¿ç±»ç»èéç½®å¥½ï¼ä¾å¦ä½¿ç¨ pinctrl å­ç³»ç»çæ å°è¡¨ï¼<br>ä½¿å¾ GPIO çç¨æ·æ é¡»å³æ³¨è¿äºç»èã</p>
<p>è¿æä¸ä¸ªå¼å¾æ³¨æçæ¯å¨éæ¾ GPIO åï¼ä½ å¿é¡»åæ­¢ä½¿ç¨å®ã</p>
<p>æ³¨æ:ç³è¯·ä¸ä¸ª GPIO å¹¶æ²¡æä»¥ä»»ä½æ¹å¼éç½®å®ï¼åªä¸è¿æ è¯é£ä¸ª GPIO å¤äºä½¿ç¨<br>ç¶æãå¿é¡»æå¦å¤çä»£ç æ¥å¤çå¼èéç½®(å¦æ§å¶ GPIO ä½¿ç¨çå¼èãä¸æ/ä¸æ)ã<br>èèå°å¤§å¤æ°æåµä¸å£°æ GPIO ä¹åå°±ä¼ç«å³éç½®å®ä»¬,æä»¥å®ä¹äºä»¥ä¸ä¸ä¸ªè¾å©å½æ°:</p>
<pre><code>/* ç³è¯·ä¸ä¸ª GPIO ä¿¡å·, åæ¶éè¿ç¹å®ç&#39;flags&#39;åå§åéç½®,
 * å¶ä»å gpio_request()çåæ°åè¿åå¼ç¸å
 *
 */
int gpio_request_one(unsigned gpio, unsigned long flags, const char *label);

/* å¨åä¸ªå½æ°ä¸­ç³è¯·å¤ä¸ª GPIO
 */
int gpio_request_array(struct gpio *array, size_t num);

/* å¨åä¸ªå½æ°ä¸­éæ¾å¤ä¸ª GPIO
 */
void gpio_free_array(struct gpio *array, size_t num);
</code></pre>
<p>è¿é ‘flags’ å½åå®ä¹å¯æå®ä»¥ä¸å±æ§:</p>
<pre><code>* GPIOF_DIR_IN        - éç½®æ¹åä¸ºè¾å¥
* GPIOF_DIR_OUT        - éç½®æ¹åä¸ºè¾åº

* GPIOF_INIT_LOW    - å¨ä½ä¸ºè¾åºæ¶,åå§å¼ä¸ºä½çµå¹³
* GPIOF_INIT_HIGH    - å¨ä½ä¸ºè¾åºæ¶,åå§å¼ä¸ºé«çµå¹³
* GPIOF_OPEN_DRAIN    - gpioå¼èä¸ºå¼æ¼ä¿¡å·
* GPIOF_OPEN_SOURCE    - gpioå¼èä¸ºæºæå¼è·¯ä¿¡å·

* GPIOF_EXPORT_DIR_FIXED    - å° gpio å¯¼åºå° sysfsï¼å¹¶ä¿ææ¹å
* GPIOF_EXPORT_DIR_CHANGEABLE    - åæ ·æ¯å¯¼åº, ä½åè®¸æ¹åæ¹å
</code></pre>
<p>å ä¸º GPIOF_INIT_* ä»æå¨éç½®ä¸ºè¾åºçæ¶åæå­å¨,æä»¥ææçç»åä¸º:</p>
<pre><code>* GPIOF_IN        - éç½®ä¸ºè¾å¥
* GPIOF_OUT_INIT_LOW    - éç½®ä¸ºè¾åº,å¹¶åå§åä¸ºä½çµå¹³
* GPIOF_OUT_INIT_HIGH    - éç½®ä¸ºè¾åº,å¹¶åå§åä¸ºé«çµå¹³
</code></pre>
<p>å½è®¾ç½® flag ä¸º GPIOF_OPEN_DRAIN æ¶ï¼ååè®¾å¼èæ¯å¼æ¼ä¿¡å·ãè¿æ ·çå¼è<br>å°ä¸ä¼å¨è¾åºæ¨¡å¼ä¸ç½®1ãè¿æ ·çå¼èéè¦è¿æ¥ä¸æçµé»ãéè¿ä½¿è½è¿ä¸ªæ å¿ï¼gpioåº<br>å°ä¼å¨è¢«è¦æ±è¾åºæ¨¡å¼ä¸ç½®1æ¶å°å¼èåä¸ºè¾å¥ç¶ææ¥ä½¿å¼èç½®é«ãå¼èå¨è¾åºæ¨¡å¼ä¸<br>éè¿ç½®0ä½¿å¶è¾åºä½çµå¹³ã</p>
<p>å½è®¾ç½® flag ä¸º GPIOF_OPEN_SOURCE æ¶ï¼ååè®¾å¼èä¸ºæºæå¼è·¯ä¿¡å·ãè¿æ ·çå¼è<br>å°ä¸ä¼å¨è¾åºæ¨¡å¼ä¸ç½®0ãè¿æ ·çå¼èéè¦è¿æ¥ä¸æçµé»ãéè¿ä½¿è½è¿ä¸ªæ å¿ï¼gpioåº<br>å°ä¼å¨è¢«è¦æ±è¾åºæ¨¡å¼ä¸ç½®0æ¶å°å¼èåä¸ºè¾å¥ç¶ææ¥ä½¿å¼èç½®ä½ãå¼èå¨è¾åºæ¨¡å¼ä¸<br>éè¿ç½®1ä½¿å¶è¾åºé«çµå¹³ã</p>
<p>å°æ¥è¿äºæ å¿å¯è½æ©å±å°æ¯ææ´å¤çå±æ§ã</p>
<p>æ´è¿ä¸æ­¥,ä¸ºäºæ´ç®åå°å£°æ/éæ¾å¤ä¸ª GPIO,’struct gpio’è¢«å¼è¿æ¥å°è£ææ<br>è¿ä¸ä¸ªé¢å:</p>
<pre><code>struct gpio &#123;
    unsigned    gpio;
    unsigned long    flags;
    const char    *label;
&#125;;
</code></pre>
<p>ä¸ä¸ªå¸åçç¨ä¾:</p>
<pre><code>static struct gpio leds_gpios[] = &#123;
    &#123; 32, GPIOF_OUT_INIT_HIGH, &quot;Power LED&quot; &#125;, /* é»è®¤å¼å¯ */
    &#123; 33, GPIOF_OUT_INIT_LOW,  &quot;Green LED&quot; &#125;, /* é»è®¤å³é­ */
    &#123; 34, GPIOF_OUT_INIT_LOW,  &quot;Red LED&quot;   &#125;, /* é»è®¤å³é­ */
    &#123; 35, GPIOF_OUT_INIT_LOW,  &quot;Blue LED&quot;  &#125;, /* é»è®¤å³é­ */
    &#123; ... &#125;,
&#125;;

err = gpio_request_one(31, GPIOF_IN, &quot;Reset Button&quot;);
if (err)
    ...

err = gpio_request_array(leds_gpios, ARRAY_SIZE(leds_gpios));
if (err)
    ...

gpio_free_array(leds_gpios, ARRAY_SIZE(leds_gpios));
</code></pre>
<h2 id="GPIO-ae-a°a°-IRQ"><a href="#GPIO-ae-a°a°-IRQ" class="headerlink" title="GPIO æ å°å° IRQ"></a>GPIO æ å°å° IRQ</h2><p>GPIO ç¼å·æ¯æ ç¬¦å·æ´æ°;IRQ ç¼å·ä¹æ¯ãè¿äºææäºä¸¤ä¸ªé»è¾ä¸ä¸åçå½åç©ºé´<br>(GPIO 0 ä¸ä¸å®ä½¿ç¨ IRQ 0)ãä½ å¯ä»¥éè¿ä»¥ä¸å½æ°å¨å®ä»¬ä¹é´å®ç°æ å°:</p>
<pre><code>/* æ å° GPIO ç¼å·å° IRQ ç¼å· */
int gpio_to_irq(unsigned gpio);

/* æ å° IRQ ç¼å·å° GPIO ç¼å· (å°½éé¿åä½¿ç¨) */
int irq_to_gpio(unsigned irq);
</code></pre>
<p>å®ä»¬çè¿åå¼ä¸ºå¯¹åºå½åç©ºé´çç¸å³ç¼å·ï¼ææ¯è´çéè¯¯ä»£ç (å¦ææ æ³æ å°)ã<br>(ä¾å¦,æäº GPIO æ æ³åä¸º IRQ ä½¿ç¨ã)ä»¥ä¸çç¼å·éè¯¯æ¯æªç»æ£æµç:ä½¿ç¨ä¸ä¸ª<br>æªéè¿ gpio_direction_input()éç½®ä¸ºè¾å¥ç GPIO ç¼å·ï¼æèä½¿ç¨ä¸ä¸ª<br>å¹¶éæ¥æºäºgpio_to_irq()ç IRQ ç¼å·ã</p>
<p>è¿ä¸¤ä¸ªæ å°å½æ°å¯è½ä¼å¨ä¿¡å·ç¼å·çå åè®¡ç®è¿ç¨ä¸è±äºæ¶é´ãå®ä»¬ä¸å¯ä¼ç ã</p>
<p>gpio_to_irq()è¿åçééè¯¯å¼å¯ä»¥ä¼ éç» request_irq()æè free_irq()ã<br>å®ä»¬éå¸¸éè¿æ¿çº§ç¹å®çåå§åä»£ç å­æ¾å°å¹³å°è®¾å¤ç IRQ èµæºä¸­ãæ³¨æ:IRQ<br>è§¦åéé¡¹æ¯ IRQ æ¥å£çä¸é¨åï¼å¦ IRQF_TRIGGER_FALLINGï¼ç³»ç»å¤éè½å<br>ä¹æ¯å¦æ­¤ã</p>
<p>irq_to_gpio()è¿åçééè¯¯å¼å¤§å¤æ°éå¸¸å¯ä»¥è¢« gpio_get_value()æä½¿ç¨ï¼<br>æ¯å¦å¨ IRQ æ¯æ²¿è§¦åæ¶åå§åææ´æ°é©±å¨ç¶æãæ³¨ææäºå¹³å°ä¸æ¯æåæ å°,æä»¥<br>ä½ åºè¯¥å°½éé¿åä½¿ç¨å®ã</p>
<h2 id="ae¨¡aea¼ae¼a¿¡a·"><a href="#ae¨¡aea¼ae¼a¿¡a·" class="headerlink" title="æ¨¡æå¼æ¼ä¿¡å·"></a>æ¨¡æå¼æ¼ä¿¡å·</h2><p>ææ¶å¨åªæä½çµå¹³ä¿¡å·ä½ä¸ºå®éé©±å¨ç»æ(è¯èæ³¨:å¤ä¸ªè¾åºè¿æ¥äºä¸ç¹ï¼é»è¾çµå¹³<br>ç»æä¸ºææè¾åºçé»è¾ä¸)çæ¶å,å±äº«çä¿¡å·çº¿éè¦ä½¿ç¨âå¼æ¼âä¿¡å·ã(è¯¥æ¯è¯­<br>éç¨äº CMOS ç®¡ï¼è TTL ç¨âéçµæå¼è·¯âã)ä¸ä¸ªä¸æçµé»ä½¿ä¿¡å·ä¸ºé«çµå¹³ãè¿<br>ææ¶è¢«ç§°ä¸ºâçº¿ä¸âãå®éä¸ï¼ä»è´é»è¾(ä½çµå¹³ä¸ºç)çè§åº¦æ¥çï¼è¿æ¯ä¸ä¸ªâçº¿æâã</p>
<p>ä¸ä¸ªå¼æ¼ä¿¡å·çå¸¸è§ä¾å­æ¯å±äº«çä½çµå¹³ä½¿è½ IRQ ä¿¡å·çº¿ãæ­¤å¤,ææ¶ååæ°æ®æ»çº¿<br>ä¿¡å·ä¹ä½¿ç¨æ¼æå¼è·¯ä¿¡å·ã</p>
<p>æäº GPIO æ§å¶å¨ç´æ¥æ¯æå¼æ¼è¾åºï¼è¿æè®¸å¤ä¸æ¯æãå½ä½ éè¦å¼æ¼ä¿¡å·ï¼ä½<br>ç¡¬ä»¶åä¸ç´æ¥æ¯æçæ¶åï¼ä¸ä¸ªå¸¸ç¨çæ¹æ³æ¯ç¨ä»»ä½å³å¯ä½è¾å¥ä¹å¯ä½è¾åºç GPIO<br>å¼èæ¥æ¨¡æ:</p>
<p> LOW:    gpio_direction_output(gpio, 0) … è¿ä»£ç é©±å¨ä¿¡å·å¹¶è¦ç<br>    ä¸æéç½®ã</p>
<p> HIGH:    gpio_direction_input(gpio) … è¿ä»£ç å³é­è¾åº,æä»¥ä¸æçµé»<br>    (æå¶ä»çä¸äºå¨ä»¶)æ§å¶äºä¿¡å·ã</p>
<p>å¦æä½ å°ä¿¡å·çº¿âé©±å¨âä¸ºé«çµå¹³ï¼ä½æ¯ gpio_get_value(gpio)æ¥åäºä¸ä¸ª<br>ä½çµå¹³(å¨éå½çä¸åæ¶é´å)ï¼ä½ å°±å¯ä»¥ç¥éæ¯å¶ä»çä¸äºç»ä»¶å°å±äº«ä¿¡å·çº¿æä½äºã<br>è¿ä¸ä¸å®æ¯éè¯¯çãä¸ä¸ªå¸¸è§çä¾å­å°±æ¯ I2C æ¶éçå»¶é¿ï¼ä¸ä¸ªéè¦è¾æ¢æ¶éç<br>ä»è®¾å¤å»¶è¿ SCK çä¸åæ²¿ï¼è I2C ä¸»è®¾å¤ç¸åºå°è°æ´å¶ä¿¡å·ä¼ è¾éçã</p>
<h1 id="e¿aºa¬cº¦a¿½c¥aºa»a¹"><a href="#e¿aºa¬cº¦a¿½c¥aºa»a¹" class="headerlink" title="è¿äºå¬çº¦å¿½ç¥äºä»ä¹?"></a>è¿äºå¬çº¦å¿½ç¥äºä»ä¹?</h1><p>è¿äºå¬çº¦å¿½ç¥çæå¤§ä¸ä»¶äºå°±æ¯å¼èå¤ç¨ï¼å ä¸ºè¿å±äºé«åº¦è¯çç¹å®çå±æ§ä¸<br>æ²¡æå¯ç§»æ¤æ§ãæä¸ªå¹³å°å¯è½ä¸éè¦æç¡®çå¤ç¨ä¿¡æ¯ï¼æçå¯¹äºä»»æç»å®çå¼è<br>å¯è½åªæä¸¤ä¸ªåè½éé¡¹ï¼æçå¯è½æ¯ä¸ªå¼èæå«ä¸ªåè½éé¡¹ï¼æçå¯è½å¯ä»¥å°<br>å ä¸ªå¼èä¸­çä»»ä½ä¸ä¸ªä½ä¸ºç»å®ç GPIOã(æ¯çï¼è¿äºä¾å­é½æ¥èªäºå½åè¿è¡<br>Linux çç³»ç»ã)</p>
<p>å¨æäºç³»ç»ä¸­,ä¸å¼èå¤ç¨ç¸å³çæ¯éç½®åä½¿è½éæçä¸ãä¸ææ¨¡å¼ãå¹¶ä¸æ¯ææ<br>å¹³å°é½æ¯æè¿ç§æ¨¡å¼,æèä¸ä¼ä»¥ç¸åçæ¹å¼æ¥æ¯æè¿ç§æ¨¡å¼ï¼ä¸ä»»ä½ç»å®ççµè·¯æ¿<br>å¯è½ä½¿ç¨å¤ç½®çä¸æ(æä¸æ)çµé»,è¿æ¶è¯çä¸çå°±ä¸åºè¯¥ä½¿ç¨ã(å½ä¸ä¸ªçµè·¯éè¦<br>5kOhm çæå¨çµé»,è¯çä¸ç 100 kOhm çµé»å°±ä¸è½åå°ã)åæ ·çï¼é©±å¨è½å<br>(2 mA vs 20 mA)åçµå(1.8V vs 3.3V)æ¯å¹³å°ç¹å®é®é¢,å°±åæ¨¡åä¸æ ·å¨<br>å¯éç½®å¼èå GPIO ä¹é´(æ²¡)æä¸ä¸å¯¹åºçå³ç³»ã</p>
<p>è¿æå¶ä»ä¸äºç³»ç»ç¹å®çæºå¶æ²¡æå¨è¿éæåºï¼ä¾å¦ä¸è¿°çè¾å¥å»æ¯åºåçº¿ä¸è¾åº<br>éé¡¹ãç¡¬ä»¶å¯è½æ¯ææ¹éè¯»æå GPIOï¼ä½æ¯é£ä¸è¬æ¯éç½®ç¸å³çï¼å¯¹äºå¤äºåä¸<br>ååº(bank)çGPIOã(GPIO éå¸¸ä»¥ 16 æ 32 ä¸ªç»æä¸ä¸ªåºåï¼ä¸ä¸ªç»å®ç<br>çä¸ç³»ç»ä¸è¬æå ä¸ªè¿æ ·çåºåã)æäºç³»ç»å¯ä»¥éè¿è¾åº GPIO è§¦å IRQï¼<br>æèä»å¹¶éä»¥ GPIO ç®¡ççå¼èåå¼ãè¿äºæºå¶çç¸å³ä»£ç æ²¡æå¿è¦å·æå¯ç§»æ¤æ§ã</p>
<p>å½åï¼å¨æå®ä¹ GPIO å¹¶ä¸æ¯æ åçï¼ä¾å¦ä½ä¸ºéç½®ä¸ä¸ªå¸¦ææäº GPIO æ©å±å¨ç<br>éå çµè·¯æ¿çå¯ä½ç¨ã</p>
<h1 id="GPIO-a®c°ecae¡ae¶-a¯e"><a href="#GPIO-a®c°ecae¡ae¶-a¯e" class="headerlink" title="GPIO å®ç°èçæ¡æ¶ (å¯é)"></a>GPIO å®ç°èçæ¡æ¶ (å¯é)</h1><p>åé¢æå°äºï¼æä¸ä¸ªå¯éçå®ç°æ¡æ¶ï¼è®©å¹³å°ä½¿ç¨ç¸åçç¼ç¨æ¥å£ï¼æ´å ç®åå°æ¯æ<br>ä¸åç§ç±»ç GPIO æ§å¶å¨ãè¿ä¸ªæ¡æ¶ç§°ä¸º”gpiolib”ã</p>
<p>ä½ä¸ºä¸ä¸ªè¾å©è°è¯åè½ï¼å¦æ debugfs å¯ç¨ï¼å°±ä¼æä¸ä¸ª /sys/kernel/debug/gpio<br>æä»¶ãéè¿è¿ä¸ªæ¡æ¶ï¼å®å¯ä»¥ååºæææ³¨åçæ§å¶å¨,ä»¥åå½åæ­£å¨ä½¿ç¨ä¸­ç GPIO<br>çç¶æã</p>
<h2 id="ae§a¶a¨e©±a¨-gpio-chip"><a href="#ae§a¶a¨e©±a¨-gpio-chip" class="headerlink" title="æ§å¶å¨é©±å¨: gpio_chip"></a>æ§å¶å¨é©±å¨: gpio_chip</h2><p>å¨æ¡æ¶ä¸­æ¯ä¸ª GPIO æ§å¶å¨é½åè£ä¸ºä¸ä¸ª “struct gpio_chip”ï¼ä»åå«äº<br>è¯¥ç±»åçæ¯ä¸ªæ§å¶å¨çå¸¸ç¨ä¿¡æ¯:</p>
<ul>
<li>è®¾ç½® GPIO æ¹åçæ¹æ³</li>
<li>ç¨äºè®¿é® GPIO å¼çæ¹æ³</li>
<li>åç¥è°ç¨å¶æ¹æ³æ¯å¦å¯è½ä¼ç çæ å¿</li>
<li>å¯éç debugfs ä¿¡æ¯å¯¼åºæ¹æ³ (æ¾ç¤ºç±»ä¼¼ä¸æéç½®ä¸æ ·çé¢å¤ç¶æ)</li>
<li>è¯æ­æ ç­¾</li>
</ul>
<p>ä¹åå«äºæ¥èª device.platform_data çæ¯ä¸ªå®ä¾çæ°æ®ï¼å®ç¬¬ä¸ä¸ª GPIO ç<br>ç¼å·åå®å¯ç¨ç GPIO çæ°éã</p>
<p>å®ç° gpio_chip çä»£ç åºæ¯æå¤æ§å¶å¨å®ä¾ï¼è¿å¯è½ä½¿ç¨é©±å¨æ¨¡åãé£äºä»£ç è¦<br>éç½®æ¯ä¸ª gpio_chipï¼å¹¶åèµ·gpiochip_add()ãå¸è½½ä¸ä¸ª GPIO æ§å¶å¨å¾å°è§ï¼<br>ä½å¨å¿è¦çæ¶åå¯ä»¥ä½¿ç¨ gpiochip_remove()ã</p>
<p>å¤§é¨å gpio_chip æ¯ä¸ä¸ªå®ä¾ç¹å®ç»æä½çä¸é¨åï¼èå¹¶ä¸å° GPIO æ¥å£åç¬<br>æ´é²åºæ¥,æ¯å¦ç¼åãçµæºç®¡çç­ãç±»ä¼¼ç¼è§£ç å¨è¿æ ·çè¯çä¼æå¤æçé GPIO<br>ç¶æã</p>
<p>ä»»ä½ä¸ä¸ª debugfs ä¿¡æ¯å¯¼åºæ¹æ³éå¸¸åºè¯¥å¿½ç¥è¿æªç³è¯·ä½ä¸º GPIO çä¿¡å·çº¿ã<br>ä»ä»¬å¯ä»¥ä½¿ç¨ gpiochip_is_requested()æµè¯ï¼å½è¿ä¸ª GPIO å·²ç»ç³è¯·è¿äº<br>å°±è¿åç¸å³çæ ç­¾ï¼å¦åè¿å NULLã</p>
<h2 id="a¹³a°ae¯aeOE"><a href="#a¹³a°ae¯aeOE" class="headerlink" title="å¹³å°æ¯æ"></a>å¹³å°æ¯æ</h2><p>ä¸ºäºæ¯æè¿ä¸ªæ¡æ¶ï¼ä¸ä¸ªå¹³å°ç Kconfig æä»¶å°ä¼ “select”(éæ©)<br>ARCH_REQUIRE_GPIOLIB æ ARCH_WANT_OPTIONAL_GPIOLIBï¼å¹¶è®©å®ç<br>&lt;asm/gpio.h&gt; åå« &lt;asm-generic/gpio.h&gt;ï¼åæ¶å®ä¹ä¸ä¸ªæ¹æ³:<br>gpio_get_value()ãgpio_set_value()å gpio_cansleep()ã</p>
<p>å®ä¹åºæä¾ä¸ä¸ª ARCH_NR_GPIOS çå®ä¹å¼ï¼è¿æ ·å¯ä»¥æ´å¥½å°åæ è¯¥å¹³å° GPIO<br>çå®éæ°é,èçéæè¡¨çç©ºé´ã(è¿ä¸ªå®ä¹å¼åºè¯¥åå«çä¸ç³»ç»åå»º GPIO å<br>GPIO æ©å±å¨ä¸­çæ°æ®ã)</p>
<p>ARCH_REQUIRE_GPIOLIB æå³ç gpiolib æ ¸å¿å¨è¿ä¸ªææ¶ä¸­å°æ»æ¯ç¼è¯è¿åæ ¸ã</p>
<p>ARCH_WANT_OPTIONAL_GPIOLIB æå³ç gpiolib æ ¸å¿é»è®¤å³é­,ä¸ç¨æ·å¯ä»¥<br>ä½¿è½å®,å¹¶å°å¶ç¼è¯è¿åæ ¸(å¯é)ã</p>
<p>å¦æè¿äºéé¡¹é½æ²¡è¢«éæ©,è¯¥å¹³å°å°±ä¸éè¿ GPIO-lib æ¯æ GPIO,ä¸ä»£ç ä¸å¯ä»¥<br>è¢«ç¨æ·ä½¿è½ã</p>
<p>ä»¥ä¸è¿äºæ¹æ³çå®ç°å¯ä»¥ç´æ¥ä½¿ç¨æ¡æ¶ä»£ç ,å¹¶æ»æ¯éè¿ gpio_chip è°åº¦:</p>
<p>  #define gpio_get_value    __gpio_get_value<br>  #define gpio_set_value    __gpio_set_value<br>  #define gpio_cansleep        __gpio_cansleep</p>
<p>è¿äºå®ä¹å¯ä»¥ç¨æ´çæ³çå®ç°æ¹æ³æ¿ä»£ï¼é£å°±æ¯ä½¿ç¨ç»è¿é»è¾ä¼åçåèå½æ°æ¥è®¿é®<br>åºäºç¹å®çä¸ç³»ç»ç GPIOãä¾å¦,è¥å¼ç¨ç GPIO (å¯å­å¨ä½åç§»)æ¯å¸¸éâ12âï¼<br>è¯»åæè®¾ç½®å®å¯è½åªéå°åä¸¤æä¸ä¸ªæä»¤ï¼ä¸ä¸ä¼ä¼ç ãå½è¿æ ·çä¼åæ æ³å®ç°æ¶ï¼<br>é£äºå½æ°å¿é¡»ä½¿ç¨æ¡æ¶æä¾çä»£ç ï¼é£å°±è³å°è¦å åæ¡æä»¤æå¯ä»¥å®ç°ãå¯¹äºç¨ GPIO<br>æ¨¡æç I/O æ¥å£, å¦æ­¤ç²¾ç®æä»¤æ¯å¾ææä¹çã</p>
<p>å¯¹äºçä¸ç³»ç»ï¼å¹³å°ç¹å®ä»£ç ä¸ºçä¸ GPIO æ¯ä¸ªåº(bank)å®ä¹å¹¶æ³¨å gpio_chip<br>å®ä¾ãé£äº GPIO åºè¯¥æ ¹æ®è¯çååçææ¡£è¿è¡ç¼ç /æ ç­¾,å¹¶ç´æ¥åçµè·¯æ¿åçå¾<br>å¯¹åºãä»ä»¬åºè¯¥å¼å§äºé¶å¹¶ç»æ­¢äºå¹³å°ç¹å®çéå¶ãè¿äº GPIO(ä»£ç )éå¸¸ä»<br>arch_initcall()æèæ´æ©çå°æ¹éæè¿å¹³å°åå§åä»£ç ï¼ä½¿è¿äº GPIO æ»æ¯å¯ç¨ï¼<br>ä¸ä»ä»¬éå¸¸å¯ä»¥ä½ä¸º IRQ ä½¿ç¨ã</p>
<h2 id="ae¿cº§ae¯aeOE"><a href="#ae¿cº§ae¯aeOE" class="headerlink" title="æ¿çº§æ¯æ"></a>æ¿çº§æ¯æ</h2><p>å¯¹äºå¤é¨ GPIO æ§å¶å¨(ä¾å¦ I2C æ SPI æ©å±å¨ãä¸ç¨è¯çãå¤åè½å¨ä»¶ãFPGA<br>æ CPLD)ï¼å¤§å¤æ°å¸¸ç¨æ¿çº§ç¹å®ä»£ç é½å¯ä»¥æ³¨åæ§å¶å¨è®¾å¤ï¼å¹¶ä¿è¯ä»ä»¬çé©±å¨ç¥é<br>gpiochip_add()æä½¿ç¨ç GPIO ç¼å·ãä»ä»¬çèµ·å§ç¼å·éå¸¸è·å¨å¹³å°ç¹å®ç GPIO<br>ç¼å·ä¹åã</p>
<p>ä¾å¦æ¿çº§å¯å¨ä»£ç åºè¯¥åå»ºç»æä½ææè¯çå¬å¼ç GPIO èå´ï¼å¹¶ä½¿ç¨ platform_data<br>å°å¶ä¼ éç»æ¯ä¸ª GPIO æ©å±å¨è¯çãç¶åè¯çé©±å¨ä¸­ç probe()ä¾ç¨å¯ä»¥å°è¿ä¸ª<br>æ°æ®ä¼ éç» gpiochip_add()ã</p>
<p>åå§åé¡ºåºå¾éè¦ãä¾å¦ï¼å¦æä¸ä¸ªè®¾å¤ä¾èµåºäº I2C ç(æ©å±)GPIOï¼é£ä¹å®ç<br>probe()ä¾ç¨å°±åºè¯¥å¨é£ä¸ª GPIO ææä»¥åæå¯ä»¥è¢«è°ç¨ãè¿æå³çè®¾å¤åºè¯¥å¨<br>GPIO å¯ä»¥å·¥ä½ä¹åæå¯è¢«æ³¨åãè§£å³è¿ç±»ä¾èµççä¸ç§æ¹æ³æ¯è®©è¿ç§ gpio_chip<br>æ§å¶å¨åæ¿çº§ç¹å®ä»£ç æä¾ setup()å teardown()åè°å½æ°ãä¸æ¦ææå¿é¡»ç<br>èµæºå¯ç¨ä¹åï¼è¿äºæ¿çº§ç¹å®çåè°å½æ°å°ä¼æ³¨åè®¾å¤ï¼å¹¶å¯ä»¥å¨è¿äº GPIO æ§å¶å¨<br>è®¾å¤åææ ææ¶ç§»é¤å®ä»¬ã</p>
<h1 id="c¨ae·c©ºe´c-Sysfs-ae¥a£-a¯e"><a href="#c¨ae·c©ºe´c-Sysfs-ae¥a£-a¯e" class="headerlink" title="ç¨æ·ç©ºé´ç Sysfs æ¥å£(å¯é)"></a>ç¨æ·ç©ºé´ç Sysfs æ¥å£(å¯é)</h1><p>ä½¿ç¨âgpiolibâå®ç°æ¡æ¶çå¹³å°å¯ä»¥éæ©éç½®ä¸ä¸ª GPIO ç sysfs ç¨æ·æ¥å£ã<br>è¿ä¸åäº debugfs æ¥å£ï¼å ä¸ºå®æä¾çæ¯å¯¹ GPIOæ¹ååå¼çæ§å¶ï¼èä¸åªæ¾ç¤º<br>ä¸ä¸ªGPIO çç¶ææè¦ãæ­¤å¤,å®å¯ä»¥åºç°å¨æ²¡æè°è¯æ¯æçäº§åçº§ç³»ç»ä¸­ã</p>
<p>ä¾å¦ï¼éè¿éå½çç³»ç»ç¡¬ä»¶ææ¡£ï¼ç¨æ·ç©ºé´å¯ä»¥ç¥é GIOP #23 æ§å¶ Flash<br>å­å¨å¨çåä¿æ¤(ç¨äºä¿æ¤å¶ä¸­ Bootloader ååº)ãäº§åçç³»ç»åçº§å¯è½éè¦<br>ä¸´æ¶è§£é¤è¿ä¸ªä¿æ¤ï¼é¦åå¯¼å¥ä¸ä¸ª GPIOï¼æ¹åå¶è¾åºç¶æï¼ç¶åå¨éæ°ä½¿è½åä¿æ¤<br>ååçº§ä»£ç ãéå¸¸æåµä¸,GPIO #23 æ¯ä¸ä¼è¢«è§¦åçï¼å¹¶ä¸åæ ¸ä¹ä¸éè¦ç¥éä»ã</p>
<p>æ ¹æ®éå½çç¡¬ä»¶ææ¡£ï¼æäºç³»ç»çç¨æ·ç©ºé´ GPIO å¯ä»¥ç¨äºç¡®å®ç³»ç»éç½®æ°æ®ï¼<br>è¿äºæ°æ®æ¯æ ååæ ¸ä¸ç¥éçãå¨æäºä»»å¡ä¸­ï¼ç®åçç¨æ·ç©ºé´ GPIO é©±å¨å¯è½æ¯<br>ç³»ç»çæ­£éè¦çã</p>
<p>æ³¨æï¼æ ååæ ¸é©±å¨ä¸­å·²ç»å­å¨éç¨çâLED åæé®âGPIO ä»»å¡ï¼åå«æ¯:<br>“leds-gpio” å “gpio_keys”ãè¯·ä½¿ç¨è¿äºæ¥æ¿ä»£ç´æ¥è®¿é® GPIOï¼å ä¸ºéæå¨<br>åæ ¸æ¡æ¶ä¸­çè¿ç±»é©±å¨æ¯ä½ å¨ç¨æ·ç©ºé´çä»£ç æ´å¥½ã</p>
<h2 id="Sysfs-a¸­ce·¯a¾"><a href="#Sysfs-a¸­ce·¯a¾" class="headerlink" title="Sysfs ä¸­çè·¯å¾"></a>Sysfs ä¸­çè·¯å¾</h2><p>å¨/sys/class/gpio ä¸­æ 3 ç±»å¥å£:</p>
<ul>
<li><p>   ç¨äºå¨ç¨æ·ç©ºé´æ§å¶ GPIO çæ§å¶æ¥å£;</p>
</li>
<li><p>   GPIOs æ¬èº«;ä»¥å</p>
</li>
<li><p>   GPIO æ§å¶å¨ (“gpio_chip” å®ä¾)ã</p>
</li>
</ul>
<p>é¤äºè¿äºæ åçæä»¶,è¿åå«âdeviceâç¬¦å·é¾æ¥ã</p>
<p>æ§å¶æ¥å£æ¯åªåç:</p>
<pre><code>/sys/class/gpio/

    &quot;export&quot; ... ç¨æ·ç©ºé´å¯ä»¥éè¿åå¶ç¼å·å°è¿ä¸ªæä»¶ï¼è¦æ±åæ ¸å¯¼åº
    ä¸ä¸ª GPIO çæ§å¶å°ç¨æ·ç©ºé´ã

    ä¾å¦: å¦æåæ ¸ä»£ç æ²¡æç³è¯· GPIO #19,&quot;echo 19 &gt; export&quot;
    å°ä¼ä¸º GPIO #19 åå»ºä¸ä¸ª &quot;gpio19&quot; èç¹ã

    &quot;unexport&quot; ... å¯¼åºå°ç¨æ·ç©ºé´çéæä½ã

    ä¾å¦: &quot;echo 19 &gt; unexport&quot; å°ä¼ç§»é¤ä½¿ç¨&quot;export&quot;æä»¶å¯¼åºç
    &quot;gpio19&quot; èç¹ã
</code></pre>
<p>GPIO ä¿¡å·çè·¯å¾ç±»ä¼¼ /sys/class/gpio/gpio42/ (å¯¹äº GPIO #42 æ¥è¯´)ï¼<br>å¹¶æå¦ä¸çè¯»/åå±æ§:</p>
<pre><code>/sys/class/gpio/gpioN/

&quot;direction&quot; ... è¯»åå¾å° &quot;in&quot; æ &quot;out&quot;ãè¿ä¸ªå¼éå¸¸è¿è¡åå¥ã
    åå¥&quot;out&quot; æ¶,å¶å¼èçé»è®¤è¾åºä¸ºä½çµå¹³ãä¸ºäºç¡®ä¿æ æéè¿è¡ï¼
    &quot;low&quot; æ &quot;high&quot; ççµå¹³å¼åºè¯¥åå¥ GPIO çéç½®ï¼ä½ä¸ºåå§è¾åºå¼ã

    æ³¨æ:å¦æåæ ¸ä¸æ¯ææ¹å GPIO çæ¹åï¼æèå¨å¯¼åºæ¶åæ ¸ä»£ç æ²¡æ
    æç¡®åè®¸ç¨æ·ç©ºé´å¯ä»¥éæ°éç½® GPIO æ¹åï¼é£ä¹è¿ä¸ªå±æ§å°ä¸å­å¨ã

&quot;value&quot; ... è¯»åå¾å° 0 (ä½çµå¹³) æ 1 (é«çµå¹³)ãå¦æ GPIO éç½®ä¸º
    è¾åº,è¿ä¸ªå¼åè®¸åæä½ãä»»ä½éé¶å¼é½ä»¥é«çµå¹³çå¾ã

    å¦æå¼èå¯ä»¥éç½®ä¸ºä¸­æ­ä¿¡å·ï¼ä¸å¦æå·²ç»éç½®äºäº§çä¸­æ­çæ¨¡å¼
    ï¼è§&quot;edge&quot;çæè¿°ï¼ï¼ä½ å¯ä»¥å¯¹è¿ä¸ªæä»¶ä½¿ç¨è½®è¯¢æä½(poll(2))ï¼
    ä¸è½®è¯¢æä½ä¼å¨ä»»ä½ä¸­æ­è§¦åæ¶è¿åãå¦æä½ ä½¿ç¨è½®è¯¢æä½(poll(2))ï¼
    è¯·å¨ events ä¸­è®¾ç½® POLLPRI å POLLERRãå¦æä½ ä½¿ç¨è½®è¯¢æä½
    (select(2))ï¼è¯·å¨ exceptfds è®¾ç½®ä½ ææçæä»¶æè¿°ç¬¦ãå¨
    è½®è¯¢æä½(poll(2))è¿åä¹åï¼æ¢å¯ä»¥éè¿ lseek(2)æä½è¯»å
    sysfs æä»¶çå¼å§é¨åï¼ä¹å¯ä»¥å³é­è¿ä¸ªæä»¶å¹¶éæ°æå¼å®æ¥è¯»åæ°æ®ã

&quot;edge&quot; ... è¯»åå¾å°ânoneâãârisingâãâfallingâæèâbothâã
    å°è¿äºå­ç¬¦ä¸²åå¥è¿ä¸ªæä»¶å¯ä»¥éæ©æ²¿è§¦åæ¨¡å¼ï¼ä¼ä½¿å¾è½®è¯¢æä½
    (select(2))å¨&quot;value&quot;æä»¶ä¸­è¿åã

    è¿ä¸ªæä»¶ä»æå¨è¿ä¸ªå¼èå¯ä»¥éç½®ä¸ºå¯äº§çä¸­æ­è¾å¥å¼èæ¶ï¼æå­å¨ã

&quot;active_low&quot; ... è¯»åå¾å° 0 (å) æ 1 (ç)ãåå¥ä»»ä½éé¶å¼å¯ä»¥
    ç¿»è½¬è¿ä¸ªå±æ§ç(è¯»å)å¼ãå·²å­å¨æä¹åéè¿&quot;edge&quot;å±æ§è®¾ç½®äº&quot;rising&quot;
    å &quot;falling&quot; æ²¿è§¦åæ¨¡å¼çè½®è¯¢æä½(poll(2))å°ä¼éµå¾ªè¿ä¸ªè®¾ç½®ã
</code></pre>
<p>GPIO æ§å¶å¨çè·¯å¾ç±»ä¼¼ /sys/class/gpio/gpiochip42/ (å¯¹äºä»#42 GPIO<br>å¼å§å®ç°æ§å¶çæ§å¶å¨),å¹¶æçä»¥ä¸åªè¯»å±æ§:</p>
<pre><code>/sys/class/gpio/gpiochipN/

    &quot;base&quot; ... ä¸ä»¥ä¸ç N ç¸å,ä»£è¡¨æ­¤è¯çç®¡ççç¬¬ä¸ä¸ª GPIO çç¼å·

    &quot;label&quot; ... ç¨äºè¯æ­ (å¹¶ä¸æ»æ¯åªæå¯ä¸å¼)

    &quot;ngpio&quot; ... æ­¤æ§å¶å¨æç®¡çç GPIO æ°é(è GPIO ç¼å·ä» N å°
        N + ngpio - 1)
</code></pre>
<p>å¤§å¤æ°æåµä¸,çµè·¯æ¿çææ¡£åºå½æ ææ¯ä¸ª GPIO çä½¿ç¨ç®çãä½æ¯é£äºç¼å·å¹¶ä¸æ»æ¯<br>åºå®ç,ä¾å¦å¨æ©å±å¡ä¸ç GPIOä¼æ ¹æ®æä½¿ç¨çä¸»æ¿ææå¨å å æ¶æä¸­å¶ä»çæ¿å­è<br>ææä¸åãå¨è¿ç§æåµä¸,ä½ å¯è½éè¦ä½¿ç¨ gpiochip èç¹(å°½å¯è½å°ç»åçµè·¯å¾)æ¥<br>ç¡®å®ç»å®ä¿¡å·æç¨ç GPIO ç¼å·ã</p>
<h2 id="a»aae-¸a»£c-a¸­a¯¼aº"><a href="#a»aae-¸a»£c-a¸­a¯¼aº" class="headerlink" title="ä»åæ ¸ä»£ç ä¸­å¯¼åº"></a>ä»åæ ¸ä»£ç ä¸­å¯¼åº</h2><p>åæ ¸ä»£ç å¯ä»¥æç¡®å°ç®¡çé£äºå·²éè¿ gpio_request()ç³è¯·ç GPIO çå¯¼åº:</p>
<pre><code>/* å¯¼åº GPIO å°ç¨æ·ç©ºé´ */
int gpio_export(unsigned gpio, bool direction_may_change);

/* gpio_export()çéæä½ */
void gpio_unexport();

/* åå»ºä¸ä¸ª sysfs è¿æ¥å°å·²å¯¼åºç GPIO èç¹ */
int gpio_export_link(struct device *dev, const char *name,
    unsigned gpio)
</code></pre>
<p>å¨ä¸ä¸ªåæ ¸é©±å¨ç³è¯·ä¸ä¸ª GPIO ä¹åï¼å®å¯ä»¥éè¿ gpio_export()ä½¿å¶å¨ sysfs<br>æ¥å£ä¸­å¯è§ãè¯¥é©±å¨å¯ä»¥æ§å¶ä¿¡å·æ¹åæ¯å¦å¯ä¿®æ¹ãè¿æå©äºé²æ­¢ç¨æ·ç©ºé´ä»£ç æ æé´<br>ç ´åéè¦çç³»ç»ç¶æã</p>
<p>è¿ä¸ªæç¡®çå¯¼åºæå©äº(éè¿ä½¿æäºå®éªæ´å®¹ææ¥)è°è¯ï¼ä¹å¯ä»¥æä¾ä¸ä¸ªå§ç»å­å¨çæ¥å£ï¼<br>ä¸ææ¡£éåä½ä¸ºæ¿çº§æ¯æåçä¸é¨åã</p>
<p>å¨ GPIO è¢«å¯¼åºä¹åï¼gpio_export_link()åè®¸å¨ sysfs æä»¶ç³»ç»çä»»ä½å°æ¹<br>åå»ºä¸ä¸ªå°è¿ä¸ª GPIO sysfs èç¹çç¬¦å·é¾æ¥ãè¿æ ·é©±å¨å°±å¯ä»¥éè¿ä¸ä¸ªæè¿°æ§ç<br>åå­ï¼å¨ sysfs ä¸­ä»ä»¬ææ¥æçè®¾å¤ä¸æä¾ä¸ä¸ª(å°è¿ä¸ª GPIO sysfs èç¹ç)æ¥å£ã</p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://www.oostech.com/2021/02/19/Kernel-4.18.0-80.el8_gpio/" title="Kernel-4.18.0-80.el8_gpio" target="_blank" rel="external">http://www.oostech.com/2021/02/19/Kernel-4.18.0-80.el8_gpio/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">oosTech by Sam Lee</span><small class="ml-1x"></small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    

  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/02/19/Kernel-4.18.0-80.el8_filter/" title="Kernel-4.18.0-80.el8_filter"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/02/19/Kernel-4.18.0-80.el8_pci/" title="Kernel-4.18.0-80.el8_pci"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,wechat"></div>
    
  </div>
  </div>
    <div class="container" align="left">
    <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
      <img src="/images/wechatp.png" itemprop="contentUrl">
      <span>欢迎关注公众号</span>
    </div>
    </div>
</nav>

  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>您能有收获就是我们最大的动力</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码捐赠</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码捐赠</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
	<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn" text-align: center >粤ICP备2021024811号</a>
        </div>
<!--    
    <div>
     <img src="/images/logo.png" width="140" height="140">
    </div>
-->
    </div>


        <!-- 不蒜子统计    //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <!--<span id="busuanzi_container_site_pv" style="display:inline;">-->本站总访问量<span id="busuanzi_value_site_pv" style="display:inline;></span>次</span>
        <span class="post-meta-divider">|</span>
  
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>







   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>











</body>
</html>