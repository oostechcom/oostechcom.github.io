<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>Kernel-2.6.32-573.12.1.el6_ | oosTech.com</title>
  <meta name="description" content="Tools that manage md devices can be found at   http:&#x2F;&#x2F;www..kernel.org&#x2F;pub&#x2F;linux&#x2F;utils&#x2F;raid&#x2F;…. Boot time assembly of RAID arraysYou can boot with your md device with the following kernel commandlines:">
<meta property="og:type" content="article">
<meta property="og:title" content="Kernel-2.6.32-573.12.1.el6_">
<meta property="og:url" content="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_md/index.html">
<meta property="og:site_name" content="oosTech">
<meta property="og:description" content="Tools that manage md devices can be found at   http:&#x2F;&#x2F;www..kernel.org&#x2F;pub&#x2F;linux&#x2F;utils&#x2F;raid&#x2F;…. Boot time assembly of RAID arraysYou can boot with your md device with the following kernel commandlines:">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:modified_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:author" content="Sam Lee">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_md/index.html">
  
    <link rel="alternate" href="/atom.xml" title="oosTech" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img src="/images/avatar.png" width="400" height="400">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">oosTech by Sam Lee</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="站内搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">站点首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档文档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">文档分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">常用链接</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">共享白板</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告牌</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p> 欢迎来到oosTech ，我是一个Linux 拥趸：D。 目前正在用的Linux 版本是 Red Hat Enterprise Linux release 8.3 </p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">文档分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a><span class="category-list-count">830</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a><span class="category-list-count">1658</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-4-18-0-80-el8-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_4.18.0-80.el8_内核文档</a><span class="category-list-count">3937</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3270/" class="title">Kernel-3.10.0-957.el7_3270</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_devices/" class="title">Kernel-2.6.32-573.12.1.el6_devices</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3c509/" class="title">Kernel-3.10.0-957.el7_3c509</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_4CCs/" class="title">Kernel-3.10.0-957.el7_4CCs</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_53c700/" class="title">Kernel-3.10.0-957.el7_53c700</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Boot-time-assembly-of-RAID-arrays"><span class="toc-number">1.</span> <span class="toc-text">Boot time assembly of RAID arrays</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Boot-time-autodetection-of-RAID-arrays"><span class="toc-number">2.</span> <span class="toc-text">Boot time autodetection of RAID arrays</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Boot-time-assembly-of-degraded-dirty-arrays"><span class="toc-number">3.</span> <span class="toc-text">Boot time assembly of degraded&#x2F;dirty arrays</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Superblock-formats"><span class="toc-number">4.</span> <span class="toc-text">Superblock formats</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#General-Rules-apply-for-all-superblock-formats"><span class="toc-number">5.</span> <span class="toc-text">General Rules - apply for all superblock formats</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MD-devices-in-sysfs"><span class="toc-number">6.</span> <span class="toc-text">MD devices in sysfs</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Kernel-2.6.32-573.12.1.el6_md" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Kernel-2.6.32-573.12.1.el6_
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_md/" class="article-date">
	 published: <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
	</a>
</span>

        
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_md/" class="article-date">
	   updated: <time datetime="2021-03-12T16:00:00.000Z" itemprop="dateUpdated">2021-03-13</time>
	</a>


        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
  </span>

        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill"></i>
	    <!--<span id="busuanzi_container_page_pv" style="display:inline;">-->
			<span id="busuanzi_value_page_pv" style="display:inline;"></span>
		<!--</span>-->
	</span>



        <!--<span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_md/#comments" class="article-comment-link">评论</a></span> -->
        
	
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p>Tools that manage md devices can be found at<br>   <a target="_blank" rel="noopener" href="http://www/">http://www</a>.<country>.kernel.org/pub/linux/utils/raid/….</p>
<h2 id="Boot-time-assembly-of-RAID-arrays"><a href="#Boot-time-assembly-of-RAID-arrays" class="headerlink" title="Boot time assembly of RAID arrays"></a>Boot time assembly of RAID arrays</h2><p>You can boot with your md device with the following kernel command<br>lines:</p>
<p>for old raid arrays without persistent superblocks:<br>  md=<md device no.>,<raid level>,<chunk size factor>,<fault level>,dev0,dev1,…,devn</p>
<p>for raid arrays with persistent superblocks<br>  md=<md device no.>,dev0,dev1,…,devn<br>or, to assemble a partitionable array:<br>  md=d<md device no.>,dev0,dev1,…,devn</p>
<p>md device no. = the number of the md device …<br>              0 means md0,<br>          1 md1,<br>          2 md2,<br>          3 md3,<br>          4 md4</p>
<p>raid level = -1 linear mode<br>              0 striped mode<br>          other modes are only supported with persistent super blocks</p>
<p>chunk size factor = (raid-0 and raid-1 only)<br>              Set  the chunk size as 4k &lt;&lt; n.</p>
<p>fault level = totally ignored</p>
<p>dev0-devn: e.g. /dev/hda1,/dev/hdc1,/dev/sda1,/dev/sdb1</p>
<p>A possible loadlin line (Harald Hoyer <a href="mailto:&#x48;&#x61;&#x72;&#x72;&#x79;&#72;&#64;&#82;&#x6f;&#121;&#97;&#108;&#x2e;&#78;&#101;&#116;">&#x48;&#x61;&#x72;&#x72;&#x79;&#72;&#64;&#82;&#x6f;&#121;&#97;&#108;&#x2e;&#78;&#101;&#116;</a>)  looks like this:</p>
<p>e:\loadlin\loadlin e:\zimage root=/dev/md0 md=0,0,4,0,/dev/hdb2,/dev/hdc3 ro</p>
<h2 id="Boot-time-autodetection-of-RAID-arrays"><a href="#Boot-time-autodetection-of-RAID-arrays" class="headerlink" title="Boot time autodetection of RAID arrays"></a>Boot time autodetection of RAID arrays</h2><p>When md is compiled into the kernel (not as module), partitions of<br>type 0xfd are scanned and automatically assembled into RAID arrays.<br>This autodetection may be suppressed with the kernel parameter<br>“raid=noautodetect”.  As of kernel 2.6.9, only drives with a type 0<br>superblock can be autodetected and run at boot time.</p>
<p>The kernel parameter “raid=partitionable” (or “raid=part”) means<br>that all auto-detected arrays are assembled as partitionable.</p>
<h2 id="Boot-time-assembly-of-degraded-dirty-arrays"><a href="#Boot-time-assembly-of-degraded-dirty-arrays" class="headerlink" title="Boot time assembly of degraded/dirty arrays"></a>Boot time assembly of degraded/dirty arrays</h2><p>If a raid5 or raid6 array is both dirty and degraded, it could have<br>undetectable data corruption.  This is because the fact that it is<br>‘dirty’ means that the parity cannot be trusted, and the fact that it<br>is degraded means that some datablocks are missing and cannot reliably<br>be reconstructed (due to no parity).</p>
<p>For this reason, md will normally refuse to start such an array.  This<br>requires the sysadmin to take action to explicitly start the array<br>despite possible corruption.  This is normally done with<br>   mdadm –assemble –force ….</p>
<p>This option is not really available if the array has the root<br>filesystem on it.  In order to support this booting from such an<br>array, md supports a module parameter “start_dirty_degraded” which,<br>when set to 1, bypassed the checks and will allows dirty degraded<br>arrays to be started.</p>
<p>So, to boot with a root filesystem of a dirty degraded raid[56], use</p>
<p>   md-mod.start_dirty_degraded=1</p>
<h2 id="Superblock-formats"><a href="#Superblock-formats" class="headerlink" title="Superblock formats"></a>Superblock formats</h2><p>The md driver can support a variety of different superblock formats.<br>Currently, it supports superblock formats “0.90.0” and the “md-1” format<br>introduced in the 2.5 development series.</p>
<p>The kernel will autodetect which format superblock is being used.</p>
<p>Superblock format ‘0’ is treated differently to others for legacy<br>reasons - it is the original superblock format.</p>
<h2 id="General-Rules-apply-for-all-superblock-formats"><a href="#General-Rules-apply-for-all-superblock-formats" class="headerlink" title="General Rules - apply for all superblock formats"></a>General Rules - apply for all superblock formats</h2><p>An array is ‘created’ by writing appropriate superblocks to all<br>devices.</p>
<p>It is ‘assembled’ by associating each of these devices with an<br>particular md virtual device.  Once it is completely assembled, it can<br>be accessed.</p>
<p>An array should be created by a user-space tool.  This will write<br>superblocks to all devices.  It will usually mark the array as<br>‘unclean’, or with some devices missing so that the kernel md driver<br>can create appropriate redundancy (copying in raid1, parity<br>calculation in raid4/5).</p>
<p>When an array is assembled, it is first initialized with the<br>SET_ARRAY_INFO ioctl.  This contains, in particular, a major and minor<br>version number.  The major version number selects which superblock<br>format is to be used.  The minor number might be used to tune handling<br>of the format, such as suggesting where on each device to look for the<br>superblock.</p>
<p>Then each device is added using the ADD_NEW_DISK ioctl.  This<br>provides, in particular, a major and minor number identifying the<br>device to add.</p>
<p>The array is started with the RUN_ARRAY ioctl.</p>
<p>Once started, new devices can be added.  They should have an<br>appropriate superblock written to them, and then be passed in with<br>ADD_NEW_DISK.</p>
<p>Devices that have failed or are not yet active can be detached from an<br>array using HOT_REMOVE_DISK.</p>
<p>Specific Rules that apply to format-0 super block arrays, and<br>       arrays with no superblock (non-persistent).</p>
<hr>
<p>An array can be ‘created’ by describing the array (level, chunksize<br>etc) in a SET_ARRAY_INFO ioctl.  This must have major_version==0 and<br>raid_disks != 0.</p>
<p>Then uninitialized devices can be added with ADD_NEW_DISK.  The<br>structure passed to ADD_NEW_DISK must specify the state of the device<br>and it’s role in the array.</p>
<p>Once started with RUN_ARRAY, uninitialized spares can be added with<br>HOT_ADD_DISK.</p>
<h2 id="MD-devices-in-sysfs"><a href="#MD-devices-in-sysfs" class="headerlink" title="MD devices in sysfs"></a>MD devices in sysfs</h2><p>md devices appear in sysfs (/sys) as regular block devices,<br>e.g.<br>   /sys/block/md0</p>
<p>Each ‘md’ device will contain a subdirectory called ‘md’ which<br>contains further md-specific information about the device.</p>
<p>All md devices contain:<br>  level<br>     a text file indicating the ‘raid level’. e.g. raid0, raid1,<br>     raid5, linear, multipath, faulty.<br>     If no raid level has been set yet (array is still being<br>     assembled), the value will reflect whatever has been written<br>     to it, which may be a name like the above, or may be a number<br>     such as ‘0’, ‘5’, etc.</p>
<p>  raid_disks<br>     a text file with a simple number indicating the number of devices<br>     in a fully functional array.  If this is not yet known, the file<br>     will be empty.  If an array is being resized this will contain<br>     the new number of devices.<br>     Some raid levels allow this value to be set while the array is<br>     active.  This will reconfigure the array.   Otherwise it can only<br>     be set while assembling an array.<br>     A change to this attribute will not be permitted if it would<br>     reduce the size of the array.  To reduce the number of drives<br>     in an e.g. raid5, the array size must first be reduced by<br>     setting the ‘array_size’ attribute.</p>
<p>  chunk_size<br>     This is the size in bytes for ‘chunks’ and is only relevant to<br>     raid levels that involve striping (0,4,5,6,10). The address space<br>     of the array is conceptually divided into chunks and consecutive<br>     chunks are striped onto neighbouring devices.<br>     The size should be at least PAGE_SIZE (4k) and should be a power<br>     of 2.  This can only be set while assembling an array</p>
<p>  layout<br>     The “layout” for the array for the particular level.  This is<br>     simply a number that is interpretted differently by different<br>     levels.  It can be written while assembling an array.</p>
<p>  array_size<br>     This can be used to artificially constrain the available space in<br>     the array to be less than is actually available on the combined<br>     devices.  Writing a number (in Kilobytes) which is less than<br>     the available size will set the size.  Any reconfiguration of the<br>     array (e.g. adding devices) will not cause the size to change.<br>     Writing the word ‘default’ will cause the effective size of the<br>     array to be whatever size is actually available based on<br>     ‘level’, ‘chunk_size’ and ‘component_size’.</p>
<pre><code> This can be used to reduce the size of the array before reducing
 the number of devices in a raid4/5/6, or to support external
 metadata formats which mandate such clipping.
</code></pre>
<p>  reshape_position<br>     This is either “none” or a sector number within the devices of<br>     the array where “reshape” is up to.  If this is set, the three<br>     attributes mentioned above (raid_disks, chunk_size, layout) can<br>     potentially have 2 values, an old and a new value.  If these<br>     values differ, reading the attribute returns<br>        new (old)<br>     and writing will effect the ‘new’ value, leaving the ‘old’<br>     unchanged.</p>
<p>  component_size<br>     For arrays with data redundancy (i.e. not raid0, linear, faulty,<br>     multipath), all components must be the same size - or at least<br>     there must a size that they all provide space for.  This is a key<br>     part or the geometry of the array.  It is measured in sectors<br>     and can be read from here.  Writing to this value may resize<br>     the array if the personality supports it (raid1, raid5, raid6),<br>     and if the component drives are large enough.</p>
<p>  metadata_version<br>     This indicates the format that is being used to record metadata<br>     about the array.  It can be 0.90 (traditional format), 1.0, 1.1,<br>     1.2 (newer format in varying locations) or “none” indicating that<br>     the kernel isn’t managing metadata at all.<br>     Alternately it can be “external:” followed by a string which<br>     is set by user-space.  This indicates that metadata is managed<br>     by a user-space program.  Any device failure or other event that<br>     requires a metadata update will cause array activity to be<br>     suspended until the event is acknowledged.</p>
<p>  resync_start<br>     The point at which resync should start.  If no resync is needed,<br>     this will be a very large number (or ‘none’ since 2.6.30-rc1).  At<br>     array creation it will default to 0, though starting the array as<br>     ‘clean’ will set it much larger.</p>
<p>   new_dev<br>     This file can be written but not read.  The value written should<br>     be a block device number as major:minor.  e.g. 8:0<br>     This will cause that device to be attached to the array, if it is<br>     available.  It will then appear at md/dev-XXX (depending on the<br>     name of the device) and further configuration is then possible.</p>
<p>   safe_mode_delay<br>     When an md array has seen no write requests for a certain period<br>     of time, it will be marked as ‘clean’.  When another write<br>     request arrives, the array is marked as ‘dirty’ before the write<br>     commences.  This is known as ‘safe_mode’.<br>     The ‘certain period’ is controlled by this file which stores the<br>     period as a number of seconds.  The default is 200msec (0.200).<br>     Writing a value of 0 disables safemode.</p>
<p>   array_state<br>     This file contains a single word which describes the current<br>     state of the array.  In many cases, the state can be set by<br>     writing the word for the desired state, however some states<br>     cannot be explicitly set, and some transitions are not allowed.</p>
<pre><code> Select/poll works on this file.  All changes except between
     active_idle and active (which can be frequent and are not
very interesting) are notified.  active-&gt;active_idle is
reported if the metadata is externally managed.

 clear
     No devices, no size, no level
     Writing is equivalent to STOP_ARRAY ioctl
 inactive
     May have some settings, but array is not active
        all IO results in error
     When written, doesn&#39;t tear down array, but just stops it
 suspended (not supported yet)
     All IO requests will block. The array can be reconfigured.
     Writing this, if accepted, will block until array is quiessent
 readonly
     no resync can happen.  no superblocks get written.
     write requests fail
 read-auto
     like readonly, but behaves like &#39;clean&#39; on a write request.

 clean - no pending writes, but otherwise active.
     When written to inactive array, starts without resync
     If a write request arrives then
       if metadata is known, mark &#39;dirty&#39; and switch to &#39;active&#39;.
       if not known, block and switch to write-pending
     If written to an active array that has pending writes, then fails.
 active
     fully active: IO and resync can be happening.
     When written to inactive array, starts with resync

 write-pending
     clean, but writes are blocked waiting for &#39;active&#39; to be written.

 active-idle
     like active, but no writes have been seen for a while (safe_mode_delay).
</code></pre>
<p>  bitmap/location<br>     This indicates where the write-intent bitmap for the array is<br>     stored.<br>     It can be one of “none”, “file” or “[+-]N”.<br>     “file” may later be extended to “file:/file/name”<br>     “[+-]N” means that many sectors from the start of the metadata.<br>       This is replicated on all devices.  For arrays with externally<br>       managed metadata, the offset is from the beginning of the<br>       device.<br>  bitmap/chunksize<br>     The size, in bytes, of the chunk which will be represented by a<br>     single bit.  For RAID456, it is a portion of an individual<br>     device. For RAID10, it is a portion of the array.  For RAID1, it<br>     is both (they come to the same thing).<br>  bitmap/time_base<br>     The time, in seconds, between looking for bits in the bitmap to<br>     be cleared. In the current implementation, a bit will be cleared<br>     between 2 and 3 times “time_base” after all the covered blocks<br>     are known to be in-sync.<br>  bitmap/backlog<br>     When write-mostly devices are active in a RAID1, write requests<br>     to those devices proceed in the background - the filesystem (or<br>     other user of the device) does not have to wait for them.<br>     ‘backlog’ sets a limit on the number of concurrent background<br>     writes.  If there are more than this, new writes will by<br>     synchronous.<br>  bitmap/metadata<br>     This can be either ‘internal’ or ‘external’.<br>     ‘internal’ is the default and means the metadata for the bitmap<br>     is stored in the first 256 bytes of the allocated space and is<br>     managed by the md module.<br>     ‘external’ means that bitmap metadata is managed externally to<br>     the kernel (i.e. by some userspace program)<br>  bitmap/can_clear<br>     This is either ‘true’ or ‘false’.  If ‘true’, then bits in the<br>     bitmap will be cleared when the corresponding blocks are thought<br>     to be in-sync.  If ‘false’, bits will never be cleared.<br>     This is automatically set to ‘false’ if a write happens on a<br>     degraded array, or if the array becomes degraded during a write.<br>     When metadata is managed externally, it should be set to true<br>     once the array becomes non-degraded, and this fact has been<br>     recorded in the metadata.</p>
<p>As component devices are added to an md array, they appear in the ‘md’<br>directory as new directories named<br>      dev-XXX<br>where XXX is a name that the kernel knows for the device, e.g. hdb1.<br>Each directory contains:</p>
<pre><code>  block
    a symlink to the block device in /sys/block, e.g.
     /sys/block/md0/md/dev-hdb1/block -&gt; ../../../../block/hdb/hdb1

  super
    A file containing an image of the superblock read from, or
    written to, that device.

  state
A file recording the current state of the device in the array
which can be a comma separated list of
      faulty   - device has been kicked from active use due to
         a detected fault, or it has unacknowledged bad
         blocks
      in_sync  - device is a fully in-sync member of the array
      writemostly - device will only be subject to read
         requests if there are no other options.
         This applies only to raid1 arrays.
      blocked  - device has failed, and the failure hasn&#39;t been
         acknowledged yet by the metadata handler.
         Writes that would write to this device if
         it were not faulty are blocked.
      spare    - device is working, but not a full member.
         This includes spares that are in the process
         of being recovered to
      write_error - device has ever seen a write error.
      want_replacement - device is (mostly) working but probably
         should be replaced, either due to errors or
         due to user request.
      replacement - device is a replacement for another active
         device with same raid_disk.


This list may grow in future.
This can be written to.
Writing &quot;faulty&quot;  simulates a failure on the device.
Writing &quot;remove&quot; removes the device from the array.
Writing &quot;writemostly&quot; sets the writemostly flag.
Writing &quot;-writemostly&quot; clears the writemostly flag.
Writing &quot;blocked&quot; sets the &quot;blocked&quot; flag.
Writing &quot;-blocked&quot; clears the &quot;blocked&quot; flags and allows writes
    to complete and possibly simulates an error.
Writing &quot;in_sync&quot; sets the in_sync flag.
Writing &quot;write_error&quot; sets writeerrorseen flag.
Writing &quot;-write_error&quot; clears writeerrorseen flag.
Writing &quot;want_replacement&quot; is allowed at any time except to a
    replacement device or a spare.  It sets the flag.
Writing &quot;-want_replacement&quot; is allowed at any time.  It clears
    the flag.
Writing &quot;replacement&quot; or &quot;-replacement&quot; is only allowed before
    starting the array.  It sets or clears the flag.


This file responds to select/poll. Any change to &#39;faulty&#39;
or &#39;blocked&#39; causes an event.

  errors
An approximate count of read errors that have been detected on
this device but have not caused the device to be evicted from
the array (either because they were corrected or because they
happened while the array was read-only).  When using version-1
metadata, this value persists across restarts of the array.

This value can be written while assembling an array thus
providing an ongoing count for arrays with metadata managed by
userspace.

  slot
    This gives the role that the device has in the array.  It will
either be &#39;none&#39; if the device is not active in the array
    (i.e. is a spare or has failed) or an integer less than the
&#39;raid_disks&#39; number for the array indicating which position
it currently fills.  This can only be set while assembling an
array.  A device for which this is set is assumed to be working.

  offset
    This gives the location in the device (in sectors from the
    start) where data from the array will be stored.  Any part of
    the device before this offset is not touched, unless it is
    used for storing metadata (Formats 1.1 and 1.2).

  size
    The amount of the device, after the offset, that can be used
    for storage of data.  This will normally be the same as the
component_size.  This can be written while assembling an
    array.  If a value less than the current component_size is
    written, it will be rejected.

  recovery_start

    When the device is not &#39;in_sync&#39;, this records the number of
sectors from the start of the device which are known to be
correct.  This is normally zero, but during a recovery
operation it will steadily increase, and if the recovery is
interrupted, restoring this value can cause recovery to
avoid repeating the earlier blocks.  With v1.x metadata, this
value is saved and restored automatically.

This can be set whenever the device is not an active member of
the array, either before the array is activated, or before
the &#39;slot&#39; is set.

Setting this to &#39;none&#39; is equivalent to setting &#39;in_sync&#39;.
Setting to any other value also clears the &#39;in_sync&#39; flag.
</code></pre>
<p>An active md device will also contain an entry for each active device<br>in the array.  These are named</p>
<pre><code>rdNN
</code></pre>
<p>where ‘NN’ is the position in the array, starting from 0.<br>So for a 3 drive array there will be rd0, rd1, rd2.<br>These are symbolic links to the appropriate ‘dev-XXX’ entry.<br>Thus, for example,<br>       cat /sys/block/md*/md/rd*/state<br>will show ‘in_sync’ on every line.</p>
<p>Active md devices for levels that support data redundancy (1,4,5,6,10)<br>also have</p>
<p>   sync_action<br>     a text file that can be used to monitor and control the rebuild<br>     process.  It contains one word which can be one of:<br>       resync        - redundancy is being recalculated after unclean<br>                       shutdown or creation<br>       recover       - a hot spare is being built to replace a<br>                       failed/missing device<br>       idle          - nothing is happening<br>       check         - A full check of redundancy was requested and is<br>                       happening.  This reads all blocks and checks<br>                       them. A repair may also happen for some raid<br>                       levels.<br>       repair        - A full check and repair is happening.  This is<br>                       similar to ‘resync’, but was requested by the<br>                       user, and the write-intent bitmap is NOT used to<br>               optimise the process.</p>
<pre><code>  This file is writable, and each of the strings that could be
  read are meaningful for writing.

   &#39;idle&#39; will stop an active resync/recovery etc.  There is no
       guarantee that another resync/recovery may not be automatically
   started again, though some event will be needed to trigger
       this.
&#39;resync&#39; or &#39;recovery&#39; can be used to restart the
       corresponding operation if it was stopped with &#39;idle&#39;.
&#39;check&#39; and &#39;repair&#39; will start the appropriate process
       providing the current state is &#39;idle&#39;.

  This file responds to select/poll.  Any important change in the value
  triggers a poll event.  Sometimes the value will briefly be
  &quot;recover&quot; if a recovery seems to be needed, but cannot be
  achieved. In that case, the transition to &quot;recover&quot; isn&#39;t
  notified, but the transition away is.
</code></pre>
<p>   degraded<br>      This contains a count of the number of devices by which the<br>      arrays is degraded.  So an optimal array will show ‘0’.  A<br>      single failed/missing drive will show ‘1’, etc.<br>      This file responds to select/poll, any increase or decrease<br>      in the count of missing devices will trigger an event.</p>
<p>   mismatch_count<br>      When performing ‘check’ and ‘repair’, and possibly when<br>      performing ‘resync’, md will count the number of errors that are<br>      found.  The count in ‘mismatch_cnt’ is the number of sectors<br>      that were re-written, or (for ‘check’) would have been<br>      re-written.  As most raid levels work in units of pages rather<br>      than sectors, this my be larger than the number of actual errors<br>      by a factor of the number of sectors in a page.</p>
<p>   bitmap_set_bits<br>      If the array has a write-intent bitmap, then writing to this<br>      attribute can set bits in the bitmap, indicating that a resync<br>      would need to check the corresponding blocks. Either individual<br>      numbers or start-end pairs can be written.  Multiple numbers<br>      can be separated by a space.<br>      Note that the numbers are ‘bit’ numbers, not ‘block’ numbers.<br>      They should be scaled by the bitmap_chunksize.</p>
<p>   sync_speed_min<br>   sync_speed_max<br>     This are similar to /proc/sys/dev/raid/speed_limit_{min,max}<br>     however they only apply to the particular array.<br>     If no value has been written to these, of if the word ‘system’<br>     is written, then the system-wide value is used.  If a value,<br>     in kibibytes-per-second is written, then it is used.<br>     When the files are read, they show the currently active value<br>     followed by “(local)” or “(system)” depending on whether it is<br>     a locally set or system-wide value.</p>
<p>   sync_completed<br>     This shows the number of sectors that have been completed of<br>     whatever the current sync_action is, followed by the number of<br>     sectors in total that could need to be processed.  The two<br>     numbers are separated by a ‘/‘  thus effectively showing one<br>     value, a fraction of the process that is complete.<br>     A ‘select’ on this attribute will return when resync completes,<br>     when it reaches the current sync_max (below) and possibly at<br>     other times.</p>
<p>   sync_max<br>     This is a number of sectors at which point a resync/recovery<br>     process will pause.  When a resync is active, the value can<br>     only ever be increased, never decreased.  The value of ‘max’<br>     effectively disables the limit.</p>
<p>   sync_speed<br>     This shows the current actual speed, in K/sec, of the current<br>     sync_action.  It is averaged over the last 30 seconds.</p>
<p>   suspend_lo<br>   suspend_hi<br>     The two values, given as numbers of sectors, indicate a range<br>     within the array where IO will be blocked.  This is currently<br>     only supported for raid4/5/6.</p>
<p>Each active md device may also have attributes specific to the<br>personality module that manages it.<br>These are specific to the implementation of the module and could<br>change substantially if the implementation changes.</p>
<p>These currently include</p>
<p>  stripe_cache_size  (currently raid5 only)<br>      number of entries in the stripe cache.  This is writable, but<br>      there are upper and lower limits (32768, 16).  Default is 128.<br>  strip_cache_active (currently raid5 only)<br>      number of active entries in the stripe cache<br>  preread_bypass_threshold (currently raid5 only)<br>      number of times a stripe requiring preread will be bypassed by<br>      a stripe that does not require preread.  For fairness defaults<br>      to 1.  Setting this to 0 disables bypass accounting and<br>      requires preread stripes to wait until all full-width stripe-<br>      writes are complete.  Valid values are 0 to stripe_cache_size.</p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_md/" title="Kernel-2.6.32-573.12.1.el6_" target="_blank" rel="external">http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_md/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">oosTech by Sam Lee</span><small class="ml-1x"></small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    

  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_modules/" title="Kernel-2.6.32-573.12.1.el6_modules"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_matroxfb/" title="Kernel-2.6.32-573.12.1.el6_matroxfb"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,wechat"></div>
    
  </div>
  </div>
    <div class="container" align="left">
    <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
      <img src="/images/wechatp.png" itemprop="contentUrl">
      <span>欢迎关注公众号</span>
    </div>
    </div>
</nav>

  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>您能有收获就是我们最大的动力</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码捐赠</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码捐赠</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
	<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn" text-align: center >粤ICP备2021024811号</a>
        </div>
<!--    
    <div>
     <img src="/images/logo.png" width="140" height="140">
    </div>
-->
    </div>


        <!-- 不蒜子统计    //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <!--<span id="busuanzi_container_site_pv" style="display:inline;">-->本站总访问量<span id="busuanzi_value_site_pv" style="display:inline;></span>次</span>
        <span class="post-meta-divider">|</span>
  
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>







   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>











</body>
</html>