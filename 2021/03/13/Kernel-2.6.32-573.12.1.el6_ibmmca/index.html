<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>Kernel-2.6.32-573.12.1.el6_ibmmca | oosTech.com</title>
  <meta name="description" content="-&#x3D;&lt; The IBM Microchannel SCSI-Subsystem &gt;&#x3D;-                          for the IBM PS&#x2F;2 series                Low Level Software-Driver for Linux        Copyright (c) 1995 Strom Systems">
<meta property="og:type" content="article">
<meta property="og:title" content="Kernel-2.6.32-573.12.1.el6_ibmmca">
<meta property="og:url" content="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_ibmmca/index.html">
<meta property="og:site_name" content="oosTech">
<meta property="og:description" content="-&#x3D;&lt; The IBM Microchannel SCSI-Subsystem &gt;&#x3D;-                          for the IBM PS&#x2F;2 series                Low Level Software-Driver for Linux        Copyright (c) 1995 Strom Systems">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:modified_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:author" content="Sam Lee">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_ibmmca/index.html">
  
    <link rel="alternate" href="/atom.xml" title="oosTech" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img src="/images/avatar.png" width="400" height="400">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">oosTech by Sam Lee</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="站内搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">站点首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档文档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">文档分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">常用链接</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">共享白板</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告牌</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p> 欢迎来到oosTech ，我是一个Linux 拥趸：D。 目前正在用的Linux 版本是 Red Hat Enterprise Linux release 8.3 </p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">文档分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a><span class="category-list-count">830</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a><span class="category-list-count">1658</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-4-18-0-80-el8-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_4.18.0-80.el8_内核文档</a><span class="category-list-count">3937</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3270/" class="title">Kernel-3.10.0-957.el7_3270</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_devices/" class="title">Kernel-2.6.32-573.12.1.el6_devices</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3c509/" class="title">Kernel-3.10.0-957.el7_3c509</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_4CCs/" class="title">Kernel-3.10.0-957.el7_4CCs</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_53c700/" class="title">Kernel-3.10.0-957.el7_53c700</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-you-Start"><span class="toc-number">1.</span> <span class="toc-text">   Before you Start</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Authors-of-this-Driver"><span class="toc-number">2.</span> <span class="toc-text">   Authors of this Driver</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Table-of-Contents"><span class="toc-number">3.</span> <span class="toc-text">   Table of Contents</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Abstract"><span class="toc-number">4.</span> <span class="toc-text">   1 Abstract</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Driver-Description"><span class="toc-number">5.</span> <span class="toc-text">   2 Driver Description</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-IBM-SCSI-Subsystem-Detection"><span class="toc-number">6.</span> <span class="toc-text">   2.1 IBM SCSI-Subsystem Detection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-Physical-Units-Logical-Units-and-Logical-Devices"><span class="toc-number">7.</span> <span class="toc-text">   2.2 Physical Units, Logical Units, and Logical Devices</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-SCSI-Device-Recognition-and-Dynamical-ldn-Assignment"><span class="toc-number">8.</span> <span class="toc-text">   2.3 SCSI-Device Recognition and Dynamical ldn Assignment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-SCSI-Device-Order"><span class="toc-number">9.</span> <span class="toc-text">   2.4 SCSI-Device Order</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-Regular-SCSI-Command-Processing"><span class="toc-number">10.</span> <span class="toc-text">   2.5 Regular SCSI-Command-Processing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-Abort-amp-Reset-Commands"><span class="toc-number">11.</span> <span class="toc-text">   2.6 Abort &amp; Reset Commands</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-Disk-Geometry"><span class="toc-number">12.</span> <span class="toc-text">   2.7 Disk Geometry</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-8-Kernel-Boot-Option"><span class="toc-number">13.</span> <span class="toc-text">   2.8 Kernel Boot Option</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-9-Driver-Module-Support"><span class="toc-number">14.</span> <span class="toc-text">   2.9 Driver Module Support</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-10-Multiple-Hostadapter-Support"><span class="toc-number">15.</span> <span class="toc-text">   2.10 Multiple Hostadapter Support</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-11-proc-scsi-Filesystem-Information"><span class="toc-number">16.</span> <span class="toc-text">   2.11 &#x2F;proc&#x2F;scsi-Filesystem Information</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-12-proc-mca-Filesystem-Information"><span class="toc-number">17.</span> <span class="toc-text">   2.12 &#x2F;proc&#x2F;mca-Filesystem Information</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-13-Supported-IBM-SCSI-Subsystems"><span class="toc-number">18.</span> <span class="toc-text">   2.13 Supported IBM SCSI-Subsystems</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-14-Linux-Kernel-Versions"><span class="toc-number">19.</span> <span class="toc-text">   2.14 Linux Kernel Versions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Code-History"><span class="toc-number">20.</span> <span class="toc-text">   3 Code History</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Users%E2%80%99-Manual"><span class="toc-number">21.</span> <span class="toc-text">   5 Users’ Manual</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-Commandline-Parameters"><span class="toc-number">22.</span> <span class="toc-text">   5.1 Commandline Parameters</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-Troubleshooting"><span class="toc-number">23.</span> <span class="toc-text">   5.2 Troubleshooting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-Bug-reports"><span class="toc-number">24.</span> <span class="toc-text">   5.3 Bug reports</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-Support-WWW-page"><span class="toc-number">25.</span> <span class="toc-text">   5.4 Support WWW-page</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-References"><span class="toc-number">26.</span> <span class="toc-text">   6 References</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Credits-to"><span class="toc-number">27.</span> <span class="toc-text">   7 Credits to</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-People"><span class="toc-number">28.</span> <span class="toc-text">   7.1 People</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-Sponsors-amp-Supporters"><span class="toc-number">29.</span> <span class="toc-text">   7.2 Sponsors &amp; Supporters</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Trademarks"><span class="toc-number">30.</span> <span class="toc-text">   8 Trademarks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-Disclaimer"><span class="toc-number">31.</span> <span class="toc-text">   9 Disclaimer</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Kernel-2.6.32-573.12.1.el6_ibmmca" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Kernel-2.6.32-573.12.1.el6_ibmmca
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_ibmmca/" class="article-date">
	 published: <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
	</a>
</span>

        
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_ibmmca/" class="article-date">
	   updated: <time datetime="2021-03-12T16:00:00.000Z" itemprop="dateUpdated">2021-03-13</time>
	</a>


        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
  </span>

        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill"></i>
	    <!--<span id="busuanzi_container_page_pv" style="display:inline;">-->
			<span id="busuanzi_value_page_pv" style="display:inline;"></span>
		<!--</span>-->
	</span>



        <!--<span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_ibmmca/#comments" class="article-comment-link">评论</a></span> -->
        
	
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <pre><code>           -=&lt; The IBM Microchannel SCSI-Subsystem &gt;=-
       
                 for the IBM PS/2 series
     
         Low Level Software-Driver for Linux
     
 Copyright (c) 1995 Strom Systems, Inc. under the terms of the GNU 
</code></pre>
<p>  General Public License. Originally written by Martin Kolinek, December 1995.<br>   Officially modified and maintained by Michael Lang since January 1999.</p>
<pre><code>                        Version 4.0a
</code></pre>
<p>   Last update: January 3, 2001</p>
<h2 id="Before-you-Start"><a href="#Before-you-Start" class="headerlink" title="   Before you Start"></a>   Before you Start</h2><p>   This is the common README.ibmmca file for all driver releases of the<br>   IBM MCA SCSI driver for Linux. Please note, that driver releases 4.0<br>   or newer do not work with kernel versions older than 2.4.0, while driver<br>   versions older than 4.0 do not work with kernels 2.4.0 or later! If you<br>   try to compile your kernel with the wrong driver source, the<br>   compilation is aborted and you get a corresponding error message. This is<br>   no bug in the driver; it prevents you from using the wrong source code<br>   with the wrong kernel version.</p>
<h2 id="Authors-of-this-Driver"><a href="#Authors-of-this-Driver" class="headerlink" title="   Authors of this Driver"></a>   Authors of this Driver</h2><pre><code>- Chris Beauregard (improvement of the SCSI-device mapping by the driver)
- Martin Kolinek (origin, first release of this driver)
- Klaus Kudielka (multiple SCSI-host management/detection, adaption to
                  Linux Kernel 2.1.x, module support)
- Michael Lang (assigning original pun/lun mapping, dynamical ldn
                assignment, rewritten adapter detection, this file, 
        patches, official driver maintenance and subsequent 
        debugging, related with the driver)
</code></pre>
<h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="   Table of Contents"></a>   Table of Contents</h2><p>   1 Abstract<br>   2 Driver Description<br>     2.1  IBM SCSI-Subsystem Detection<br>     2.2  Physical Units, Logical Units, and Logical Devices<br>     2.3  SCSI-Device Recognition and dynamical ldn Assignment<br>     2.4  SCSI-Device Order<br>     2.5  Regular SCSI-Command-Processing<br>     2.6  Abort &amp; Reset Commands<br>     2.7  Disk Geometry<br>     2.8  Kernel Boot Option<br>     2.9  Driver Module Support<br>     2.10 Multiple Hostadapter Support<br>     2.11 /proc/scsi-Filesystem Information<br>     2.12 /proc/mca-Filesystem Information<br>     2.13 Supported IBM SCSI-Subsystems<br>     2.14 Linux Kernel Versions<br>   3 Code History<br>   4 To do<br>   5 Users’ Manual<br>     5.1 Commandline Parameters<br>     5.2 Troubleshooting<br>     5.3 Bug reports<br>     5.4 Support WWW-page<br>   6 References<br>   7 Credits to<br>     7.1 People<br>     7.2 Sponsors &amp; Supporters<br>   8 Trademarks<br>   9 Disclaimer</p>
<pre><code>                          * * *
</code></pre>
<h2 id="1-Abstract"><a href="#1-Abstract" class="headerlink" title="   1 Abstract"></a>   1 Abstract</h2><p>   This README-file describes the IBM SCSI-subsystem low level driver for<br>   Linux. The descriptions which were formerly kept in the source code have<br>   been taken out of this file to simplify the codes readability. The driver<br>   description has been updated, as most of the former description was already<br>   quite outdated. The history of the driver development is also kept inside<br>   here. Multiple historical developments have been summarized to shorten the<br>   text size a bit. At the end of this file you can find a small manual for<br>   this driver and hints to get it running on your machine.</p>
<h2 id="2-Driver-Description"><a href="#2-Driver-Description" class="headerlink" title="   2 Driver Description"></a>   2 Driver Description</h2><h2 id="2-1-IBM-SCSI-Subsystem-Detection"><a href="#2-1-IBM-SCSI-Subsystem-Detection" class="headerlink" title="   2.1 IBM SCSI-Subsystem Detection"></a>   2.1 IBM SCSI-Subsystem Detection</h2><p>   This is done in the ibmmca_detect() function. It first checks, if the<br>   Microchannel-bus support is enabled, as the IBM SCSI-subsystem needs the<br>   Microchannel. In a next step, a free interrupt is chosen and the main<br>   interrupt handler is connected to it to handle answers of the SCSI-<br>   subsystem(s). If the F/W SCSI-adapter is forced by the BIOS to use IRQ11<br>   instead of IRQ14, IRQ11 is used for the IBM SCSI-2 F/W adapter. In a<br>   further step it is checked, if the adapter gets detected by force from<br>   the kernel commandline, where the I/O port and the SCSI-subsystem id can<br>   be specified. The next step checks if there is an integrated SCSI-subsystem<br>   installed. This register area is fixed through all IBM PS/2 MCA-machines<br>   and appears as something like a virtual slot 10 of the MCA-bus. On most<br>   PS/2 machines, the POS registers of slot 10 are set to 0xff or 0x00 if not<br>   integrated SCSI-controller is available. But on certain PS/2s, like model<br>   9595, this slot 10 is used to store other information which at earlier<br>   stage confused the driver and resulted in the detection of some ghost-SCSI.<br>   If POS-register 2 and 3 are not 0x00 and not 0xff, but all other POS<br>   registers are either 0xff or 0x00, there must be an integrated SCSI-<br>   subsystem present and it will be registered as IBM Integrated SCSI-<br>   Subsystem. The next step checks, if there is a slot-adapter installed on<br>   the MCA-bus. To get this, the first two POS-registers, that represent the<br>   adapter ID are checked. If they fit to one of the ids, stored in the<br>   adapter list, a SCSI-subsystem is assumed to be found in a slot and will be<br>   registered. This check is done through all possible MCA-bus slots to allow<br>   more than one SCSI-adapter to be present in the PS/2-system and this is<br>   already the first point of problems. Looking into the technical reference<br>   manual for the IBM PS/2 common interfaces, the POS2 register must have<br>   different interpretation of its single bits to avoid overlapping I/O<br>   regions. While one can assume, that the integrated subsystem has a fix<br>   I/O-address at 0x3540 - 0x3547, further installed IBM SCSI-adapters must<br>   use a different I/O-address. This is expressed by bit 1 to 3 of POS2<br>   (multiplied by 8 + 0x3540). Bits 2 and 3 are reserved for the integrated<br>   subsystem, but not for the adapters! The following list shows, how the<br>   bits of POS2 and POS3 should be interpreted.</p>
<p>   The POS2-register of all PS/2 models’ integrated SCSI-subsystems has the<br>   following interpretation of bits:<br>                           Bit 7 - 4 : Chip Revision ID (Release)<br>                           Bit 3 - 2 : Reserved<br>                           Bit 1     : 8k NVRAM Disabled<br>                           Bit 0     : Chip Enable (EN-Signal)<br>   The POS3-register is interpreted as follows (for most IBM SCSI-subsys.):<br>                           Bit 7 - 5 : SCSI ID<br>                           Bit 4 - 0 : Reserved = 0<br>   The slot-adapters have different interpretation of these bits. The IBM SCSI<br>   adapter (w/Cache) and the IBM SCSI-2 F/W adapter use the following<br>   interpretation of the POS2 register:<br>                           Bit 7 - 4 : ROM Segment Address Select<br>               Bit 3 - 1 : Adapter I/O Address Select (*8+0x3540)<br>               Bit 0     : Adapter Enable (EN-Signal)<br>   and for the POS3 register:<br>                           Bit 7 - 5 : SCSI ID<br>               Bit 4     : Fairness Enable (SCSI ID3 f. F/W)<br>               Bit 3 - 0 : Arbitration Level<br>   The most modern product of the series is the IBM SCSI-2 F/W adapter, it<br>   allows dual-bus SCSI and SCSI-wide addressing, which means, PUNs may be<br>   between 0 and 15. Here, Bit 4 is the high-order bit of the 4-bit wide<br>   adapter PUN expression. In short words, this means, that IBM PS/2 machines<br>   can only support 1 single integrated subsystem by default. Additional<br>   slot-adapters get ports assigned by the automatic configuration tool.</p>
<p>   One day I found a patch in ibmmca_detect(), forcing the I/O-address to be<br>   0x3540 for integrated SCSI-subsystems, there was a remark placed, that on<br>   integrated IBM SCSI-subsystems of model 56, the POS2 register was showing 5.<br>   This means, that really for these models, POS2 has to be interpreted<br>   sticking to the technical reference guide. In this case, the bit 2 (4) is<br>   a reserved bit and may not be interpreted. These differences between the<br>   adapters and the integrated controllers are taken into account by the<br>   detection routine of the driver on from version &gt;3.0g. </p>
<p>   Every time, a SCSI-subsystem is discovered, the ibmmca_register() function<br>   is called. This function checks first, if the requested area for the I/O-<br>   address of this SCSI-subsystem is still available and assigns this I/O-<br>   area to the SCSI-subsystem. There are always 8 sequential I/O-addresses<br>   taken for each individual SCSI-subsystem found, which are:</p>
<pre><code> Offset            Type                  Permissions
   0     Command Interface Register 1    Read/Write
   1     Command Interface Register 2    Read/Write
   2     Command Interface Register 3    Read/Write
   3     Command Interface Register 4    Read/Write
   4     Attention Register              Read/Write
   5     Basic Control Register          Read/Write
   6     Interrupt Status Register       Read
   7     Basic Status Register           Read
</code></pre>
<p>   After the I/O-address range is assigned, the host-adapter is assigned<br>   to a local structure which keeps all adapter information needed for the<br>   driver itself and the mid- and higher-level SCSI-drivers. The SCSI pun/lun<br>   and the adapters’ ldn tables are initialized and get probed afterwards by<br>   the check_devices() function. If no further adapters are found,<br>   ibmmca_detect() quits.</p>
<h2 id="2-2-Physical-Units-Logical-Units-and-Logical-Devices"><a href="#2-2-Physical-Units-Logical-Units-and-Logical-Devices" class="headerlink" title="   2.2 Physical Units, Logical Units, and Logical Devices"></a>   2.2 Physical Units, Logical Units, and Logical Devices</h2><p>   There can be up to 56 devices on the SCSI bus (besides the adapter):<br>   there are up to 7 “physical units” (each identified by physical unit<br>   number or pun, also called the scsi id, this is the number you select<br>   with hardware jumpers), and each physical unit can have up to 8<br>   “logical units” (each identified by logical unit number, or lun,<br>   between 0 and 7). The IBM SCSI-2 F/W adapter offers this on up to two<br>   busses and provides support for 30 logical devices at the same time, where<br>   in wide-addressing mode you can have 16 puns with 32 luns on each device.<br>   This section describes the handling of devices on non-F/W adapters.<br>   Just imagine, that you can have 16 * 32 = 512 devices on a F/W adapter<br>   which means a lot of possible devices for such a small machine.</p>
<p>   Typically the adapter has pun=7, so puns of other physical units<br>   are between 0 and 6(15). On a wide-adapter a pun higher than 7 is<br>   possible, but is normally not used. Almost all physical units have only<br>   one logical unit, with lun=0. A CD-ROM jukebox would be an example of a<br>   physical unit with more than one logical unit.</p>
<p>   The embedded microprocessor of the IBM SCSI-subsystem hides the complex<br>   two-dimensional (pun,lun) organization from the operating system.<br>   When the machine is powered-up (or rebooted), the embedded microprocessor<br>   checks, on its own, all 56 possible (pun,lun) combinations, and the first<br>   15 devices found are assigned into a one-dimensional array of so-called<br>   “logical devices”, identified by “logical device numbers” or ldn. The last<br>   ldn=15 is reserved for the subsystem itself. Wide adapters may have<br>   to check up to 15 * 8 = 120 pun/lun combinations.</p>
<h2 id="2-3-SCSI-Device-Recognition-and-Dynamical-ldn-Assignment"><a href="#2-3-SCSI-Device-Recognition-and-Dynamical-ldn-Assignment" class="headerlink" title="   2.3 SCSI-Device Recognition and Dynamical ldn Assignment"></a>   2.3 SCSI-Device Recognition and Dynamical ldn Assignment</h2><p>   One consequence of information hiding is that the real (pun,lun)<br>   numbers are also hidden. The two possibilities to get around this problem<br>   are to offer fake pun/lun combinations to the operating system or to<br>   delete the whole mapping of the adapter and to reassign the ldns, using<br>   the immediate assign command of the SCSI-subsystem for probing through<br>   all possible pun/lun combinations.  An ldn is a “logical device number”<br>   which is used by IBM SCSI-subsystems to access some valid SCSI-device.<br>   At the beginning of the development of this driver, the following approach<br>   was used:</p>
<p>   First, the driver checked the ldn’s (0 to 6) to find out which ldn’s<br>   have devices assigned. This was done by the functions check_devices() and<br>   device_exists(). The interrupt handler has a special paragraph of code<br>   (see local_checking_phase_flag) to assist in the checking. Assume, for<br>   example, that three logical devices were found assigned at ldn 0, 1, 2.<br>   These are presented to the upper layer of Linux SCSI driver<br>   as devices with bogus (pun, lun) equal to (0,0), (1,0), (2,0).<br>   On the other hand, if the upper layer issues a command to device<br>   say (4,0), this driver returns DID_NO_CONNECT error.</p>
<p>   In a second step of the driver development, the following improvement has<br>   been applied: The first approach limited the number of devices to 7, far<br>   fewer than the 15 that it could use, then it just mapped ldn -&gt;<br>   (ldn/8,ldn%8) for pun,lun.  We ended up with a real mishmash of puns<br>   and luns, but it all seemed to work.</p>
<p>   The latest development, which is implemented from the driver version 3.0<br>   and later, realizes the device recognition in the following way:<br>   The physical SCSI-devices on the SCSI-bus are probed via immediate_assign-<br>   and device_inquiry-commands, that is all implemented in a completely new<br>   made check_devices() subroutine. This delivers an exact map of the physical<br>   SCSI-world that is now stored in the get_scsi[][]-array. This means,<br>   that the once hidden pun,lun assignment is now known to this driver.<br>   It no longer believes in default-settings of the subsystem and maps all<br>   ldns to existing pun,lun “by foot”. This assures full control of the ldn<br>   mapping and allows dynamical remapping of ldns to different pun,lun, if<br>   there are more SCSI-devices installed than ldns available (n&gt;15). The<br>   ldns from 0 to 6 get ‘hardwired’ by this driver to puns 0 to 7 at lun=0,<br>   excluding the pun of the subsystem. This assures, that at least simple<br>   SCSI-installations have optimum access-speed and are not touched by<br>   dynamical remapping. The ldns 7 to 14 are put to existing devices with<br>   lun&gt;0 or to non-existing devices, in order to satisfy the subsystem, if<br>   there are less than 15 SCSI-devices connected. In the case of more than 15<br>   devices, the dynamical mapping goes active. If the get_scsi[][] reports a<br>   device to be existent, but it has no ldn assigned, it gets an ldn out of 7<br>   to 14. The numbers are assigned in cyclic order, therefore it takes 8<br>   dynamical reassignments on the SCSI-devices until a certain device<br>   loses its ldn again. This assures that dynamical remapping is avoided<br>   during intense I/O between up to 15 SCSI-devices (means pun,lun<br>   combinations). A further advantage of this method is that people who<br>   build their kernel without probing on all luns will get what they expect,<br>   because the driver just won’t assign everything with lun&gt;0 when<br>   multiple lun probing is inactive.</p>
<h2 id="2-4-SCSI-Device-Order"><a href="#2-4-SCSI-Device-Order" class="headerlink" title="   2.4 SCSI-Device Order"></a>   2.4 SCSI-Device Order</h2><p>   Because of the now correct recognition of physical pun,lun, and<br>   their report to mid-level- and higher-level-drivers, the new reported puns<br>   can be different from the old, faked puns. Therefore, Linux will eventually<br>   change /dev/sdXXX assignments and prompt you for corrupted superblock<br>   repair on boottime. In this case DO NOT PANIC, YOUR DISKS ARE STILL OK!!!<br>   You have to reboot (CTRL-D) with an old kernel and set the /etc/fstab-file<br>   entries right. After that, the system should come up as errorfree as before.<br>   If your boot-partition is not coming up, also edit the /etc/lilo.conf-file<br>   in a Linux session booted on old kernel and run lilo before reboot. Check<br>   lilo.conf anyway to get boot on other partitions with foreign OSes right<br>   again. But there exists a feature of this driver that allows you to change<br>   the assignment order of the SCSI-devices by flipping the PUN-assignment.<br>   See the next paragraph for a description.</p>
<p>   The problem for this is, that Linux does not assign the SCSI-devices in the<br>   way as described in the ANSI-SCSI-standard. Linux assigns /dev/sda to<br>   the device with at minimum id 0. But the first drive should be at id 6,<br>   because for historical reasons, drive at id 6 has, by hardware, the highest<br>   priority and a drive at id 0 the lowest. IBM was one of the rare producers,<br>   where the BIOS assigns drives belonging to the ANSI-SCSI-standard. Most<br>   other producers’ BIOS does not (I think even Adaptec-BIOS). The<br>   IBMMCA_SCSI_ORDER_STANDARD flag, which you set while configuring the<br>   kernel enables to choose the preferred way of SCSI-device-assignment.<br>   Defining this flag would result in Linux determining the devices in the<br>   same order as DOS and OS/2 does on your MCA-machine. This is also standard<br>   on most industrial computers and OSes, like e.g. OS-9. Leaving this flag<br>   undefined will get your devices ordered in the default way of Linux. See<br>   also the remarks of Chris Beauregard from Dec 15, 1997 and the followups<br>   in section 3.</p>
<h2 id="2-5-Regular-SCSI-Command-Processing"><a href="#2-5-Regular-SCSI-Command-Processing" class="headerlink" title="   2.5 Regular SCSI-Command-Processing"></a>   2.5 Regular SCSI-Command-Processing</h2><p>   Only three functions get involved: ibmmca_queuecommand(), issue_cmd(),<br>   and interrupt_handler().</p>
<p>   The upper layer issues a scsi command by calling function<br>   ibmmca_queuecommand(). This function fills a “subsystem control block”<br>   (scb) and calls a local function issue_cmd(), which writes a scb<br>   command into subsystem I/O ports. Once the scb command is carried out,<br>   the interrupt_handler() is invoked. If a device is determined to be<br>   existant and it has not assigned any ldn, it gets one dynamically.<br>   For this, the whole stuff is done in ibmmca_queuecommand().</p>
<h2 id="2-6-Abort-amp-Reset-Commands"><a href="#2-6-Abort-amp-Reset-Commands" class="headerlink" title="   2.6 Abort &amp; Reset Commands"></a>   2.6 Abort &amp; Reset Commands</h2><p>   These are implemented with busy waiting for interrupt to arrive.<br>   ibmmca_reset() and ibmmca_abort() do not work sufficiently well<br>   up to now and need still a lot of development work. This seems<br>   to be a problem with other low-level SCSI drivers too, however<br>   this should be no excuse.</p>
<h2 id="2-7-Disk-Geometry"><a href="#2-7-Disk-Geometry" class="headerlink" title="   2.7 Disk Geometry"></a>   2.7 Disk Geometry</h2><p>   The ibmmca_biosparams() function should return the same disk geometry<br>   as the bios. This is needed for fdisk, etc. The returned geometry is<br>   certainly correct for disks smaller than 1 gigabyte. In the meantime,<br>   it has been proved, that this works fine even with disks larger than<br>   1 gigabyte.</p>
<h2 id="2-8-Kernel-Boot-Option"><a href="#2-8-Kernel-Boot-Option" class="headerlink" title="   2.8 Kernel Boot Option"></a>   2.8 Kernel Boot Option</h2><p>   The function ibmmca_scsi_setup() is called if option ibmmcascsi=n<br>   is passed to the kernel. See file linux/init/main.c for details.</p>
<h2 id="2-9-Driver-Module-Support"><a href="#2-9-Driver-Module-Support" class="headerlink" title="   2.9 Driver Module Support"></a>   2.9 Driver Module Support</h2><p>   Is implemented and tested by K. Kudielka. This could probably not work<br>   on kernels &lt;2.1.0.</p>
<h2 id="2-10-Multiple-Hostadapter-Support"><a href="#2-10-Multiple-Hostadapter-Support" class="headerlink" title="   2.10 Multiple Hostadapter Support"></a>   2.10 Multiple Hostadapter Support</h2><p>   This driver supports up to eight interfaces of type IBM-SCSI-Subsystem.<br>   Integrated-, and MCA-adapters are automatically recognized. Unrecognizable<br>   IBM-SCSI-Subsystem interfaces can be specified as kernel-parameters.</p>
<h2 id="2-11-proc-scsi-Filesystem-Information"><a href="#2-11-proc-scsi-Filesystem-Information" class="headerlink" title="   2.11 /proc/scsi-Filesystem Information"></a>   2.11 /proc/scsi-Filesystem Information</h2><p>   Information about the driver condition is given in<br>   /proc/scsi/ibmmca/<host_no>. ibmmca_proc_info() provides this information.</p>
<p>   This table is quite informative for interested users. It shows the load<br>   of commands on the subsystem and whether you are running the bypassed<br>   (software) or integrated (hardware) SCSI-command set (see below). The<br>   amount of accesses is shown. Read, write, modeselect is shown separately<br>   in order to help debugging problems with CD-ROMs or tapedrives.</p>
<p>   The following table shows the list of 15 logical device numbers, that are<br>   used by the SCSI-subsystem. The load on each ldn is shown in the table,<br>   again, read and write commands are split. The last column shows the amount<br>   of reassignments, that have been applied to the ldns, if you have more than<br>   15 pun/lun combinations available on the SCSI-bus.</p>
<p>   The last two tables show the pun/lun map and the positions of the ldns<br>   on this pun/lun map. This may change during operation, when a ldn is<br>   reassigned to another pun/lun combination. If the necessity for dynamical<br>   assignments is set to ‘no’, the ldn structure keeps static.</p>
<h2 id="2-12-proc-mca-Filesystem-Information"><a href="#2-12-proc-mca-Filesystem-Information" class="headerlink" title="   2.12 /proc/mca-Filesystem Information"></a>   2.12 /proc/mca-Filesystem Information</h2><p>   The slot-file contains all default entries and in addition chip and I/O-<br>   address information of the SCSI-subsystem. This information is provided<br>   by ibmmca_getinfo().</p>
<h2 id="2-13-Supported-IBM-SCSI-Subsystems"><a href="#2-13-Supported-IBM-SCSI-Subsystems" class="headerlink" title="   2.13 Supported IBM SCSI-Subsystems"></a>   2.13 Supported IBM SCSI-Subsystems</h2><p>   The following IBM SCSI-subsystems are supported by this driver:</p>
<pre><code> - IBM Fast/Wide SCSI-2 Adapter
 - IBM 7568 Industrial Computer SCSI Adapter w/Cache
 - IBM Expansion Unit SCSI Controller
 - IBM SCSI Adapter w/Cache
 - IBM SCSI Adapter
 - IBM Integrated SCSI Controller
 - All clones, 100% compatible with the chipset and subsystem command
   system of IBM SCSI-adapters (forced detection)
 
</code></pre>
<h2 id="2-14-Linux-Kernel-Versions"><a href="#2-14-Linux-Kernel-Versions" class="headerlink" title="   2.14 Linux Kernel Versions"></a>   2.14 Linux Kernel Versions</h2><p>   The IBM SCSI-subsystem low level driver is prepared to be used with<br>   all versions of Linux between 2.0.x and 2.4.x. The compatibility checks<br>   are fully implemented up from version 3.1e of the driver. This means, that<br>   you just need the latest ibmmca.h and ibmmca.c file and copy it in the<br>   linux/drivers/scsi directory. The code is automatically adapted during<br>   kernel compilation. This is different from kernel 2.4.0! Here version<br>   4.0 or later of the driver must be used for kernel 2.4.0 or later. Version<br>   4.0 or later does not work together with older kernels! Driver versions<br>   older than 4.0 do not work together with kernel 2.4.0 or later. They work<br>   on all older kernels.</p>
<h2 id="3-Code-History"><a href="#3-Code-History" class="headerlink" title="   3 Code History"></a>   3 Code History</h2><p>   Jan 15 1996:  First public release.</p>
<ul>
<li><p>Martin Kolinek</p>
<p>Jan 23 1996:  Scrapped code which reassigned scsi devices to logical<br>device numbers. Instead, the existing assignment (created<br>when the machine is powered-up or rebooted) is used.<br>A side effect is that the upper layer of Linux SCSI<br>device driver gets bogus scsi ids (this is benign),<br>and also the hard disks are ordered under Linux the<br>same way as they are under dos (i.e., C: disk is sda,<br>D: disk is sdb, etc.).</p>
</li>
<li><p>Martin Kolinek</p>
<p>I think that the CD-ROM is now detected only if a CD is<br>inside CD_ROM while Linux boots. This can be fixed later,<br>once the driver works on all types of PS/2’s.</p>
</li>
<li><p>Martin Kolinek</p>
<p>Feb 7 1996:   Modified biosparam function. Fixed the CD-ROM detection.<br>For now, devices other than harddisk and CD_ROM are<br>ignored. Temporarily modified abort() function<br>to behave like reset().</p>
</li>
<li><p>Martin Kolinek</p>
<p>Mar 31 1996:  The integrated scsi subsystem is correctly found<br>in PS/2 models 56,57, but not in model 76. Therefore<br>the ibmmca_scsi_setup() function has been added today.<br>This function allows the user to force detection of<br>scsi subsystem. The kernel option has format<br>ibmmcascsi=n<br>where n is the scsi_id (pun) of the subsystem. Most likely, n is 7.</p>
</li>
<li><p>Martin Kolinek</p>
<p>Aug 21 1996:  Modified the code which maps ldns to (pun,0).  It was<br>insufficient for those of us with CD-ROM changers.</p>
</li>
<li><p>Chris Beauregard</p>
<p>Dec 14 1996: More improvements to the ldn mapping.  See check_devices<br>for details.  Did more fiddling with the integrated SCSI detection,<br>but I think it’s ultimately hopeless without actually testing the<br>model of the machine.  The 56, 57, 76 and 95 (ultimedia) all have<br>different integrated SCSI register configurations.  However, the 56<br>and 57 are the only ones that have problems with forced detection.</p>
</li>
<li><p>Chris Beauregard</p>
<p>Mar 8-16 1997: Modified driver to run as a module and to support<br>multiple adapters. A structure, called ibmmca_hostdata, is now<br>present, containing all the variables, that were once only<br>available for one single adapter. The find_subsystem-routine has vanished.<br>The hardware recognition is now done in ibmmca_detect directly.<br>This routine checks for presence of MCA-bus, checks the interrupt<br>level and continues with checking the installed hardware.<br>Certain PS/2-models do not recognize a SCSI-subsystem automatically.<br>Hence, the setup defined by command-line-parameters is checked first.<br>Thereafter, the routine probes for an integrated SCSI-subsystem.<br>Finally, adapters are checked. This method has the advantage to cover all<br>possible combinations of multiple SCSI-subsystems on one MCA-board. Up to<br>eight SCSI-subsystems can be recognized and announced to the upper-level<br>drivers with this improvement. A set of defines made changes to other<br>routines as small as possible.</p>
</li>
<li><p>Klaus Kudielka</p>
<p>May 30 1997: (v1.5b)</p>
</li>
</ul>
<ol>
<li>SCSI-command capability enlarged by the recognition of MODE_SELECT.<br>This needs the RD-Bit to be disabled on IM_OTHER_SCSI_CMD_CMD which<br>allows data to be written from the system to the device. It is a<br>necessary step to be allowed to set blocksize of SCSI-tape-drives and<br>the tape-speed, without confusing the SCSI-Subsystem.</li>
<li>The recognition of a tape is included in the check_devices routine.<br>This is done by checking for TYPE_TAPE, that is already defined in<br>the kernel-scsi-environment. The markup of a tape is done in the<br>global ldn_is_tape[] array. If the entry on index ldn<br>is 1, there is a tapedrive connected.</li>
<li>The ldn_is_tape[] array is necessary to distinguish between tape- and<br>other devices. Fixed blocklength devices should not cause a problem<br>with the SCB-command for read and write in the ibmmca_queuecommand<br>subroutine. Therefore, I only derivate the READ_XX, WRITE_XX for<br>the tape-devices, as recommended by IBM in this Technical Reference,<br>mentioned below. (IBM recommends to avoid using the read/write of the<br>subsystem, but the fact was, that read/write causes a command error from<br>the subsystem and this causes kernel-panic.)</li>
<li>In addition, I propose to use the ldn instead of a fix char for the<br>display of PS2_DISK_LED_ON(). On 95, one can distinguish between the<br>devices that are accessed. It shows activity and easyfies debugging.<br>The tape-support has been tested with a SONY SDT-5200 and a HP DDS-2<br>(I do not know yet the type). Optimization and CD-ROM audio-support,<br>I am working on …</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>June 19 1997: (v1.6b)</p>
</li>
</ul>
<ol>
<li>Submitting the extra-array ldn_is_tape[] -&gt; to the local ld[]<br>device-array. </li>
<li>CD-ROM Audio-Play seems to work now.</li>
<li>When using DDS-2 (120M) DAT-Tapes, mtst shows still density-code<br>0x13 for ordinary DDS (61000 BPM) instead 0x24 for DDS-2. This appears<br>also on Adaptec 2940 adaptor in a PCI-System. Therefore, I assume that<br>the problem is independent of the low-level-driver/bus-architecture.</li>
<li>Hexadecimal ldn on PS/2-95 LED-display.</li>
<li>Fixing of the PS/2-LED on/off that it works right with tapedrives and<br>does not confuse the disk_rw_in_progress counter.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>June 21 1997: (v1.7b)</p>
</li>
</ul>
<ol>
<li>Adding of a proc_info routine to inform in /proc/scsi/ibmmca/<host> the<br>outer-world about operational load statistics on the different ldns,<br>seen by the driver. Everybody that has more than one IBM-SCSI should<br>test this, because I only have one and cannot see what happens with more<br>than one IBM-SCSI hosts.</li>
<li>Definition of a driver version-number to have a better recognition of<br>the source when there are existing too much releases that may confuse<br>the user, when reading about release-specific problems. Up to know,<br>I calculated the version-number to be 1.7. Because we are in BETA-test<br>yet, it is today 1.7b.</li>
<li>Sorry for the heavy bug I programmed on June 19 1997! After that, the<br>CD-ROM did not work any more! The C7-command was a fake impression<br>I got while programming. Now, the READ and WRITE commands for CD-ROM are<br>no longer running over the subsystem, but just over<br>IM_OTHER_SCSI_CMD_CMD. On my observations (PS/2-95), now CD-ROM mounts<br>much faster(!) and hopefully all fancy multimedia-functions, like direct<br>digital recording from audio-CDs also work. (I tried it with cdda2wav<br>from the cdwtools-package and it filled up the harddisk immediately :-).)<br>To easify boolean logics, a further local device-type in ld[], called<br>is_cdrom has been included.</li>
<li>If one uses a SCSI-device of unsupported type/commands, one<br>immediately runs into a kernel-panic caused by Command Error. To better<br>understand which SCSI-command caused the problem, I extended this<br>specific panic-message slightly.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>June 25 1997: (v1.8b)</p>
</li>
</ul>
<ol>
<li>Some cosmetic changes for the handling of SCSI-device-types.<br>Now, also CD-Burners / WORMs and SCSI-scanners should work. For<br>MO-drives I have no experience, therefore not yet supported.<br>In logical_devices I changed from different type-variables to one<br>called ‘device_type’ where the values, corresponding to scsi.h,<br>of a SCSI-device are stored.</li>
<li>There existed a small bug, that maps a device, coming after a SCSI-tape<br>wrong. Therefore, e.g. a CD-ROM changer would have been mapped wrong<br>-&gt; problem removed.</li>
<li>Extension of the logical_device structure. Now it contains also device,<br>vendor and revision-level of a SCSI-device for internal usage.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>June 26-29 1997: (v2.0b)</p>
</li>
</ul>
<ol>
<li>The release number 2.0b is necessary because of the completely new done<br>recognition and handling of SCSI-devices with the adapter. As I got<br>from Chris the hint, that the subsystem can reassign ldns dynamically,<br>I remembered this immediate_assign-command, I found once in the handbook.<br>Now, the driver first kills all ldn assignments that are set by default<br>on the SCSI-subsystem. After that, it probes on all puns and luns for<br>devices by going through all combinations with immediate_assign and<br>probing for devices, using device_inquiry. The found physical(!) pun,lun<br>structure is stored in get_scsi[][] as device types. This is followed<br>by the assignment of all ldns to existing SCSI-devices. If more ldns<br>than devices are available, they are assigned to non existing pun,lun<br>combinations to satisfy the adapter. With this, the dynamical mapping<br>was possible to implement. (For further info see the text in the<br>source code and in the description below. Read the description<br>below BEFORE installing this driver on your system!)</li>
<li>Changed the name IBMMCA_DRIVER_VERSION to IBMMCA_SCSI_DRIVER_VERSION.</li>
<li>The LED-display shows on PS/2-95 no longer the ldn, but the SCSI-ID<br>(pun) of the accessed SCSI-device. This is now senseful, because the<br>pun known within the driver is exactly the pun of the physical device<br>and no longer a fake one.</li>
<li>The /proc/scsi/ibmmca/<host_no> consists now of the first part, where<br>hit-statistics of ldns is shown and a second part, where the maps of<br>physical and logical SCSI-devices are displayed. This could be very<br>interesting, when one is using more than 15 SCSI-devices in order to<br>follow the dynamical remapping of ldns.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>June 26-29 1997: (v2.0b-1)</p>
</li>
</ul>
<ol>
<li>I forgot to switch the local_checking_phase_flag to 1 and back to 0<br>in the dynamical remapping part in ibmmca_queuecommand for the<br>device_exist routine. Sorry.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>July 1-13 1997: (v3.0b,c)</p>
</li>
</ul>
<ol>
<li>Merging of the driver-developments of Klaus Kudielka and Michael Lang<br>in order to get a optimum and unified driver-release for the<br>IBM-SCSI-Subsystem-Adapter(s).<br>   For people, using the Kernel-release &gt;=2.1.0, module-support should<br>be no problem. For users, running under &lt;2.1.0, module-support may not<br>work, because the methods have changed between 2.0.x and 2.1.x.</li>
<li>Added some more effective statistics for /proc-output.</li>
<li>Change typecasting at necessary points from (unsigned long) to<br>virt_to_bus().</li>
<li>Included #if… at special points to have specific adaption of the<br>driver to kernel 2.0.x and 2.1.x. It should therefore also run with<br>later releases.</li>
<li>Magneto-Optical drives and medium-changers are also recognized, now.<br>Therefore, we have a completely gapfree recognition of all SCSI-<br>device-types, that are known by Linux up to kernel 2.1.31.</li>
<li>The flag SCSI_IBMMCA_DEV_RESET has been inserted. If it is set within<br>the configuration, each connected SCSI-device will get a reset command<br>during boottime. This can be necessary for some special SCSI-devices.<br>This flag should be included in Config.in.<br>(See also the new Config.in file.)<br>Probable next improvement: bad disk handler.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>Sept 14 1997: (v3.0c)</p>
</li>
</ul>
<ol>
<li>Some debugging and speed optimization applied.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>Dec 15, 1997</p>
<ul>
<li><a href="mailto:&#99;&#x68;&#114;&#105;&#115;&#98;&#64;&#x74;&#114;&#x75;&#101;&#x73;&#112;&#x65;&#x63;&#116;&#x72;&#97;&#46;&#99;&#111;&#x6d;">&#99;&#x68;&#114;&#105;&#115;&#98;&#64;&#x74;&#114;&#x75;&#101;&#x73;&#112;&#x65;&#x63;&#116;&#x72;&#97;&#46;&#99;&#111;&#x6d;</a></li>
<li>made the front panel display thingy optional, specified from the<br>command-line via ibmmcascsi=display.  Along the lines of the /LED<br>option for the OS/2 driver.</li>
<li>fixed small bug in the LED display that would hang some machines.</li>
<li>reversed ordering of the drives (using the<br>IBMMCA_SCSI_ORDER_STANDARD define).  This is necessary for two main<br>reasons:</li>
<li>users who’ve already installed Linux won’t be screwed.  Keep<br>in mind that not everyone is a kernel hacker.</li>
<li>be consistent with the BIOS ordering of the drives.  In the<br>BIOS, id 6 is C:, id 0 might be D:.  With this scheme, they’d be<br>backwards.  This confuses the crap out of those heathens who’ve<br>got a impure Linux installation (which, <wince>, I’m one of).<br>This whole problem arises because IBM is actually non-standard with<br>the id to BIOS mappings.  You’ll find, in fdomain.c, a similar<br>comment about a few FD BIOS revisions.  The Linux (and apparently<br>industry) standard is that C: maps to scsi id (0,0).  Let’s stick<br>with that standard.</li>
<li>Since this is technically a branch of my own, I changed the<br>version number to 3.0e-cpb.</li>
</ul>
<p>Jan 17, 1998: (v3.0f)</p>
</li>
</ul>
<ol>
<li>Addition of some statistical info for /proc in proc_info.</li>
<li>Taking care of the SCSI-assignment problem, dealed by Chris at Dec 15<ol start="1997">
<li>In fact, IBM is right, concerning the assignment of SCSI-devices<br>to driveletters. It is conform to the ANSI-definition of the SCSI-<br>standard to assign drive C: to SCSI-id 6, because it is the highest<br>hardware priority after the hostadapter (that has still today by<br>default everywhere id 7). Also realtime-operating systems that I use,<br>like LynxOS and OS9, which are quite industrial systems use top-down<br>numbering of the harddisks, that is also starting at id 6. Now, one<br>sits a bit between two chairs. On one hand side, using the define<br>IBMMCA_SCSI_ORDER_STANDARD makes Linux assigning disks conform to<br>the IBM- and ANSI-SCSI-standard and keeps this driver downward<br>compatible to older releases, on the other hand side, people is quite<br>habituated in believing that C: is assigned to (0,0) and much other<br>SCSI-BIOS do so. Therefore, I moved the IBMMCA_SCSI_ORDER_STANDARD<br>define out of the driver and put it into Config.in as subitem of<br>‘IBM SCSI support’. A help, added to Documentation/Configure.help<br>explains the differences between saying ‘y’ or ‘n’ to the user, when<br>IBMMCA_SCSI_ORDER_STANDARD prompts, so the ordinary user is enabled to<br>choose the way of assignment, depending on his own situation and gusto.</li>
</ol>
</li>
<li>Adapted SCSI_IBMMCA_DEV_RESET to the local naming convention, so it is<br>now called IBMMCA_SCSI_DEV_RESET.</li>
<li>Optimization of proc_info and its subroutines.</li>
<li>Added more in-source-comments and extended the driver description by<br>some explanation about the SCSI-device-assignment problem.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>Jan 18, 1998: (v3.0g)</p>
</li>
</ul>
<ol>
<li>Correcting names to be absolutely conform to the later 2.1.x releases.<br>This is necessary for <pre><code>  IBMMCA_SCSI_DEV_RESET -&gt; CONFIG_IBMMCA_SCSI_DEV_RESET
  IBMMCA_SCSI_ORDER_STANDARD -&gt; CONFIG_IBMMCA_SCSI_ORDER_STANDARD
</code></pre>
</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>Jan 18, 1999: (v3.1 MCA-team internal)</p>
</li>
</ul>
<ol>
<li>The multiple hosts structure is accessed from every subroutine, so there<br>is no longer the address of the device structure passed from function<br>to function, but only the hostindex. A call by value, nothing more. This<br>should really be understood by the compiler and the subsystem should get<br>the right values and addresses.</li>
<li>The SCSI-subsystem detection was not complete and quite hugely buggy up<br>to now, compared to the technical manual. The interpretation of the pos2<br>register is not as assumed by people before, therefore, I dropped a note<br>in the ibmmca_detect function to show the registers’ interpretation.<br>The pos-registers of integrated SCSI-subsystems do not contain any<br>information concerning the IO-port offset, really. Instead, they contain<br>some info about the adapter, the chip, the NVRAM …. The I/O-port is<br>fixed to 0x3540 - 0x3547. There can be more than one adapters in the<br>slots and they get an offset for the I/O area in order to get their own<br>I/O-address area. See chapter 2 for detailed description. At least, the<br>detection should now work right, even on models other than 95. The 95ers<br>came happily around the bug, as their pos2 register contains always 0<br>in the critical area. Reserved bits are not allowed to be interpreted,<br>therefore, IBM is allowed to set those bits as they like and they may<br>really vary between different PS/2 models. So, now, no interpretation<br>of reserved bits - hopefully no trouble here anymore.</li>
<li>The command error, which you may get on models 55, 56, 57, 70, 77 and<br>P70 may have been caused by the fact, that adapters of older design do<br>not like sending commands to non-existing SCSI-devices and will react<br>with a command error as a sign of protest. While this error is not<br>present on IBM SCSI Adapter w/cache, it appears on IBM Integrated SCSI<br>Adapters. Therefore, I implemented a workaround to forgive those<br>adapters their protests, but it is marked up in the statistics, so<br>after a successful boot, you can see in /proc/scsi/ibmmca/<host_number><br>how often the command errors have been forgiven to the SCSI-subsystem.<br>If the number is bigger than 0, you have a SCSI subsystem of older<br>design, what should no longer matter.</li>
<li>ibmmca_getinfo() has been adapted very carefully, so it shows in the<br>slotn file really, what is senseful to be presented.</li>
<li>ibmmca_register() has been extended in its parameter list in order to<br>pass the right name of the SCSI-adapter to Linux.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>Feb 6, 1999: (v3.1)</p>
</li>
</ul>
<ol>
<li>Finally, after some 3.1Beta-releases, the 3.1 release. Sorry, for<br>the delayed release, but it was not finished with the release of<br>Kernel 2.2.0.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>Feb 10, 1999 (v3.1)</p>
</li>
</ul>
<ol>
<li>Added a new commandline parameter called ‘bypass’ in order to bypass<br>every integrated subsystem SCSI-command consequently in case of<br>troubles.</li>
<li>Concatenated read_capacity requests to the harddisks. It gave a lot<br>of troubles with some controllers and after I wanted to apply some<br>extensions, it jumped out in the same situation, on my w/cache, as like<br>on D. Weinehalls’ Model 56, having integrated SCSI. This gave me the<br>decisive hint to move the code-part out and declare it global. Now<br>it seems to work far better and more stable. Let us see what<br>the world thinks of it…</li>
<li>By the way, only Sony DAT-drives seem to show density code 0x13. A<br>test with a HP drive gave right results, so the problem is vendor-<br>specific and not a problem of the OS or the driver.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>Feb 18, 1999 (v3.1d)</p>
</li>
</ul>
<ol>
<li>The abort command and the reset function have been checked for<br>inconsistencies. From the logical point of thinking, they work<br>at their optimum, now, but as the subsystem does not answer with an<br>interrupt, abort never finishes, sigh…</li>
<li>Everything, that is accessed by a busmaster request from the adapter<br>is now declared as global variable, even the return-buffer in the<br>local checking phase. This assures, that no accesses to undefined memory<br>areas are performed.</li>
<li>In ibmmca.h, the line unchecked_isa_dma is added with 1 in order to<br>avoid memory-pointers for the areas higher than 16MByte in order to<br>be sure, it also works on 16-Bit Microchannel bus systems.</li>
<li>A lot of small things have been found, but nothing that endangered the<br>driver operations. Just it should be more stable, now.</li>
</ol>
<ul>
<li>Michael LangFeb 20, 1999 (v3.1e)</li>
</ul>
<ol>
<li>I took the warning from the Linux Kernel Hackers Guide serious and<br>checked the cmd-&gt;result return value to the done-function very carefully.<br>It is obvious, that the IBM SCSI only delivers the tsb.dev_status, if<br>some error appeared, else it is undefined. Now, this is fixed. Before<br>any SCB command gets queued, the tsb.dev_status is set to 0, so the<br>cmd-&gt;result won’t screw up Linux higher level drivers.</li>
<li>The reset-function has slightly improved. This is still planed for<br>abort. During the abort and the reset function, no interrupts are<br>allowed. This is however quite hard to cope with, so the INT-status<br>register is read. When the interrupt gets queued, one can find its<br>status immediately on that register and is enabled to continue in the<br>reset function. I had no chance to test this really, only in a bogus<br>situation, I got this function running, but the situation was too much<br>worse for Linux :-(, so tests will continue.</li>
<li>Buffers got now consistent. No open address mapping, as before and<br>therefore no further troubles with the unassigned memory segmentation<br>faults that scrambled probes on 95XX series and even on 85XX series,<br>when the kernel is done in a not so perfectly fitting way.</li>
<li>Spontaneous interrupts from the subsystem, appearing without any<br>command previously queued are answered with a DID_BAD_INTR result.</li>
<li>Taken into account ZP Gus’ proposals to reverse the SCSI-device<br>scan order. As it does not work on Kernel 2.1.x or 2.2.x, as proposed<br>by him, I implemented it in a slightly derived way, which offers in<br>addition more flexibility.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>Apr 23, 2000 (v3.2pre1)</p>
</li>
</ul>
<ol>
<li>During a very long time, I collected a huge amount of bug reports from<br>various people, trying really quite different things on their SCSI-<br>PS/2s. Today, all these bug reports are taken into account and should be<br>mostly solved. The major topics were:<ul>
<li>Driver crashes during boottime by no obvious reason.</li>
<li>Driver panics while the midlevel-SCSI-driver is trying to inquire<br>the SCSI-device properties, even though hardware is in perfect state.</li>
<li>Displayed info for the various slot-cards is interpreted wrong.<br>The main reasons for the crashes were two:</li>
</ul>
<ol>
<li>The commands to check for device information like INQUIRY,<br>TEST_UNIT_READY, REQUEST_SENSE and MODE_SENSE cause the devices<br>to deliver information of up to 255 bytes. Midlevel drivers offer<br>1024 bytes of space for the answer, but the IBM-SCSI-adapters do<br>not accept this, as they stick quite near to ANSI-SCSI and report<br>a COMMAND_ERROR message which causes the driver to panic. The main<br>problem was located around the INQUIRY command. Now, for all the<br>mentioned commands, the buffersize sent to the adapter is at<br>maximum 255 which seems to be a quite reasonable solution.<br>TEST_UNIT_READY gets a buffersize of 0 to make sure that no<br>data is transferred in order to avoid any possible command failure.</li>
<li>On unsuccessful TEST_UNIT_READY, the mid-level driver has to send<br>a REQUEST_SENSE in order to see where the problem is located. This<br>REQUEST_SENSE may have various length in its answer-buffer. IBM<br>SCSI-subsystems report a command failure if the returned buffersize<br>is different from the sent buffersize, but this can be suppressed by<br>a special bit, which is now done and problems seem to be solved.</li>
</ol>
</li>
<li>Code adaption to all kernel-releases. Now, the 3.2 code compiles on<br>2.0.x, 2.1.x, 2.2.x and 2.3.x kernel releases without any code-changes.</li>
<li>Commandline-parameters are recognized again, even under Kernel 2.3.x or<br>higher.</li>
</ol>
<ul>
<li><p>Michael Lang   </p>
<p>April 27, 2000 (v3.2pre2)</p>
</li>
</ul>
<ol>
<li>Bypassed commands get read by the adapter by one cycle instead of two.<br>This increases SCSI-performance.</li>
<li>Synchronous datatransfer is provided for sure to be 5 MHz on older<br>SCSI and 10 MHz on internal F/W SCSI-adapter.</li>
<li>New commandline parameters allow to force the adapter to slow down while<br>in synchronous transfer. Could be helpful for very old devices.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>June 2, 2000 (v3.2pre5)</p>
</li>
</ul>
<ol>
<li>Added Jim Shorney’s contribution to make the activity indicator<br>flashing in addition to the LED-alphanumeric display-panel on<br>models 95A. To be enabled to choose this feature freely, a new<br>commandline parameter is added, called ‘activity’.</li>
<li>Added the READ_CONTROL bit for test_unit_ready SCSI-command.</li>
<li>Added some suppress_exception bits to read_device_capacity and<br>all device_inquiry occurrences in the driver code.</li>
<li>Complaints about the various KERNEL_VERSION implementations are<br>taken into account. Every local_LinuxKernelVersion occurrence is<br>now replaced by KERNEL_VERSION, defined in linux/version.h.<br>Corresponding changes were applied to ibmmca.h, too. This was a<br>contribution to all kernel-parts by Philipp Hahn.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>July 17, 2000 (v3.2pre8)<br>A long period of collecting bug reports from all corners of the world<br>now lead to the following corrections to the code:</p>
</li>
</ul>
<ol>
<li>SCSI-2 F/W support crashed with a COMMAND ERROR. The reason for this<br>was that it is possible to disable Fast-SCSI for the external bus.<br>The feature-control command, where this crash appeared regularly, tried<br>to set the maximum speed of 10MHz synchronous transfer speed and that<br>reports a COMMAND ERROR if external bus Fast-SCSI is disabled. Now,<br>the feature-command probes down from maximum speed until the adapter<br>stops to complain, which is at the same time the maximum possible<br>speed selected in the reference program. So, F/W external can run at<br>5 MHz (slow-) or 10 MHz (fast-SCSI). During feature probing, the<br>COMMAND ERROR message is used to detect if the adapter does not complain.</li>
<li>Up to now, only combined busmode is supported, if you use external<br>SCSI-devices, attached to the F/W-controller. If dual bus is selected,<br>only the internal SCSI-devices get accessed by Linux. For most<br>applications, this should do fine. </li>
<li>Wide-SCSI-addressing (16-Bit) is now possible for the internal F/W<br>bus on the F/W adapter. If F/W adapter is detected, the driver<br>automatically uses the extended PUN/LUN &lt;-&gt; LDN mapping tables, which<br>are now new from 3.2pre8. This allows PUNs between 0 and 15 and should<br>provide more fun with the F/W adapter.</li>
<li>Several machines use the SCSI: POS registers for internal/undocumented<br>storage of system relevant info. This confused the driver, mainly on<br>models 9595, as it expected no onboard SCSI only, if all POS in<br>the integrated SCSI-area are set to 0x00 or 0xff. Now, the mechanism<br>to check for integrated SCSI is much more restrictive and these problems<br>should be history.</li>
</ol>
<ul>
<li><p>Michael Lang          </p>
<p>July 18, 2000 (v3.2pre9)<br>This develop rather quickly at the moment. Two major things were still<br>missing in 3.2pre8:</p>
</li>
</ul>
<ol>
<li>The adapter PUN for F/W adapters has 4-bits, while all other adapters<br>have 3-bits. This is now taken into account for F/W.</li>
<li>When you select CONFIG_IBMMCA_SCSI_ORDER_STANDARD, you should<br>normally get the inverse probing order of your devices on the SCSI-bus.<br>The ANSI device order gets scrambled in version 3.2pre8!! Now, a new<br>and tested algorithm inverts the device-order on the SCSI-bus and<br>automatically avoids accidental access to whatever SCSI PUN the adapter<br>is set and works with SCSI- and Wide-SCSI-addressing.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>July 23, 2000 (v3.2pre10 unpublished) </p>
</li>
</ul>
<ol>
<li>LED panel display supports wide-addressing in ibmmca=display mode.</li>
<li>Adapter-information and autoadaption to address-space is done.</li>
<li>Auto-probing for maximum synchronous SCSI transfer rate is working.</li>
<li>Optimization to some embedded function calls is applied.</li>
<li>Added some comment for the user to wait for SCSI-devices being probed.</li>
<li>Finished version 3.2 for Kernel 2.4.0. It least, I thought it is but…</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>July 26, 2000 (v3.2pre11)</p>
</li>
</ul>
<ol>
<li>I passed a horrible weekend getting mad with NMIs on kernel 2.2.14 and<br>a model 9595. Asking around in the community, nobody except of me has<br>seen such errors. Weird, but I am trying to recompile everything on<br>the model 9595. Maybe, as I use a specially modified gcc, that could<br>cause problems. But, it was not the reason. The true background was,<br>that the kernel was compiled for i386 and the 9595 has a 486DX-2.<br>Normally, no troubles should appear, but for this special machine,<br>only the right processor support is working fine!</li>
<li>Previous problems with synchronous speed, slowing down from one adapter<br>to the next during probing are corrected. Now, local variables store<br>the synchronous bitmask for every single adapter found on the MCA bus.</li>
<li>LED alphanumeric panel support for XX95 systems is now showing some<br>alive rotator during boottime. This makes sense, when no monitor is<br>connected to the system. You can get rid of all display activity, if<br>you do not use any parameter or just ibmmcascsi=activity, for the<br>harddrive activity LED, existent on all PS/2, except models 8595-XXX.<br>If no monitor is available, please use ibmmcascsi=display, which works<br>fine together with the linuxinfo utility for the LED-panel.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>July 29, 2000 (v3.2)</p>
</li>
</ul>
<ol>
<li>Submission of this driver for kernel 2.4test-XX and 2.2.17.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>December 28, 2000 (v3.2d / v4.0)</p>
</li>
</ul>
<ol>
<li>The interrupt handler had some wrong statement to wait for. This<br>was done due to experimental reasons during 3.2 development but it<br>has shown that this is not stable enough. Going back to wait for the<br>adapter to be not busy is best.</li>
<li>Inquiry requests can be shorter than 255 bytes of return buffer. Due<br>to a bug in the ibmmca_queuecommand routine, this buffer was forced<br>to 255 at minimum. If the memory address, this return buffer is pointing<br>to does not offer more space, invalid memory accesses destabilized the<br>kernel.</li>
<li>version 4.0 is only valid for kernel 2.4.0 or later. This is necessary<br>to remove old kernel version dependent waste from the driver. 3.2d is<br>only distributed with older kernels but keeps compatibility with older<br>kernel versions. 4.0 and higher versions cannot be used with older<br>kernels anymore!! You must have at least kernel 2.4.0!!</li>
<li>The commandline argument ‘bypass’ and all its functionality got removed<br>in version 4.0. This was never really necessary, as all troubles were<br>based on non-command related reasons up to now, so bypassing commands<br>did not help to avoid any bugs. It is kept in 3.2X for debugging reasons.</li>
<li>Dynamic reassignment of ldns was again verified and analyzed to be<br>completely inoperational. This is corrected and should work now.</li>
<li>All commands that get sent to the SCSI adapter were verified and<br>completed in such a way, that they are now completely conform to the<br>demands in the technical description of IBM. Main candidates were the<br>DEVICE_INQUIRY, REQUEST_SENSE and DEVICE_CAPACITY commands. They must<br>be transferred by bypassing the internal command buffer of the adapter<br>or else the response can be a random result. GET_POS_INFO would be more<br>safe in usage, if one could use the SUPRESS_EXCEPTION_SHORT, but this<br>is not allowed by the technical references of IBM. (Sorry, folks, the<br>model 80 problem is still a task to be solved in a different way.)</li>
<li>v3.2d is still hold back for some days for testing, while 4.0 is<br>released.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>January 3, 2001 (v4.0a)</p>
</li>
</ul>
<ol>
<li>A lot of complains after the 2.4.0-prerelease kernel came in about<br>the impossibility to compile the driver as a module. This problem is<br>solved. In combination with that problem, some unprecise declaration<br>of the function option_setup() gave some warnings during compilation.<br>This is solved, too by a forward declaration in ibmmca.c.</li>
<li>#ifdef argument concerning CONFIG_SCSI_IBMMCA is no longer needed and<br>was entirely removed.</li>
<li>Some switch statements got optimized in code, as some minor variables<br>in internal SCSI-command handlers.</li>
</ol>
<ul>
<li><p>Michael Lang</p>
<p>4 To do</p>
</li>
</ul>
<hr>
<pre><code>    - IBM SCSI-2 F/W external SCSI bus support in separate mode!
- It seems that the handling of bad disks is really bad -
  non-existent, in fact. However, a low-level driver cannot help
  much, if such things happen.
</code></pre>
<h2 id="5-Users’-Manual"><a href="#5-Users’-Manual" class="headerlink" title="   5 Users’ Manual"></a>   5 Users’ Manual</h2><h2 id="5-1-Commandline-Parameters"><a href="#5-1-Commandline-Parameters" class="headerlink" title="   5.1 Commandline Parameters"></a>   5.1 Commandline Parameters</h2><p>   There exist several features for the IBM SCSI-subsystem driver.<br>   The commandline parameter format is:</p>
<pre><code>     ibmmcascsi=&lt;command1&gt;,&lt;command2&gt;,&lt;command3&gt;,...
 
</code></pre>
<p>   where commandN can be one of the following:</p>
<pre><code>     display    Owners of a model 95 or other PS/2 systems with an
            alphanumeric LED display may set this to have their
        display showing the following output of the 8 digits:
          
                    ------DA
            
        where &#39;-&#39; stays dark, &#39;D&#39; shows the SCSI-device id
        and &#39;A&#39; shows the SCSI hostindex, being currently 
        accessed. During boottime, this will give the message
        
                    SCSIini*
            
                on the LED-panel, where the * represents a rotator, 
        showing the activity during the probing phase of the
        driver which can take up to two minutes per SCSI-adapter.
 adisplay   This works like display, but gives more optical overview 
            of the activities on the SCSI-bus. The display will have
        the following output:
        
                    6543210A
            
        where the numbers 0 to 6 light up at the shown position,
        when the SCSI-device is accessed. &#39;A&#39; shows again the SCSI
        hostindex. If display nor adisplay is set, the internal
        PS/2 harddisk LED is used for media-activities. So, if
        you really do not have a system with a LED-display, you
        should not set display or adisplay. Keep in mind, that
        display and adisplay can only be used alternatively. It
        is not recommended to use this option, if you have some
        wide-addressed devices e.g. at the SCSI-2 F/W adapter in
        your system. In addition, the usage of the display for
        other tasks in parallel, like the linuxinfo-utility makes 
        no sense with this option.
 activity   This enables the PS/2 harddisk LED activity indicator.
            Most PS/2 have no alphanumeric LED display, but some
        indicator. So you should use this parameter to activate it.
        If you own model 9595 (Server95), you can have both, the 
        LED panel and the activity indicator in parallel. However,
        some PS/2s, like the 8595 do not have any harddisk LED 
        activity indicator, which means, that you must use the
        alphanumeric LED display if you want to monitor SCSI-
        activity.
 bypass     This is obsolete from driver version 4.0, as the adapters
            got that far understood, that the selection between 
        integrated and bypassed commands should now work completely
        correct! For historical reasons, the old description is
        kept here:
            This commandline parameter forces the driver never to use
            SCSI-subsystems&#39; integrated SCSI-command set. Except of
        the immediate assign, which is of vital importance for
        every IBM SCSI-subsystem to set its ldns right. Instead,
        the ordinary ANSI-SCSI-commands are used and passed by the
        controller to the SCSI-devices, therefore &#39;bypass&#39;. The
        effort, done by the subsystem is quite bogus and at a
        minimum and therefore it should work everywhere. This
        could maybe solve troubles with old or integrated SCSI-
        controllers and nasty harddisks. Keep in mind, that using 
        this flag will slow-down SCSI-accesses slightly, as the 
        software generated commands are always slower than the 
        hardware. Non-harddisk devices always get read/write-
        commands in bypass mode. On the most recent releases of 
        the Linux IBM-SCSI-driver, the bypass command should be
        no longer a necessary thing, if you are sure about your
        SCSI-hardware!
 normal     This is the parameter, introduced on the 2.0.x development
            rail by ZP Gu. This parameter defines the SCSI-device
        scan order in the new industry standard. This means, that
        the first SCSI-device is the one with the lowest pun.
        E.g. harddisk at pun=0 is scanned before harddisk at
        pun=6, which means, that harddisk at pun=0 gets sda
        and the one at pun=6 gets sdb.
 ansi       The ANSI-standard for the right scan order, as done by
            IBM, Microware and Microsoft, scans SCSI-devices starting
        at the highest pun, which means, that e.g. harddisk at
        pun=6 gets sda and a harddisk at pun=0 gets sdb. If you
        like to have the same SCSI-device order, as in DOS, OS-9
        or OS/2, just use this parameter.
     fast       SCSI-I/O in synchronous mode is done at 5 MHz for IBM-
                SCSI-devices. SCSI-2 Fast/Wide Adapter/A external bus
                should then run at 10 MHz if Fast-SCSI is enabled,
                and at 5 MHz if Fast-SCSI is disabled on the external
                bus. This is the default setting when nothing is 
                specified here.
     medium     Synchronous rate is at 50% approximately, which means
                2.5 MHz for IBM SCSI-adapters and 5.0 MHz for F/W ext.
                SCSI-bus (when Fast-SCSI speed enabled on external bus).
     slow       The slowest possible synchronous transfer rate is set. 
                This means 1.82 MHz for IBM SCSI-adapters and 2.0 MHz
                for F/W external bus at Fast-SCSI speed on the external
        bus.
        
</code></pre>
<p>   A further option is that you can force the SCSI-driver to accept a SCSI-<br>   subsystem at a certain I/O-address with a predefined adapter PUN. This<br>   is done by entering </p>
<pre><code>              commandN   = I/O-base
      commandN+1 = adapter PUN
      
</code></pre>
<p>   e.g. ibmmcascsi=0x3540,7 will force the driver to detect a SCSI-subsystem<br>   at I/O-address 0x3540 with adapter PUN 7. Please only use this method, if<br>   the driver does really not recognize your SCSI-adapter! With driver version<br>   3.2, this recognition of various adapters was hugely improved and you<br>   should try first to remove your commandline arguments of such type with a<br>   newer driver. I bet, it will be recognized correctly. Even multiple and<br>   different types of IBM SCSI-adapters should be recognized correctly, too.<br>   Use the forced detection method only as last solution!</p>
<p>   Examples:</p>
<pre><code>    ibmmcascsi=adisplay
</code></pre>
<p>   This will use the advanced display mode for the model 95 LED alphanumeric<br>   display.</p>
<pre><code>    ibmmcascsi=display,0x3558,7
</code></pre>
<p>   This will activate the default display mode for the model 95 LED display<br>   and will force the driver to accept a SCSI-subsystem at I/O-base 0x3558<br>   with adapter PUN 7.</p>
<h2 id="5-2-Troubleshooting"><a href="#5-2-Troubleshooting" class="headerlink" title="   5.2 Troubleshooting"></a>   5.2 Troubleshooting</h2><p>   The following FAQs should help you to solve some major problems with this<br>   driver.</p>
<pre><code> Q: &quot;Reset SCSI-devices at boottime&quot; halts the system at boottime, why?
 A: This is only tested with the IBM SCSI Adapter w/cache. It is not
    yet proven to run on other adapters, however you may be lucky.
In version 3.1d this has been hugely improved and should work better,
now. Normally you really won&#39;t need to activate this flag in the
kernel configuration, as all post 1989 SCSI-devices should accept
the reset-signal, when the computer is switched on. The SCSI-
subsystem generates this reset while being initialized. This flag
is really reserved for users with very old, very strange or self-made
SCSI-devices.
 Q: Why is the SCSI-order of my drives mirrored to the device-order
    seen from OS/2 or DOS ?
 A: It depends on the operating system, if it looks at the devices in
    ANSI-SCSI-standard (starting from pun 6 and going down to pun 0) or
if it just starts at pun 0 and counts up. If you want to be conform
with OS/2 and DOS, you have to activate this flag in the kernel
configuration or you should set &#39;ansi&#39; as parameter for the kernel.
The parameter &#39;normal&#39; sets the new industry standard, starting
from pun 0, scanning up to pun 6. This allows you to change your 
opinion still after having already compiled the kernel.
 Q: Why can&#39;t I find IBM MCA SCSI support in the config menu?
 A: You have to activate MCA bus support, first.
 Q: Where can I find the latest info about this driver?
 A: See the file MAINTAINERS for the current WWW-address, which offers
    updates, info and Q/A lists. At this file&#39;s origin, the webaddress
was: http://www.uni-mainz.de/~langm000/linux.html
 Q: My SCSI-adapter is not recognized by the driver, what can I do?
 A: Just force it to be recognized by kernel parameters. See section 5.1.
    If this really happens, do also send e-mail to the maintainer, as
forced detection should be never necessary. Forced detection is in
principal some flaw of the driver adapter detection and goes into 
bug reports.
 Q: The driver screws up, if it starts to probe SCSI-devices, is there
    some way out of it?
 A: Yes, that was some recognition problem of the correct SCSI-adapter
    and its I/O base addresses. Upgrade your driver to the latest release
and it should be fine again.
 Q: I get a message: panic IBM MCA SCSI: command error .... , what can
    I do against this?
 A: Previously, I followed the way by ignoring command errors by using
    ibmmcascsi=forgiveall, but this command no longer exists and is
obsolete. If such a problem appears, it is caused by some segmentation
fault of the driver, which maps to some unallowed area. The latest 
version of the driver should be ok, as most bugs have been solved.
 Q: There are still kernel panics, even after having set 
    ibmmcascsi=forgiveall. Are there other possibilities to prevent
such panics?
 A: No, get just the latest release of the driver and it should work 
    better and better with increasing version number. Forget about this
ibmmcascsi=forgiveall, as also ignorecmd are obsolete.!
 Q: Linux panics or stops without any comment, but it is probable, that my
    harddisk(s) have bad blocks.
 A: Sorry, the bad-block handling is still a feeble point of this driver,
    but is on the schedule for development in the near future.
 Q: Linux panics while dynamically assigning SCSI-ids or ldns.
 A: If you disconnect a SCSI-device from the machine, while Linux is up
    and the driver uses dynamical reassignment of logical device numbers
(ldn), it really gets &quot;angry&quot; if it won&#39;t find devices, that were still
present at boottime and stops Linux.
 Q: The system does not recover after an abort-command has been generated.
 A: This is regrettably true, as it is not yet understood, why the 
    SCSI-adapter does really NOT generate any interrupt at the end of
the abort-command. As no interrupt is generated, the abort command
cannot get finished and the system hangs, sorry, but checks are 
running to hunt down this problem. If there is a real pending command,
the interrupt MUST get generated after abort. In this case, it
should finish well.
 Q: The system gets in bad shape after a SCSI-reset, is this known?
 A: Yes, as there are a lot of prescriptions (see the Linux Hackers&#39;
    Guide) what has to be done for reset, we still share the bad shape of
the reset functions with all other low level SCSI-drivers. 
Astonishingly, reset works in most cases quite ok, but the harddisks
won&#39;t run in synchronous mode anymore after a reset, until you reboot.
 Q: Why does my XXX w/Cache adapter not use read-prefetch?
 A: Ok, that is not completely possible. If a cache is present, the 
    adapter tries to use it internally. Explicitly, one can use the cache
with a read prefetch command, maybe in future, but this requires
some major overhead of SCSI-commands that risks the performance to
go down more than it gets improved. Tests with that are running.
 Q: I have a IBM SCSI-2 Fast/Wide adapter, it boots in some way and hangs.
 A: Yes, that is understood, as for sure, your SCSI-2 Fast/Wide adapter
    was in such a case recognized as integrated SCSI-adapter or something 
else, but not as the correct adapter. As the I/O-ports get assigned 
wrongly by that reason, the system should crash in most cases. You 
should upgrade to the latest release of the SCSI-driver. The 
recommended version is 3.2 or later. Here, the F/W support is in
a stable and reliable condition. Wide-addressing is in addition 
supported.
 Q: I get an Oops message and something like &quot;killing interrupt&quot;.
 A: The reason for this is that the IBM SCSI-subsystem only sends a 
    termination status back, if some error appeared. In former releases
of the driver, it was not checked, if the termination status block
is NULL. From version 3.2, it is taken care of this.
 Q: I have a F/W adapter and the driver sees my internal SCSI-devices,
    but ignores the external ones.
 A: Select combined busmode in the IBM config-program and check for that
    no SCSI-id on the external devices appears on internal devices.
    Reboot afterwards. Dual busmode is supported, but works only for the
internal bus, yet. External bus is still ignored. Take care for your
SCSI-ids. If combined bus-mode is activated, on some adapters, 
the wide-addressing is not possible, so devices with ids between 8 
and 15 get ignored by the driver &amp; adapter!
 Q: I have a 9595 and I get a NMI during heavy SCSI I/O e.g. during fsck.
    A COMMAND ERROR is reported and characters on the screen are missing.
Warm reboot is not possible. Things look like quite weird.
 A: Check the processor type of your 9595. If you have an 80486 or 486DX-2
    processor complex on your mainboard and you compiled a kernel that
supports 80386 processors, it is possible, that the kernel cannot
keep track of the PS/2 interrupt handling and stops on an NMI. Just
compile a kernel for the correct processor type of your PS/2 and
everything should be fine. This is necessary even if one assumes,
that some 80486 system should be downward compatible to 80386
software.
 Q: Some commands hang and interrupts block the machine. After some
    timeout, the syslog reports that it tries to call abort, but the
machine is frozen.
 A: This can be a busy wait bug in the interrupt handler of driver 
    version 3.2. You should at least upgrade to 3.2c if you use 
kernel &lt; 2.4.0 and driver version 4.0 if you use kernel 2.4.0 or 
later (including all test releases).
 Q: I have a PS/2 model 80 and more than 16 MBytes of RAM. The driver
    completely refuses to work, reports NMIs, COMMAND ERRORs or other
ambiguous stuff. When reducing the RAM size down below 16 MB, 
everything is running smoothly.
 A: No real answer, yet. In any case, one should force the kernel to
    present SCBs only below the 16 MBytes barrier. Maybe this solves the
problem. Not yet tried, but guessing that it could work. To get this,
set unchecked_isa_dma argument of ibmmca.h from 0 to 1.
</code></pre>
<h2 id="5-3-Bug-reports"><a href="#5-3-Bug-reports" class="headerlink" title="   5.3 Bug reports"></a>   5.3 Bug reports</h2><p>   If you really find bugs in the source code or the driver will successfully<br>   refuse to work on your machine, you should send a bug report to me. The<br>   best for this is to follow the instructions on the WWW-page for this<br>   driver. Fill out the bug-report form, placed on the WWW-page and ship it,<br>   so the bugs can be taken into account with maximum efforts. But, please<br>   do not send bug reports about this driver to Linus Torvalds or Leonard<br>   Zubkoff, as Linus is buried in E-Mail and Leonard is supervising all<br>   SCSI-drivers and won’t have the time left to look inside every single<br>   driver to fix a bug and especially DO NOT send modified code to Linus<br>   Torvalds or Alan J. Cox which has not been checked here!!! They are both<br>   quite buried in E-mail (as me, sometimes, too) and one should first check<br>   for problems on my local teststand. Recently, I got a lot of<br>   bug reports for errors in the ibmmca.c code, which I could not imagine, but<br>   a look inside some Linux-distribution showed me quite often some modified<br>   code, which did no longer work on most other machines than the one of the<br>   modifier. Ok, so now that there is maintenance service available for this<br>   driver, please use this address first in order to keep the level of<br>   confusion low. Thank you!</p>
<p>   When you get a SCSI-error message that panics your system, a list of<br>   register-entries of the SCSI-subsystem is shown (from Version 3.1d). With<br>   this list, it is very easy for the maintainer to localize the problem in<br>   the driver or in the configuration of the user. Please write down all the<br>   values from this report and send them to the maintainer. This would really<br>   help a lot and makes life easier concerning misunderstandings.</p>
<p>   Use the bug-report form (see 5.4 for its address) to send all the bug-<br>   stuff to the maintainer or write e-mail with the values from the table. </p>
<h2 id="5-4-Support-WWW-page"><a href="#5-4-Support-WWW-page" class="headerlink" title="   5.4 Support WWW-page"></a>   5.4 Support WWW-page</h2><p>   The address of the IBM SCSI-subsystem supporting WWW-page is:</p>
<pre><code>    http://www.staff.uni-mainz.de/mlang/linux.html
</code></pre>
<p>   Here you can find info about the background of this driver, patches,<br>   troubleshooting support, news and a bugreport form. Please check that<br>   WWW-page regularly for latest hints. If ever this URL changes, please<br>   refer to the MAINTAINERS file in order to get the latest address.</p>
<p>   For the bugreport, please fill out the formular on the corresponding<br>   WWW-page. Read the dedicated instructions and write as much as you<br>   know about your problem. If you do not like such formulars, please send<br>   some e-mail directly, but at least with the same information as required by<br>   the formular.</p>
<p>   If you have extensive bug reports, including Oops messages and<br>   screen-shots, please feel free to send it directly to the address<br>   of the maintainer, too. The current address of the maintainer is:</p>
<pre><code>        Michael Lang &lt;langa2@kph.uni-mainz.de&gt;
</code></pre>
<h2 id="6-References"><a href="#6-References" class="headerlink" title="   6 References"></a>   6 References</h2><p>   IBM Corp., “Update for the PS/2 Hardware Interface Technical Reference,<br>   Common Interfaces”, Armonk, September 1991, PN 04G3281,<br>   (available in the U.S. for $21.75 at 1-800-IBM-PCTB or in Germany for<br>   around 40,-DM at “Hallo IBM”).</p>
<p>   IBM Corp., “Personal System/2 Micro Channel SCSI<br>   Adapter with Cache Technical Reference”, Armonk, March 1990, PN 68X2365.</p>
<p>   IBM Corp., “Personal System/2 Micro Channel SCSI<br>   Adapter Technical Reference”, Armonk, March 1990, PN 68X2397.</p>
<p>   IBM Corp., “SCSI-2 Fast/Wide Adapter/A Technical Reference - Dual Bus”,<br>   Armonk, March 1994, PN 83G7545.</p>
<p>   Friedhelm Schmidt, “SCSI-Bus und IDE-Schnittstelle - Moderne Peripherie-<br>   Schnittstellen: Hardware, Protokollbeschreibung und Anwendung”, 2. Aufl.<br>   Addison Wesley, 1996.</p>
<p>   Michael K. Johnson, “The Linux Kernel Hackers’ Guide”, Version 0.6, Chapel<br>   Hill - North Carolina, 1995</p>
<p>   Andreas Kaiser, “SCSI TAPE BACKUP for OS/2 2.0”, Version 2.12, Stuttgart<br>   1993</p>
<p>   Helmut Rompel, “IBM Computerwelt GUIDE”, What is what bei IBM., Systeme *<br>   Programme * Begriffe, IWT-Verlag GmbH - Muenchen, 1988</p>
<h2 id="7-Credits-to"><a href="#7-Credits-to" class="headerlink" title="   7 Credits to"></a>   7 Credits to</h2><h2 id="7-1-People"><a href="#7-1-People" class="headerlink" title="   7.1 People"></a>   7.1 People</h2><p>   Klaus Grimm<br>                who already a long time ago gave me the old code from the<br>        SCSI-driver in order to get it running for some old machine<br>        in our institute.<br>   Martin Kolinek<br>                who wrote the first release of the IBM SCSI-subsystem driver.<br>   Chris Beauregard<br>                who for a long time maintained MCA-Linux and the SCSI-driver<br>        in the beginning. Chris, wherever you are: Cheers to you!<br>   Klaus Kudielka<br>                with whom in the 2.1.x times, I had a quite fruitful<br>                cooperation to get the driver running as a module and to get<br>        it running with multiple SCSI-adapters.<br>   David Weinehall<br>                for his excellent maintenance of the MCA-stuff and the quite<br>        detailed bug reports and ideas for this driver (and his<br>        patience ;-)).<br>   Alan J. Cox<br>                for his bug reports and his bold activities in cross-checking<br>        the driver-code with his teststand.</p>
<h2 id="7-2-Sponsors-amp-Supporters"><a href="#7-2-Sponsors-amp-Supporters" class="headerlink" title="   7.2 Sponsors &amp; Supporters"></a>   7.2 Sponsors &amp; Supporters</h2><p>   “Hallo IBM”,<br>   IBM-Deutschland GmbH<br>                the service of IBM-Deutschland for customers. Their E-Mail<br>        service is unbeatable. Whatever old stuff I asked for, I<br>        always got some helpful answers.<br>   Karl-Otto Reimers,<br>   IBM Klub - Sparte IBM Geschichte, Sindelfingen<br>                for sending me a copy of the w/Cache manual from the<br>        IBM-Deutschland archives.<br>   Harald Staiger<br>                for his extensive hardware donations which allows me today<br>        still to test the driver in various constellations.<br>   Erich Fritscher<br>                for his very kind sponsoring.<br>   Louis Ohland,<br>   Charles Lasitter<br>                for support by shipping me an IBM SCSI-2 Fast/Wide manual.<br>                In addition, the contribution of various hardware is quite<br>                decessive and will make it possible to add FWSR (RAID)<br>                adapter support to the driver in the near future! So,<br>                complaints about no RAID support won’t remain forever.<br>                Yes, folks, that is no joke, RAID support is going to rise!<br>   Erik Weber<br>                for the great deal we made about a model 9595 and the nice<br>                surrounding equipment and the cool trip to Mannheim<br>                second-hand computer market. In addition, I would like<br>        to thank him for his exhaustive SCSI-driver testing on his<br>        95er PS/2 park.<br>   Anthony Hogbin<br>                for his direct shipment of a SCSI F/W adapter, which allowed<br>                me immediately on the first stage to try it on model 8557<br>                together with onboard SCSI adapter and some SCSI w/Cache.<br>   Andreas Hotz<br>                for his support by memory and an IBM SCSI-adapter. Collecting<br>                all this together now allows me to try really things with<br>                the driver at maximum load and variety on various models in<br>                a very quick and efficient way.<br>   Peter Jennewein<br>                for his model 30, which serves me as part of my teststand<br>        and his cool remark about how you make an ordinary diskette<br>        drive working and how to connect it to an IBM-diskette port.<br>   Johannes Gutenberg-Universitaet, Mainz &amp;<br>   Institut fuer Kernphysik, Mainz Microtron (MAMI)<br>                for the offered space, the link, placed on the central<br>                homepage and the space to store and offer the driver and<br>        related material and the free working times, which allow<br>                me to answer all your e-mail.</p>
<h2 id="8-Trademarks"><a href="#8-Trademarks" class="headerlink" title="   8 Trademarks"></a>   8 Trademarks</h2><p>   IBM, PS/2, OS/2, Microchannel are registered trademarks of International<br>   Business Machines Corporation</p>
<p>   MS-DOS is a registered trademark of Microsoft Corporation</p>
<p>   Microware, OS-9 are registered trademarks of Microware Systems</p>
<h2 id="9-Disclaimer"><a href="#9-Disclaimer" class="headerlink" title="   9 Disclaimer"></a>   9 Disclaimer</h2><p>   Beside the GNU General Public License and the dependent disclaimers and disclaimers<br>   concerning the Linux-kernel in special, this SCSI-driver comes without any<br>   warranty. Its functionality is tested as good as possible on certain<br>   machines and combinations of computer hardware, which does not exclude,<br>   that data loss or severe damage of hardware is possible while using this<br>   part of software on some arbitrary computer hardware or in combination<br>   with other software packages. It is highly recommended to make backup<br>   copies of your data before using this software. Furthermore, personal<br>   injuries by hardware defects, that could be caused by this SCSI-driver are<br>   not excluded and it is highly recommended to handle this driver with a<br>   maximum of carefulness.</p>
<p>   This driver supports hardware, produced by International Business Machines<br>   Corporation (IBM).</p>
<hr>
<p>Michael Lang<br>(langa2@kph.uni-mainz.de)</p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_ibmmca/" title="Kernel-2.6.32-573.12.1.el6_ibmmca" target="_blank" rel="external">http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_ibmmca/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">oosTech by Sam Lee</span><small class="ml-1x"></small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    

  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_memory-barriers/" title="Kernel-2.6.32-573.12.1.el6_memory-barriers"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_ftrace/" title="Kernel-2.6.32-573.12.1.el6_ftrace"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,wechat"></div>
    
  </div>
  </div>
    <div class="container" align="left">
    <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
      <img src="/images/wechatp.png" itemprop="contentUrl">
      <span>欢迎关注公众号</span>
    </div>
    </div>
</nav>

  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>您能有收获就是我们最大的动力</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码捐赠</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码捐赠</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
	<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn" text-align: center >粤ICP备2021024811号</a>
        </div>
<!--    
    <div>
     <img src="/images/logo.png" width="140" height="140">
    </div>
-->
    </div>


        <!-- 不蒜子统计    //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <!--<span id="busuanzi_container_site_pv" style="display:inline;">-->本站总访问量<span id="busuanzi_value_site_pv" style="display:inline;></span>次</span>
        <span class="post-meta-divider">|</span>
  
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>







   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>











</body>
</html>