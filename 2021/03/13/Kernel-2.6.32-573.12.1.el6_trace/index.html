<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>Kernel-2.6.32-573.12.1.el6_trace | oosTech.com</title>
  <meta name="description" content="CONFIG_RCU_TRACE debugfs Files and Formats The rcupreempt and rcutree implementations of RCU provide debugfs traceoutput that summarizes counters and state.  This information is useful fordebugging RC">
<meta property="og:type" content="article">
<meta property="og:title" content="Kernel-2.6.32-573.12.1.el6_trace">
<meta property="og:url" content="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_trace/index.html">
<meta property="og:site_name" content="oosTech">
<meta property="og:description" content="CONFIG_RCU_TRACE debugfs Files and Formats The rcupreempt and rcutree implementations of RCU provide debugfs traceoutput that summarizes counters and state.  This information is useful fordebugging RC">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:modified_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:author" content="Sam Lee">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_trace/index.html">
  
    <link rel="alternate" href="/atom.xml" title="oosTech" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img src="/images/avatar.png" width="400" height="400">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">oosTech by Sam Lee</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="站内搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">站点首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档文档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">文档分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">常用链接</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">共享白板</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告牌</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p> 欢迎来到oosTech ，我是一个Linux 拥趸：D。 目前正在用的Linux 版本是 Red Hat Enterprise Linux release 8.3 </p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">文档分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a><span class="category-list-count">830</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a><span class="category-list-count">1658</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-4-18-0-80-el8-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_4.18.0-80.el8_内核文档</a><span class="category-list-count">3937</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3270/" class="title">Kernel-3.10.0-957.el7_3270</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_devices/" class="title">Kernel-2.6.32-573.12.1.el6_devices</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3c509/" class="title">Kernel-3.10.0-957.el7_3c509</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_4CCs/" class="title">Kernel-3.10.0-957.el7_4CCs</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_53c700/" class="title">Kernel-3.10.0-957.el7_53c700</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Kernel-2.6.32-573.12.1.el6_trace" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Kernel-2.6.32-573.12.1.el6_trace
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_trace/" class="article-date">
	 published: <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
	</a>
</span>

        
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_trace/" class="article-date">
	   updated: <time datetime="2021-03-12T16:00:00.000Z" itemprop="dateUpdated">2021-03-13</time>
	</a>


        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
  </span>

        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill"></i>
	    <!--<span id="busuanzi_container_page_pv" style="display:inline;">-->
			<span id="busuanzi_value_page_pv" style="display:inline;"></span>
		<!--</span>-->
	</span>



        <!--<span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_trace/#comments" class="article-comment-link">评论</a></span> -->
        
	
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p>CONFIG_RCU_TRACE debugfs Files and Formats</p>
<p>The rcupreempt and rcutree implementations of RCU provide debugfs trace<br>output that summarizes counters and state.  This information is useful for<br>debugging RCU itself, and can sometimes also help to debug abuses of RCU.<br>Note that the rcuclassic implementation of RCU does not provide debugfs<br>trace output.</p>
<p>The following sections describe the debugfs files and formats for<br>preemptable RCU (rcupreempt) and hierarchical RCU (rcutree).</p>
<p>Preemptable RCU debugfs Files and Formats</p>
<p>This implementation of RCU provides three debugfs files under the<br>top-level directory RCU: rcu/rcuctrs (which displays the per-CPU<br>counters used by preemptable RCU) rcu/rcugp (which displays grace-period<br>counters), and rcu/rcustats (which internal counters for debugging RCU).</p>
<p>The output of “cat rcu/rcuctrs” looks as follows:</p>
<p>CPU last cur F M<br>  0    5  -5 0 0<br>  1   -1   0 0 0<br>  2    0   1 0 0<br>  3    0   1 0 0<br>  4    0   1 0 0<br>  5    0   1 0 0<br>  6    0   2 0 0<br>  7    0  -1 0 0<br>  8    0   1 0 0<br>ggp = 26226, state = waitzero</p>
<p>The per-CPU fields are as follows:</p>
<p>o    “CPU” gives the CPU number.  Offline CPUs are not displayed.</p>
<p>o    “last” gives the value of the counter that is being decremented<br>    for the current grace period phase.  In the example above,<br>    the counters sum to 4, indicating that there are still four<br>    RCU read-side critical sections still running that started<br>    before the last counter flip.</p>
<p>o    “cur” gives the value of the counter that is currently being<br>    both incremented (by rcu_read_lock()) and decremented (by<br>    rcu_read_unlock()).  In the example above, the counters sum to<br>    1, indicating that there is only one RCU read-side critical section<br>    still running that started after the last counter flip.</p>
<p>o    “F” indicates whether RCU is waiting for this CPU to acknowledge<br>    a counter flip.  In the above example, RCU is not waiting on any,<br>    which is consistent with the state being “waitzero” rather than<br>    “waitack”.</p>
<p>o    “M” indicates whether RCU is waiting for this CPU to execute a<br>    memory barrier.  In the above example, RCU is not waiting on any,<br>    which is consistent with the state being “waitzero” rather than<br>    “waitmb”.</p>
<p>o    “ggp” is the global grace-period counter.</p>
<p>o    “state” is the RCU state, which can be one of the following:</p>
<pre><code>o    &quot;idle&quot;: there is no grace period in progress.

o    &quot;waitack&quot;: RCU just incremented the global grace-period
    counter, which has the effect of reversing the roles of
    the &quot;last&quot; and &quot;cur&quot; counters above, and is waiting for
    all the CPUs to acknowledge the flip.  Once the flip has
    been acknowledged, CPUs will no longer be incrementing
    what are now the &quot;last&quot; counters, so that their sum will
    decrease monotonically down to zero.

o    &quot;waitzero&quot;: RCU is waiting for the sum of the &quot;last&quot; counters
    to decrease to zero.

o    &quot;waitmb&quot;: RCU is waiting for each CPU to execute a memory
    barrier, which ensures that instructions from a given CPU&#39;s
    last RCU read-side critical section cannot be reordered
    with instructions following the memory-barrier instruction.
</code></pre>
<p>The output of “cat rcu/rcugp” looks as follows:</p>
<p>oldggp=48870  newggp=48873</p>
<p>Note that reading from this file provokes a synchronize_rcu().  The<br>“oldggp” value is that of “ggp” from rcu/rcuctrs above, taken before<br>executing the synchronize_rcu(), and the “newggp” value is also the<br>“ggp” value, but taken after the synchronize_rcu() command returns.</p>
<p>The output of “cat rcu/rcugp” looks as follows:</p>
<p>na=1337955 nl=40 wa=1337915 wl=44 da=1337871 dl=0 dr=1337871 di=1337871<br>1=50989 e1=6138 i1=49722 ie1=82 g1=49640 a1=315203 ae1=265563 a2=49640<br>z1=1401244 ze1=1351605 z2=49639 m1=5661253 me1=5611614 m2=49639</p>
<p>These are counters tracking internal preemptable-RCU events, however,<br>some of them may be useful for debugging algorithms using RCU.  In<br>particular, the “nl”, “wl”, and “dl” values track the number of RCU<br>callbacks in various states.  The fields are as follows:</p>
<p>o    “na” is the total number of RCU callbacks that have been enqueued<br>    since boot.</p>
<p>o    “nl” is the number of RCU callbacks waiting for the previous<br>    grace period to end so that they can start waiting on the next<br>    grace period.</p>
<p>o    “wa” is the total number of RCU callbacks that have started waiting<br>    for a grace period since boot.  “na” should be roughly equal to<br>    “nl” plus “wa”.</p>
<p>o    “wl” is the number of RCU callbacks currently waiting for their<br>    grace period to end.</p>
<p>o    “da” is the total number of RCU callbacks whose grace periods<br>    have completed since boot.  “wa” should be roughly equal to<br>    “wl” plus “da”.</p>
<p>o    “dr” is the total number of RCU callbacks that have been removed<br>    from the list of callbacks ready to invoke.  “dr” should be roughly<br>    equal to “da”.</p>
<p>o    “di” is the total number of RCU callbacks that have been invoked<br>    since boot.  “di” should be roughly equal to “da”, though some<br>    early versions of preemptable RCU had a bug so that only the<br>    last CPU’s count of invocations was displayed, rather than the<br>    sum of all CPU’s counts.</p>
<p>o    “1” is the number of calls to rcu_try_flip().  This should be<br>    roughly equal to the sum of “e1”, “i1”, “a1”, “z1”, and “m1”<br>    described below.  In other words, the number of times that<br>    the state machine is visited should be equal to the sum of the<br>    number of times that each state is visited plus the number of<br>    times that the state-machine lock acquisition failed.</p>
<p>o    “e1” is the number of times that rcu_try_flip() was unable to<br>    acquire the fliplock.</p>
<p>o    “i1” is the number of calls to rcu_try_flip_idle().</p>
<p>o    “ie1” is the number of times rcu_try_flip_idle() exited early<br>    due to the calling CPU having no work for RCU.</p>
<p>o    “g1” is the number of times that rcu_try_flip_idle() decided<br>    to start a new grace period.  “i1” should be roughly equal to<br>    “ie1” plus “g1”.</p>
<p>o    “a1” is the number of calls to rcu_try_flip_waitack().</p>
<p>o    “ae1” is the number of times that rcu_try_flip_waitack() found<br>    that at least one CPU had not yet acknowledge the new grace period<br>    (AKA “counter flip”).</p>
<p>o    “a2” is the number of time rcu_try_flip_waitack() found that<br>    all CPUs had acknowledged.  “a1” should be roughly equal to<br>    “ae1” plus “a2”.  (This particular output was collected on<br>    a 128-CPU machine, hence the smaller-than-usual fraction of<br>    calls to rcu_try_flip_waitack() finding all CPUs having already<br>    acknowledged.)</p>
<p>o    “z1” is the number of calls to rcu_try_flip_waitzero().</p>
<p>o    “ze1” is the number of times that rcu_try_flip_waitzero() found<br>    that not all of the old RCU read-side critical sections had<br>    completed.</p>
<p>o    “z2” is the number of times that rcu_try_flip_waitzero() finds<br>    the sum of the counters equal to zero, in other words, that<br>    all of the old RCU read-side critical sections had completed.<br>    The value of “z1” should be roughly equal to “ze1” plus<br>    “z2”.</p>
<p>o    “m1” is the number of calls to rcu_try_flip_waitmb().</p>
<p>o    “me1” is the number of times that rcu_try_flip_waitmb() finds<br>    that at least one CPU has not yet executed a memory barrier.</p>
<p>o    “m2” is the number of times that rcu_try_flip_waitmb() finds that<br>    all CPUs have executed a memory barrier.</p>
<p>Hierarchical RCU debugfs Files and Formats</p>
<p>This implementation of RCU provides three debugfs files under the<br>top-level directory RCU: rcu/rcudata (which displays fields in struct<br>rcu_data), rcu/rcugp (which displays grace-period counters), and<br>rcu/rcuhier (which displays the struct rcu_node hierarchy).</p>
<p>The output of “cat rcu/rcudata” looks as follows:</p>
<p>rcu_sched:<br>  0 c=17829 g=17829 pq=1 pqc=17829 qp=0 dt=10951/1 dn=0 df=1101 of=0 ri=36 ql=0 b=10<br>  1 c=17829 g=17829 pq=1 pqc=17829 qp=0 dt=16117/1 dn=0 df=1015 of=0 ri=0 ql=0 b=10<br>  2 c=17829 g=17829 pq=1 pqc=17829 qp=0 dt=1445/1 dn=0 df=1839 of=0 ri=0 ql=0 b=10<br>  3 c=17829 g=17829 pq=1 pqc=17829 qp=0 dt=6681/1 dn=0 df=1545 of=0 ri=0 ql=0 b=10<br>  4 c=17829 g=17829 pq=1 pqc=17829 qp=0 dt=1003/1 dn=0 df=1992 of=0 ri=0 ql=0 b=10<br>  5 c=17829 g=17830 pq=1 pqc=17829 qp=1 dt=3887/1 dn=0 df=3331 of=0 ri=4 ql=2 b=10<br>  6 c=17829 g=17829 pq=1 pqc=17829 qp=0 dt=859/1 dn=0 df=3224 of=0 ri=0 ql=0 b=10<br>  7 c=17829 g=17830 pq=0 pqc=17829 qp=1 dt=3761/1 dn=0 df=1818 of=0 ri=0 ql=2 b=10<br>rcu_bh:<br>  0 c=-275 g=-275 pq=1 pqc=-275 qp=0 dt=10951/1 dn=0 df=0 of=0 ri=0 ql=0 b=10<br>  1 c=-275 g=-275 pq=1 pqc=-275 qp=0 dt=16117/1 dn=0 df=13 of=0 ri=0 ql=0 b=10<br>  2 c=-275 g=-275 pq=1 pqc=-275 qp=0 dt=1445/1 dn=0 df=15 of=0 ri=0 ql=0 b=10<br>  3 c=-275 g=-275 pq=1 pqc=-275 qp=0 dt=6681/1 dn=0 df=9 of=0 ri=0 ql=0 b=10<br>  4 c=-275 g=-275 pq=1 pqc=-275 qp=0 dt=1003/1 dn=0 df=15 of=0 ri=0 ql=0 b=10<br>  5 c=-275 g=-275 pq=1 pqc=-275 qp=0 dt=3887/1 dn=0 df=15 of=0 ri=0 ql=0 b=10<br>  6 c=-275 g=-275 pq=1 pqc=-275 qp=0 dt=859/1 dn=0 df=15 of=0 ri=0 ql=0 b=10<br>  7 c=-275 g=-275 pq=1 pqc=-275 qp=0 dt=3761/1 dn=0 df=15 of=0 ri=0 ql=0 b=10</p>
<p>The first section lists the rcu_data structures for rcu, the second for<br>rcu_bh.  Each section has one line per CPU, or eight for this 8-CPU system.<br>The fields are as follows:</p>
<p>o    The number at the beginning of each line is the CPU number.<br>    CPUs numbers followed by an exclamation mark are offline,<br>    but have been online at least once since boot.    There will be<br>    no output for CPUs that have never been online, which can be<br>    a good thing in the surprisingly common case where NR_CPUS is<br>    substantially larger than the number of actual CPUs.</p>
<p>o    “c” is the count of grace periods that this CPU believes have<br>    completed.  CPUs in dynticks idle mode may lag quite a ways<br>    behind, for example, CPU 4 under “rcu” above, which has slept<br>    through the past 25 RCU grace periods.    It is not unusual to<br>    see CPUs lagging by thousands of grace periods.</p>
<p>o    “g” is the count of grace periods that this CPU believes have<br>    started.  Again, CPUs in dynticks idle mode may lag behind.<br>    If the “c” and “g” values are equal, this CPU has already<br>    reported a quiescent state for the last RCU grace period that<br>    it is aware of, otherwise, the CPU believes that it owes RCU a<br>    quiescent state.</p>
<p>o    “pq” indicates that this CPU has passed through a quiescent state<br>    for the current grace period.  It is possible for “pq” to be<br>    “1” and “c” different than “g”, which indicates that although<br>    the CPU has passed through a quiescent state, either (1) this<br>    CPU has not yet reported that fact, (2) some other CPU has not<br>    yet reported for this grace period, or (3) both.</p>
<p>o    “pqc” indicates which grace period the last-observed quiescent<br>    state for this CPU corresponds to.  This is important for handling<br>    the race between CPU 0 reporting an extended dynticks-idle<br>    quiescent state for CPU 1 and CPU 1 suddenly waking up and<br>    reporting its own quiescent state.  If CPU 1 was the last CPU<br>    for the current grace period, then the CPU that loses this race<br>    will attempt to incorrectly mark CPU 1 as having checked in for<br>    the next grace period!</p>
<p>o    “qp” indicates that RCU still expects a quiescent state from<br>    this CPU.</p>
<p>o    “dt” is the current value of the dyntick counter that is incremented<br>    when entering or leaving dynticks idle state, either by the<br>    scheduler or by irq.  The number after the “/“ is the interrupt<br>    nesting depth when in dyntick-idle state, or one greater than<br>    the interrupt-nesting depth otherwise.</p>
<pre><code>This field is displayed only for CONFIG_NO_HZ kernels.
</code></pre>
<p>o    “dn” is the current value of the dyntick counter that is incremented<br>    when entering or leaving dynticks idle state via NMI.  If both<br>    the “dt” and “dn” values are even, then this CPU is in dynticks<br>    idle mode and may be ignored by RCU.  If either of these two<br>    counters is odd, then RCU must be alert to the possibility of<br>    an RCU read-side critical section running on this CPU.</p>
<pre><code>This field is displayed only for CONFIG_NO_HZ kernels.
</code></pre>
<p>o    “df” is the number of times that some other CPU has forced a<br>    quiescent state on behalf of this CPU due to this CPU being in<br>    dynticks-idle state.</p>
<pre><code>This field is displayed only for CONFIG_NO_HZ kernels.
</code></pre>
<p>o    “of” is the number of times that some other CPU has forced a<br>    quiescent state on behalf of this CPU due to this CPU being<br>    offline.  In a perfect world, this might neve happen, but it<br>    turns out that offlining and onlining a CPU can take several grace<br>    periods, and so there is likely to be an extended period of time<br>    when RCU believes that the CPU is online when it really is not.<br>    Please note that erring in the other direction (RCU believing a<br>    CPU is offline when it is really alive and kicking) is a fatal<br>    error, so it makes sense to err conservatively.</p>
<p>o    “ri” is the number of times that RCU has seen fit to send a<br>    reschedule IPI to this CPU in order to get it to report a<br>    quiescent state.</p>
<p>o    “ql” is the number of RCU callbacks currently residing on<br>    this CPU.  This is the total number of callbacks, regardless<br>    of what state they are in (new, waiting for grace period to<br>    start, waiting for grace period to end, ready to invoke).</p>
<p>o    “b” is the batch limit for this CPU.  If more than this number<br>    of RCU callbacks is ready to invoke, then the remainder will<br>    be deferred.</p>
<p>There is also an rcu/rcudata.csv file with the same information in<br>comma-separated-variable spreadsheet format.</p>
<p>The output of “cat rcu/rcugp” looks as follows:</p>
<p>rcu_sched: completed=33062  gpnum=33063<br>rcu_bh: completed=464  gpnum=464</p>
<p>Again, this output is for both “rcu” and “rcu_bh”.  The fields are<br>taken from the rcu_state structure, and are as follows:</p>
<p>o    “completed” is the number of grace periods that have completed.<br>    It is comparable to the “c” field from rcu/rcudata in that a<br>    CPU whose “c” field matches the value of “completed” is aware<br>    that the corresponding RCU grace period has completed.</p>
<p>o    “gpnum” is the number of grace periods that have started.  It is<br>    comparable to the “g” field from rcu/rcudata in that a CPU<br>    whose “g” field matches the value of “gpnum” is aware that the<br>    corresponding RCU grace period has started.</p>
<pre><code>If these two fields are equal (as they are for &quot;rcu_bh&quot; above),
then there is no grace period in progress, in other words, RCU
is idle.  On the other hand, if the two fields differ (as they
do for &quot;rcu&quot; above), then an RCU grace period is in progress.
</code></pre>
<p>The output of “cat rcu/rcuhier” looks as follows, with very long lines:</p>
<p>c=6902 g=6903 s=2 jfq=3 j=72c7 nfqs=13142/nfqsng=0(13142) fqlh=6<br>1/1 0:127 ^0<br>3/3 0:35 ^0    0/0 36:71 ^1    0/0 72:107 ^2    0/0 108:127 ^3<br>3/3f 0:5 ^0    2/3 6:11 ^1    0/0 12:17 ^2    0/0 18:23 ^3    0/0 24:29 ^4    0/0 30:35 ^5    0/0 36:41 ^0    0/0 42:47 ^1    0/0 48:53 ^2    0/0 54:59 ^3    0/0 60:65 ^4    0/0 66:71 ^5    0/0 72:77 ^0    0/0 78:83 ^1    0/0 84:89 ^2    0/0 90:95 ^3    0/0 96:101 ^4    0/0 102:107 ^5    0/0 108:113 ^0    0/0 114:119 ^1    0/0 120:125 ^2    0/0 126:127 ^3<br>rcu_bh:<br>c=-226 g=-226 s=1 jfq=-5701 j=72c7 nfqs=88/nfqsng=0(88) fqlh=0<br>0/1 0:127 ^0<br>0/3 0:35 ^0    0/0 36:71 ^1    0/0 72:107 ^2    0/0 108:127 ^3<br>0/3f 0:5 ^0    0/3 6:11 ^1    0/0 12:17 ^2    0/0 18:23 ^3    0/0 24:29 ^4    0/0 30:35 ^5    0/0 36:41 ^0    0/0 42:47 ^1    0/0 48:53 ^2    0/0 54:59 ^3    0/0 60:65 ^4    0/0 66:71 ^5    0/0 72:77 ^0    0/0 78:83 ^1    0/0 84:89 ^2    0/0 90:95 ^3    0/0 96:101 ^4    0/0 102:107 ^5    0/0 108:113 ^0    0/0 114:119 ^1    0/0 120:125 ^2    0/0 126:127 ^3</p>
<p>This is once again split into “rcu” and “rcu_bh” portions.  The fields are<br>as follows:</p>
<p>o    “c” is exactly the same as “completed” under rcu/rcugp.</p>
<p>o    “g” is exactly the same as “gpnum” under rcu/rcugp.</p>
<p>o    “s” is the “signaled” state that drives force_quiescent_state()’s<br>    state machine.</p>
<p>o    “jfq” is the number of jiffies remaining for this grace period<br>    before force_quiescent_state() is invoked to help push things<br>    along.  Note that CPUs in dyntick-idle mode thoughout the grace<br>    period will not report on their own, but rather must be check by<br>    some other CPU via force_quiescent_state().</p>
<p>o    “j” is the low-order four hex digits of the jiffies counter.<br>    Yes, Paul did run into a number of problems that turned out to<br>    be due to the jiffies counter no longer counting.  Why do you ask?</p>
<p>o    “nfqs” is the number of calls to force_quiescent_state() since<br>    boot.</p>
<p>o    “nfqsng” is the number of useless calls to force_quiescent_state(),<br>    where there wasn’t actually a grace period active.  This can<br>    happen due to races.  The number in parentheses is the difference<br>    between “nfqs” and “nfqsng”, or the number of times that<br>    force_quiescent_state() actually did some real work.</p>
<p>o    “fqlh” is the number of calls to force_quiescent_state() that<br>    exited immediately (without even being counted in nfqs above)<br>    due to contention on -&gt;fqslock.</p>
<p>o    Each element of the form “1/1 0:127 ^0” represents one struct<br>    rcu_node.  Each line represents one level of the hierarchy, from<br>    root to leaves.  It is best to think of the rcu_data structures<br>    as forming yet another level after the leaves.  Note that there<br>    might be either one, two, or three levels of rcu_node structures,<br>    depending on the relationship between CONFIG_RCU_FANOUT and<br>    CONFIG_NR_CPUS.</p>
<pre><code>o    The numbers separated by the &quot;/&quot; are the qsmask followed
    by the qsmaskinit.  The qsmask will have one bit
    set for each entity in the next lower level that
    has not yet checked in for the current grace period.
    The qsmaskinit will have one bit for each entity that is
    currently expected to check in during each grace period.
    The value of qsmaskinit is assigned to that of qsmask
    at the beginning of each grace period.

    For example, for &quot;rcu&quot;, the qsmask of the first entry
    of the lowest level is 0x14, meaning that we are still
    waiting for CPUs 2 and 4 to check in for the current
    grace period.

o    The numbers separated by the &quot;:&quot; are the range of CPUs
    served by this struct rcu_node.  This can be helpful
    in working out how the hierarchy is wired together.

    For example, the first entry at the lowest level shows
    &quot;0:5&quot;, indicating that it covers CPUs 0 through 5.

o    The number after the &quot;^&quot; indicates the bit in the
    next higher level rcu_node structure that this
    rcu_node structure corresponds to.

    For example, the first entry at the lowest level shows
    &quot;^0&quot;, indicating that it corresponds to bit zero in
    the first entry at the middle level.
</code></pre>
<p>The output of “cat rcu/rcu_pending” looks as follows:</p>
<p>rcu_sched:<br>  0 np=255892 qsp=53936 cbr=0 cng=14417 gpc=10033 gps=24320 nf=6445 nn=146741<br>  1 np=261224 qsp=54638 cbr=0 cng=25723 gpc=16310 gps=2849 nf=5912 nn=155792<br>  2 np=237496 qsp=49664 cbr=0 cng=2762 gpc=45478 gps=1762 nf=1201 nn=136629<br>  3 np=236249 qsp=48766 cbr=0 cng=286 gpc=48049 gps=1218 nf=207 nn=137723<br>  4 np=221310 qsp=46850 cbr=0 cng=26 gpc=43161 gps=4634 nf=3529 nn=123110<br>  5 np=237332 qsp=48449 cbr=0 cng=54 gpc=47920 gps=3252 nf=201 nn=137456<br>  6 np=219995 qsp=46718 cbr=0 cng=50 gpc=42098 gps=6093 nf=4202 nn=120834<br>  7 np=249893 qsp=49390 cbr=0 cng=72 gpc=38400 gps=17102 nf=41 nn=144888<br>rcu_bh:<br>  0 np=146741 qsp=1419 cbr=0 cng=6 gpc=0 gps=0 nf=2 nn=145314<br>  1 np=155792 qsp=12597 cbr=0 cng=0 gpc=4 gps=8 nf=3 nn=143180<br>  2 np=136629 qsp=18680 cbr=0 cng=0 gpc=7 gps=6 nf=0 nn=117936<br>  3 np=137723 qsp=2843 cbr=0 cng=0 gpc=10 gps=7 nf=0 nn=134863<br>  4 np=123110 qsp=12433 cbr=0 cng=0 gpc=4 gps=2 nf=0 nn=110671<br>  5 np=137456 qsp=4210 cbr=0 cng=0 gpc=6 gps=5 nf=0 nn=133235<br>  6 np=120834 qsp=9902 cbr=0 cng=0 gpc=6 gps=3 nf=2 nn=110921<br>  7 np=144888 qsp=26336 cbr=0 cng=0 gpc=8 gps=2 nf=0 nn=118542</p>
<p>As always, this is once again split into “rcu” and “rcu_bh” portions.<br>The fields are as follows:</p>
<p>o    “np” is the number of times that __rcu_pending() has been invoked<br>    for the corresponding flavor of RCU.</p>
<p>o    “qsp” is the number of times that the RCU was waiting for a<br>    quiescent state from this CPU.</p>
<p>o    “cbr” is the number of times that this CPU had RCU callbacks<br>    that had passed through a grace period, and were thus ready<br>    to be invoked.</p>
<p>o    “cng” is the number of times that this CPU needed another<br>    grace period while RCU was idle.</p>
<p>o    “gpc” is the number of times that an old grace period had<br>    completed, but this CPU was not yet aware of it.</p>
<p>o    “gps” is the number of times that a new grace period had started,<br>    but this CPU was not yet aware of it.</p>
<p>o    “nf” is the number of times that this CPU suspected that the<br>    current grace period had run for too long, and thus needed to<br>    be forced.</p>
<pre><code>Please note that &quot;forcing&quot; consists of sending resched IPIs
to holdout CPUs.  If that CPU really still is in an old RCU
read-side critical section, then we really do have to wait for it.
The assumption behing &quot;forcing&quot; is that the CPU is not still in
an old RCU read-side critical section, but has not yet responded
for some other reason.
</code></pre>
<p>o    “nn” is the number of times that this CPU needed nothing.  Alert<br>    readers will note that the rcu “nn” number for a given CPU very<br>    closely matches the rcu_bh “np” number for that same CPU.  This<br>    is due to short-circuit evaluation in rcu_pending().</p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_trace/" title="Kernel-2.6.32-573.12.1.el6_trace" target="_blank" rel="external">http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_trace/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">oosTech by Sam Lee</span><small class="ml-1x"></small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    

  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_transhuge/" title="Kernel-2.6.32-573.12.1.el6_transhuge"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_tmscsim/" title="Kernel-2.6.32-573.12.1.el6_tmscsi"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,wechat"></div>
    
  </div>
  </div>
    <div class="container" align="left">
    <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
      <img src="/images/wechatp.png" itemprop="contentUrl">
      <span>欢迎关注公众号</span>
    </div>
    </div>
</nav>

  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>您能有收获就是我们最大的动力</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码捐赠</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码捐赠</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
	<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn" text-align: center >粤ICP备2021024811号</a>
        </div>
<!--    
    <div>
     <img src="/images/logo.png" width="140" height="140">
    </div>
-->
    </div>


        <!-- 不蒜子统计    //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <!--<span id="busuanzi_container_site_pv" style="display:inline;">-->本站总访问量<span id="busuanzi_value_site_pv" style="display:inline;></span>次</span>
        <span class="post-meta-divider">|</span>
  
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>







   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>











</body>
</html>