<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>Kernel-2.6.32-573.12.1.el6_multi-touch-protocol | oosTech.com</title>
  <meta name="description" content="Multi-touch (MT) ProtocolCopyright (C) 2009-2010    Henrik Rydberg &lt;rydberg@euromail.se&gt;  IntroductionIn order to utilize the full power of the new multi-touch and multi-userdevices, a way to re">
<meta property="og:type" content="article">
<meta property="og:title" content="Kernel-2.6.32-573.12.1.el6_multi-touch-protocol">
<meta property="og:url" content="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_multi-touch-protocol/index.html">
<meta property="og:site_name" content="oosTech">
<meta property="og:description" content="Multi-touch (MT) ProtocolCopyright (C) 2009-2010    Henrik Rydberg &lt;rydberg@euromail.se&gt;  IntroductionIn order to utilize the full power of the new multi-touch and multi-userdevices, a way to re">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:modified_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:author" content="Sam Lee">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_multi-touch-protocol/index.html">
  
    <link rel="alternate" href="/atom.xml" title="oosTech" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img src="/images/avatar.png" width="400" height="400">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">oosTech by Sam Lee</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="站内搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">站点首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档文档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">文档分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">常用链接</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">共享白板</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告牌</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p> 欢迎来到oosTech ，我是一个Linux 拥趸：D。 目前正在用的Linux 版本是 Red Hat Enterprise Linux release 8.3 </p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">文档分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a><span class="category-list-count">830</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a><span class="category-list-count">1658</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-4-18-0-80-el8-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_4.18.0-80.el8_内核文档</a><span class="category-list-count">3937</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3270/" class="title">Kernel-3.10.0-957.el7_3270</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_devices/" class="title">Kernel-2.6.32-573.12.1.el6_devices</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3c509/" class="title">Kernel-3.10.0-957.el7_3c509</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_4CCs/" class="title">Kernel-3.10.0-957.el7_4CCs</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_53c700/" class="title">Kernel-3.10.0-957.el7_53c700</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Multi-touch-MT-Protocol"><span class="toc-number">1.</span> <span class="toc-text">Multi-touch (MT) Protocol</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">2.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Protocol-Usage"><span class="toc-number">3.</span> <span class="toc-text">Protocol Usage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Protocol-Example-A"><span class="toc-number">4.</span> <span class="toc-text">Protocol Example A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Protocol-Example-B"><span class="toc-number">5.</span> <span class="toc-text">Protocol Example B</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Event-Usage"><span class="toc-number">6.</span> <span class="toc-text">Event Usage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Event-Semantics"><span class="toc-number">7.</span> <span class="toc-text">Event Semantics</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Event-Computation"><span class="toc-number">8.</span> <span class="toc-text">Event Computation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Finger-Tracking"><span class="toc-number">9.</span> <span class="toc-text">Finger Tracking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gestures"><span class="toc-number">10.</span> <span class="toc-text">Gestures</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Notes"><span class="toc-number">11.</span> <span class="toc-text">Notes</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Kernel-2.6.32-573.12.1.el6_multi-touch-protocol" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Kernel-2.6.32-573.12.1.el6_multi-touch-protocol
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_multi-touch-protocol/" class="article-date">
	 published: <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
	</a>
</span>

        
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_multi-touch-protocol/" class="article-date">
	   updated: <time datetime="2021-03-12T16:00:00.000Z" itemprop="dateUpdated">2021-03-13</time>
	</a>


        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
  </span>

        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill"></i>
	    <!--<span id="busuanzi_container_page_pv" style="display:inline;">-->
			<span id="busuanzi_value_page_pv" style="display:inline;"></span>
		<!--</span>-->
	</span>



        <!--<span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_multi-touch-protocol/#comments" class="article-comment-link">评论</a></span> -->
        
	
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h2 id="Multi-touch-MT-Protocol"><a href="#Multi-touch-MT-Protocol" class="headerlink" title="Multi-touch (MT) Protocol"></a>Multi-touch (MT) Protocol</h2><pre><code>Copyright (C) 2009-2010    Henrik Rydberg &lt;rydberg@euromail.se&gt;
</code></pre>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In order to utilize the full power of the new multi-touch and multi-user<br>devices, a way to report detailed data from multiple contacts, i.e.,<br>objects in direct contact with the device surface, is needed.  This<br>document describes the multi-touch (MT) protocol which allows kernel<br>drivers to report details for an arbitrary number of contacts.</p>
<p>The protocol is divided into two types, depending on the capabilities of the<br>hardware. For devices handling anonymous contacts (type A), the protocol<br>describes how to send the raw data for all contacts to the receiver. For<br>devices capable of tracking identifiable contacts (type B), the protocol<br>describes how to send updates for individual contacts via event slots.</p>
<h2 id="Protocol-Usage"><a href="#Protocol-Usage" class="headerlink" title="Protocol Usage"></a>Protocol Usage</h2><p>Contact details are sent sequentially as separate packets of ABS_MT<br>events. Only the ABS_MT events are recognized as part of a contact<br>packet. Since these events are ignored by current single-touch (ST)<br>applications, the MT protocol can be implemented on top of the ST protocol<br>in an existing driver.</p>
<p>Drivers for type A devices separate contact packets by calling<br>input_mt_sync() at the end of each packet. This generates a SYN_MT_REPORT<br>event, which instructs the receiver to accept the data for the current<br>contact and prepare to receive another.</p>
<p>Drivers for type B devices separate contact packets by calling<br>input_mt_slot(), with a slot as argument, at the beginning of each packet.<br>This generates an ABS_MT_SLOT event, which instructs the receiver to<br>prepare for updates of the given slot.</p>
<p>All drivers mark the end of a multi-touch transfer by calling the usual<br>input_sync() function. This instructs the receiver to act upon events<br>accumulated since last EV_SYN/SYN_REPORT and prepare to receive a new set<br>of events/packets.</p>
<p>The main difference between the stateless type A protocol and the stateful<br>type B slot protocol lies in the usage of identifiable contacts to reduce<br>the amount of data sent to userspace. The slot protocol requires the use of<br>the ABS_MT_TRACKING_ID, either provided by the hardware or computed from<br>the raw data [5].</p>
<p>For type A devices, the kernel driver should generate an arbitrary<br>enumeration of the full set of anonymous contacts currently on the<br>surface. The order in which the packets appear in the event stream is not<br>important.  Event filtering and finger tracking is left to user space [3].</p>
<p>For type B devices, the kernel driver should associate a slot with each<br>identified contact, and use that slot to propagate changes for the contact.<br>Creation, replacement and destruction of contacts is achieved by modifying<br>the ABS_MT_TRACKING_ID of the associated slot.  A non-negative tracking id<br>is interpreted as a contact, and the value -1 denotes an unused slot.  A<br>tracking id not previously present is considered new, and a tracking id no<br>longer present is considered removed.  Since only changes are propagated,<br>the full state of each initiated contact has to reside in the receiving<br>end.  Upon receiving an MT event, one simply updates the appropriate<br>attribute of the current slot.</p>
<p>Some devices identify and/or track more contacts than they can report to the<br>driver.  A driver for such a device should associate one type B slot with each<br>contact that is reported by the hardware.  Whenever the identity of the<br>contact associated with a slot changes, the driver should invalidate that<br>slot by changing its ABS_MT_TRACKING_ID.  If the hardware signals that it is<br>tracking more contacts than it is currently reporting, the driver should use<br>a BTN_TOOL_<em>TAP event to inform userspace of the total number of contacts<br>being tracked by the hardware at that moment.  The driver should do this by<br>explicitly sending the corresponding BTN_TOOL_</em>TAP event and setting<br>use_count to false when calling input_mt_report_pointer_emulation().<br>The driver should only advertise as many slots as the hardware can report.<br>Userspace can detect that a driver can report more total contacts than slots<br>by noting that the largest supported BTN_TOOL_*TAP event is larger than the<br>total number of type B slots reported in the absinfo for the ABS_MT_SLOT axis.</p>
<p>The minimum value of the ABS_MT_SLOT axis must be 0.</p>
<h2 id="Protocol-Example-A"><a href="#Protocol-Example-A" class="headerlink" title="Protocol Example A"></a>Protocol Example A</h2><p>Here is what a minimal event sequence for a two-contact touch would look<br>like for a type A device:</p>
<p>   ABS_MT_POSITION_X x[0]<br>   ABS_MT_POSITION_Y y[0]<br>   SYN_MT_REPORT<br>   ABS_MT_POSITION_X x[1]<br>   ABS_MT_POSITION_Y y[1]<br>   SYN_MT_REPORT<br>   SYN_REPORT</p>
<p>The sequence after moving one of the contacts looks exactly the same; the<br>raw data for all present contacts are sent between every synchronization<br>with SYN_REPORT.</p>
<p>Here is the sequence after lifting the first contact:</p>
<p>   ABS_MT_POSITION_X x[1]<br>   ABS_MT_POSITION_Y y[1]<br>   SYN_MT_REPORT<br>   SYN_REPORT</p>
<p>And here is the sequence after lifting the second contact:</p>
<p>   SYN_MT_REPORT<br>   SYN_REPORT</p>
<p>If the driver reports one of BTN_TOUCH or ABS_PRESSURE in addition to the<br>ABS_MT events, the last SYN_MT_REPORT event may be omitted. Otherwise, the<br>last SYN_REPORT will be dropped by the input core, resulting in no<br>zero-contact event reaching userland.</p>
<h2 id="Protocol-Example-B"><a href="#Protocol-Example-B" class="headerlink" title="Protocol Example B"></a>Protocol Example B</h2><p>Here is what a minimal event sequence for a two-contact touch would look<br>like for a type B device:</p>
<p>   ABS_MT_SLOT 0<br>   ABS_MT_TRACKING_ID 45<br>   ABS_MT_POSITION_X x[0]<br>   ABS_MT_POSITION_Y y[0]<br>   ABS_MT_SLOT 1<br>   ABS_MT_TRACKING_ID 46<br>   ABS_MT_POSITION_X x[1]<br>   ABS_MT_POSITION_Y y[1]<br>   SYN_REPORT</p>
<p>Here is the sequence after moving contact 45 in the x direction:</p>
<p>   ABS_MT_SLOT 0<br>   ABS_MT_POSITION_X x[0]<br>   SYN_REPORT</p>
<p>Here is the sequence after lifting the contact in slot 0:</p>
<p>   ABS_MT_TRACKING_ID -1<br>   SYN_REPORT</p>
<p>The slot being modified is already 0, so the ABS_MT_SLOT is omitted.  The<br>message removes the association of slot 0 with contact 45, thereby<br>destroying contact 45 and freeing slot 0 to be reused for another contact.</p>
<p>Finally, here is the sequence after lifting the second contact:</p>
<p>   ABS_MT_SLOT 1<br>   ABS_MT_TRACKING_ID -1<br>   SYN_REPORT</p>
<h2 id="Event-Usage"><a href="#Event-Usage" class="headerlink" title="Event Usage"></a>Event Usage</h2><p>A set of ABS_MT events with the desired properties is defined. The events<br>are divided into categories, to allow for partial implementation.  The<br>minimum set consists of ABS_MT_POSITION_X and ABS_MT_POSITION_Y, which<br>allows for multiple contacts to be tracked.  If the device supports it, the<br>ABS_MT_TOUCH_MAJOR and ABS_MT_WIDTH_MAJOR may be used to provide the size<br>of the contact area and approaching tool, respectively.</p>
<p>The TOUCH and WIDTH parameters have a geometrical interpretation; imagine<br>looking through a window at someone gently holding a finger against the<br>glass.  You will see two regions, one inner region consisting of the part<br>of the finger actually touching the glass, and one outer region formed by<br>the perimeter of the finger. The center of the touching region (a) is<br>ABS_MT_POSITION_X/Y and the center of the approaching finger (b) is<br>ABS_MT_TOOL_X/Y. The touch diameter is ABS_MT_TOUCH_MAJOR and the finger<br>diameter is ABS_MT_WIDTH_MAJOR. Now imagine the person pressing the finger<br>harder against the glass. The touch region will increase, and in general,<br>the ratio ABS_MT_TOUCH_MAJOR / ABS_MT_WIDTH_MAJOR, which is always smaller<br>than unity, is related to the contact pressure. For pressure-based devices,<br>ABS_MT_PRESSURE may be used to provide the pressure on the contact area<br>instead. Devices capable of contact hovering can use ABS_MT_DISTANCE to<br>indicate the distance between the contact and the surface.</p>
<pre><code>  Linux MT                               Win8
     __________                     _______________________
    /          \                   |                       |
   /            \                  |                       |
  /     ____     \                 |                       |
 /     /    \     \                |                       |
 \     \  a  \     \               |       a               |
  \     \____/      \              |                       |
   \                 \             |                       |
    \        b        \            |           b           |
     \                 \           |                       |
      \                 \          |                       |
       \                 \         |                       |
        \                /         |                       |
         \              /          |                       |
          \            /           |                       |
           \__________/            |_______________________|
</code></pre>
<p>In addition to the MAJOR parameters, the oval shape of the touch and finger<br>regions can be described by adding the MINOR parameters, such that MAJOR<br>and MINOR are the major and minor axis of an ellipse. The orientation of<br>the touch ellipse can be described with the ORIENTATION parameter, and the<br>direction of the finger ellipse is given by the vector (a - b).</p>
<p>For type A devices, further specification of the touch shape is possible<br>via ABS_MT_BLOB_ID.</p>
<p>The ABS_MT_TOOL_TYPE may be used to specify whether the touching tool is a<br>finger or a pen or something else. Finally, the ABS_MT_TRACKING_ID event<br>may be used to track identified contacts over time [5].</p>
<p>In the type B protocol, ABS_MT_TOOL_TYPE and ABS_MT_TRACKING_ID are<br>implicitly handled by input core; drivers should instead call<br>input_mt_report_slot_state().</p>
<h2 id="Event-Semantics"><a href="#Event-Semantics" class="headerlink" title="Event Semantics"></a>Event Semantics</h2><p>ABS_MT_TOUCH_MAJOR</p>
<p>The length of the major axis of the contact. The length should be given in<br>surface units. If the surface has an X times Y resolution, the largest<br>possible value of ABS_MT_TOUCH_MAJOR is sqrt(X^2 + Y^2), the diagonal [4].</p>
<p>ABS_MT_TOUCH_MINOR</p>
<p>The length, in surface units, of the minor axis of the contact. If the<br>contact is circular, this event can be omitted [4].</p>
<p>ABS_MT_WIDTH_MAJOR</p>
<p>The length, in surface units, of the major axis of the approaching<br>tool. This should be understood as the size of the tool itself. The<br>orientation of the contact and the approaching tool are assumed to be the<br>same [4].</p>
<p>ABS_MT_WIDTH_MINOR</p>
<p>The length, in surface units, of the minor axis of the approaching<br>tool. Omit if circular [4].</p>
<p>The above four values can be used to derive additional information about<br>the contact. The ratio ABS_MT_TOUCH_MAJOR / ABS_MT_WIDTH_MAJOR approximates<br>the notion of pressure. The fingers of the hand and the palm all have<br>different characteristic widths.</p>
<p>ABS_MT_PRESSURE</p>
<p>The pressure, in arbitrary units, on the contact area. May be used instead<br>of TOUCH and WIDTH for pressure-based devices or any device with a spatial<br>signal intensity distribution.</p>
<p>ABS_MT_DISTANCE</p>
<p>The distance, in surface units, between the contact and the surface. Zero<br>distance means the contact is touching the surface. A positive number means<br>the contact is hovering above the surface.</p>
<p>ABS_MT_ORIENTATION</p>
<p>The orientation of the touching ellipse. The value should describe a signed<br>quarter of a revolution clockwise around the touch center. The signed value<br>range is arbitrary, but zero should be returned for an ellipse aligned with<br>the Y axis of the surface, a negative value when the ellipse is turned to<br>the left, and a positive value when the ellipse is turned to the<br>right. When completely aligned with the X axis, the range max should be<br>returned.</p>
<p>Touch ellipsis are symmetrical by default. For devices capable of true 360<br>degree orientation, the reported orientation must exceed the range max to<br>indicate more than a quarter of a revolution. For an upside-down finger,<br>range max * 2 should be returned.</p>
<p>Orientation can be omitted if the touch area is circular, or if the<br>information is not available in the kernel driver. Partial orientation<br>support is possible if the device can distinguish between the two axis, but<br>not (uniquely) any values in between. In such cases, the range of<br>ABS_MT_ORIENTATION should be [0, 1] [4].</p>
<p>ABS_MT_POSITION_X</p>
<p>The surface X coordinate of the center of the touching ellipse.</p>
<p>ABS_MT_POSITION_Y</p>
<p>The surface Y coordinate of the center of the touching ellipse.</p>
<p>ABS_MT_TOOL_X</p>
<p>The surface X coordinate of the center of the approaching tool. Omit if<br>the device cannot distinguish between the intended touch point and the<br>tool itself.</p>
<p>ABS_MT_TOOL_Y</p>
<p>The surface Y coordinate of the center of the approaching tool. Omit if the<br>device cannot distinguish between the intended touch point and the tool<br>itself.</p>
<p>The four position values can be used to separate the position of the touch<br>from the position of the tool. If both positions are present, the major<br>tool axis points towards the touch point [1]. Otherwise, the tool axes are<br>aligned with the touch axes.</p>
<p>ABS_MT_TOOL_TYPE</p>
<p>The type of approaching tool. A lot of kernel drivers cannot distinguish<br>between different tool types, such as a finger or a pen. In such cases, the<br>event should be omitted. The protocol currently supports MT_TOOL_FINGER and<br>MT_TOOL_PEN [2]. For type B devices, this event is handled by input core;<br>drivers should instead use input_mt_report_slot_state().</p>
<p>ABS_MT_BLOB_ID</p>
<p>The BLOB_ID groups several packets together into one arbitrarily shaped<br>contact. The sequence of points forms a polygon which defines the shape of<br>the contact. This is a low-level anonymous grouping for type A devices, and<br>should not be confused with the high-level trackingID [5]. Most type A<br>devices do not have blob capability, so drivers can safely omit this event.</p>
<p>ABS_MT_TRACKING_ID</p>
<p>The TRACKING_ID identifies an initiated contact throughout its life cycle<br>[5]. The value range of the TRACKING_ID should be large enough to ensure<br>unique identification of a contact maintained over an extended period of<br>time. For type B devices, this event is handled by input core; drivers<br>should instead use input_mt_report_slot_state().</p>
<h2 id="Event-Computation"><a href="#Event-Computation" class="headerlink" title="Event Computation"></a>Event Computation</h2><p>The flora of different hardware unavoidably leads to some devices fitting<br>better to the MT protocol than others. To simplify and unify the mapping,<br>this section gives recipes for how to compute certain events.</p>
<p>For devices reporting contacts as rectangular shapes, signed orientation<br>cannot be obtained. Assuming X and Y are the lengths of the sides of the<br>touching rectangle, here is a simple formula that retains the most<br>information possible:</p>
<p>   ABS_MT_TOUCH_MAJOR := max(X, Y)<br>   ABS_MT_TOUCH_MINOR := min(X, Y)<br>   ABS_MT_ORIENTATION := bool(X &gt; Y)</p>
<p>The range of ABS_MT_ORIENTATION should be set to [0, 1], to indicate that<br>the device can distinguish between a finger along the Y axis (0) and a<br>finger along the X axis (1).</p>
<p>For win8 devices with both T and C coordinates, the position mapping is</p>
<p>   ABS_MT_POSITION_X := T_X<br>   ABS_MT_POSITION_Y := T_Y<br>   ABS_MT_TOOL_X := C_X<br>   ABS_MT_TOOL_X := C_Y</p>
<p>Unfortunately, there is not enough information to specify both the touching<br>ellipse and the tool ellipse, so one has to resort to approximations.  One<br>simple scheme, which is compatible with earlier usage, is:</p>
<p>   ABS_MT_TOUCH_MAJOR := min(X, Y)<br>   ABS_MT_TOUCH_MINOR := <not used><br>   ABS_MT_ORIENTATION := <not used><br>   ABS_MT_WIDTH_MAJOR := min(X, Y) + distance(T, C)<br>   ABS_MT_WIDTH_MINOR := min(X, Y)</p>
<p>Rationale: We have no information about the orientation of the touching<br>ellipse, so approximate it with an inscribed circle instead. The tool<br>ellipse should align with the the vector (T - C), so the diameter must<br>increase with distance(T, C). Finally, assume that the touch diameter is<br>equal to the tool thickness, and we arrive at the formulas above.</p>
<h2 id="Finger-Tracking"><a href="#Finger-Tracking" class="headerlink" title="Finger Tracking"></a>Finger Tracking</h2><p>The process of finger tracking, i.e., to assign a unique trackingID to each<br>initiated contact on the surface, is a Euclidian Bipartite Matching<br>problem.  At each event synchronization, the set of actual contacts is<br>matched to the set of contacts from the previous synchronization. A full<br>implementation can be found in [3].</p>
<h2 id="Gestures"><a href="#Gestures" class="headerlink" title="Gestures"></a>Gestures</h2><p>In the specific application of creating gesture events, the TOUCH and WIDTH<br>parameters can be used to, e.g., approximate finger pressure or distinguish<br>between index finger and thumb. With the addition of the MINOR parameters,<br>one can also distinguish between a sweeping finger and a pointing finger,<br>and with ORIENTATION, one can detect twisting of fingers.</p>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><p>In order to stay compatible with existing applications, the data reported<br>in a finger packet must not be recognized as single-touch events.</p>
<p>For type A devices, all finger data bypasses input filtering, since<br>subsequent events of the same type refer to different fingers.</p>
<p>For example usage of the type A protocol, see the bcm5974 driver. For<br>example usage of the type B protocol, see the hid-egalax driver.</p>
<p>[1] Also, the difference (TOOL_X - POSITION_X) can be used to model tilt.<br>[2] The list can of course be extended.<br>[3] The mtdev project: <a target="_blank" rel="noopener" href="http://bitmath.org/code/mtdev/">http://bitmath.org/code/mtdev/</a>.<br>[4] See the section on event computation.<br>[5] See the section on finger tracking.</p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_multi-touch-protocol/" title="Kernel-2.6.32-573.12.1.el6_multi-touch-protocol" target="_blank" rel="external">http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_multi-touch-protocol/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">oosTech by Sam Lee</span><small class="ml-1x"></small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    

  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_nand_ecc/" title="Kernel-2.6.32-573.12.1.el6_nand_ecc"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_modules/" title="Kernel-2.6.32-573.12.1.el6_modules"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,wechat"></div>
    
  </div>
  </div>
    <div class="container" align="left">
    <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
      <img src="/images/wechatp.png" itemprop="contentUrl">
      <span>欢迎关注公众号</span>
    </div>
    </div>
</nav>

  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>您能有收获就是我们最大的动力</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码捐赠</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码捐赠</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
	<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn" text-align: center >粤ICP备2021024811号</a>
        </div>
<!--    
    <div>
     <img src="/images/logo.png" width="140" height="140">
    </div>
-->
    </div>


        <!-- 不蒜子统计    //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <!--<span id="busuanzi_container_site_pv" style="display:inline;">-->本站总访问量<span id="busuanzi_value_site_pv" style="display:inline;></span>次</span>
        <span class="post-meta-divider">|</span>
  
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>







   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>











</body>
</html>