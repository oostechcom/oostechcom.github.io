<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>Kernel-2.6.32-573.12.1.el6_qe_firmware | oosTech.com</title>
  <meta name="description" content="Freescale QUICC Engine Firmware Uploading    -----------------------------------------  (c) 2007 Timur Tabi ,    Freescale Semiconductor Table of Contents  I - Software License for Firmware   II -">
<meta property="og:type" content="article">
<meta property="og:title" content="Kernel-2.6.32-573.12.1.el6_qe_firmware">
<meta property="og:url" content="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_qe_firmware/index.html">
<meta property="og:site_name" content="oosTech">
<meta property="og:description" content="Freescale QUICC Engine Firmware Uploading    -----------------------------------------  (c) 2007 Timur Tabi ,    Freescale Semiconductor Table of Contents  I - Software License for Firmware   II -">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:modified_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:author" content="Sam Lee">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_qe_firmware/index.html">
  
    <link rel="alternate" href="/atom.xml" title="oosTech" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img src="/images/avatar.png" width="400" height="400">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">oosTech by Sam Lee</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="站内搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">站点首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档文档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">文档分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">常用链接</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">共享白板</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告牌</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p> 欢迎来到oosTech ，我是一个Linux 拥趸：D。 目前正在用的Linux 版本是 Red Hat Enterprise Linux release 8.3 </p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">文档分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a><span class="category-list-count">830</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a><span class="category-list-count">1658</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-4-18-0-80-el8-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_4.18.0-80.el8_内核文档</a><span class="category-list-count">3937</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3270/" class="title">Kernel-3.10.0-957.el7_3270</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_devices/" class="title">Kernel-2.6.32-573.12.1.el6_devices</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3c509/" class="title">Kernel-3.10.0-957.el7_3c509</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_4CCs/" class="title">Kernel-3.10.0-957.el7_4CCs</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_53c700/" class="title">Kernel-3.10.0-957.el7_53c700</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Table-of-Contents"><span class="toc-number">1.</span> <span class="toc-text">Table of Contents</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Revision-Information"><span class="toc-number">2.</span> <span class="toc-text">Revision Information</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#I-Software-License-for-Firmware"><span class="toc-number">3.</span> <span class="toc-text">I - Software License for Firmware</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#II-Microcode-Availability"><span class="toc-number">4.</span> <span class="toc-text">II - Microcode Availability</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#III-Description-and-Terminology"><span class="toc-number">5.</span> <span class="toc-text">III - Description and Terminology</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IV-Microcode-Programming-Details"><span class="toc-number">6.</span> <span class="toc-text">IV - Microcode Programming Details</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#V-Firmware-Structure-Layout"><span class="toc-number">7.</span> <span class="toc-text">V - Firmware Structure Layout</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VI-Sample-Code-for-Creating-Firmware-Files"><span class="toc-number">8.</span> <span class="toc-text">VI - Sample Code for Creating Firmware Files</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Kernel-2.6.32-573.12.1.el6_qe_firmware" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Kernel-2.6.32-573.12.1.el6_qe_firmware
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_qe_firmware/" class="article-date">
	 published: <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
	</a>
</span>

        
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_qe_firmware/" class="article-date">
	   updated: <time datetime="2021-03-12T16:00:00.000Z" itemprop="dateUpdated">2021-03-13</time>
	</a>


        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
  </span>

        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill"></i>
	    <!--<span id="busuanzi_container_page_pv" style="display:inline;">-->
			<span id="busuanzi_value_page_pv" style="display:inline;"></span>
		<!--</span>-->
	</span>



        <!--<span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_qe_firmware/#comments" class="article-comment-link">评论</a></span> -->
        
	
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <pre><code>   Freescale QUICC Engine Firmware Uploading
   -----------------------------------------
</code></pre>
<p>(c) 2007 Timur Tabi <timur at freescale.com>,<br>    Freescale Semiconductor</p>
<h1 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h1><p>  I - Software License for Firmware</p>
<p>  II - Microcode Availability</p>
<p>  III - Description and Terminology</p>
<p>  IV - Microcode Programming Details</p>
<p>  V - Firmware Structure Layout</p>
<p>  VI - Sample Code for Creating Firmware Files</p>
<h1 id="Revision-Information"><a href="#Revision-Information" class="headerlink" title="Revision Information"></a>Revision Information</h1><p>November 30, 2007: Rev 1.0 - Initial version</p>
<h1 id="I-Software-License-for-Firmware"><a href="#I-Software-License-for-Firmware" class="headerlink" title="I - Software License for Firmware"></a>I - Software License for Firmware</h1><p>Each firmware file comes with its own software license.  For information on<br>the particular license, please see the license text that is distributed with<br>the firmware.</p>
<h1 id="II-Microcode-Availability"><a href="#II-Microcode-Availability" class="headerlink" title="II - Microcode Availability"></a>II - Microcode Availability</h1><p>Firmware files are distributed through various channels.  Some are available on<br><a target="_blank" rel="noopener" href="http://opensource.freescale.com/">http://opensource.freescale.com</a>.  For other firmware files, please contact<br>your Freescale representative or your operating system vendor.</p>
<h1 id="III-Description-and-Terminology"><a href="#III-Description-and-Terminology" class="headerlink" title="III - Description and Terminology"></a>III - Description and Terminology</h1><p>In this document, the term ‘microcode’ refers to the sequence of 32-bit<br>integers that compose the actual QE microcode.</p>
<p>The term ‘firmware’ refers to a binary blob that contains the microcode as<br>well as other data that</p>
<pre><code>1) describes the microcode&#39;s purpose
2) describes how and where to upload the microcode
3) specifies the values of various registers
4) includes additional data for use by specific device drivers
</code></pre>
<p>Firmware files are binary files that contain only a firmware.</p>
<h1 id="IV-Microcode-Programming-Details"><a href="#IV-Microcode-Programming-Details" class="headerlink" title="IV - Microcode Programming Details"></a>IV - Microcode Programming Details</h1><p>The QE architecture allows for only one microcode present in I-RAM for each<br>RISC processor.  To replace any current microcode, a full QE reset (which<br>disables the microcode) must be performed first.</p>
<p>QE microcode is uploaded using the following procedure:</p>
<ol>
<li><p>The microcode is placed into I-RAM at a specific location, using the<br>IRAM.IADD and IRAM.IDATA registers.</p>
</li>
<li><p>The CERCR.CIR bit is set to 0 or 1, depending on whether the firmware<br>needs split I-RAM.  Split I-RAM is only meaningful for SOCs that have<br>QEs with multiple RISC processors, such as the 8360.  Splitting the I-RAM<br>allows each processor to run a different microcode, effectively creating an<br>asymmetric multiprocessing (AMP) system.</p>
</li>
<li><p>The TIBCR trap registers are loaded with the addresses of the trap handlers<br>in the microcode.</p>
</li>
<li><p>The RSP.ECCR register is programmed with the value provided.</p>
</li>
<li><p>If necessary, device drivers that need the virtual traps and extended mode<br>data will use them.</p>
</li>
</ol>
<p>Virtual Microcode Traps</p>
<p>These virtual traps are conditional branches in the microcode.  These are<br>“soft” provisional introduced in the ROMcode in order to enable higher<br>flexibility and save h/w traps If new features are activated or an issue is<br>being fixed in the RAM package utilizing they should be activated.  This data<br>structure signals the microcode which of these virtual traps is active.</p>
<p>This structure contains 6 words that the application should copy to some<br>specific been defined.  This table describes the structure.</p>
<pre><code>---------------------------------------------------------------
| Offset in |                  | Destination Offset | Size of |
|   array   |     Protocol     |   within PRAM      | Operand |
--------------------------------------------------------------|
|     0     | Ethernet         |      0xF8          | 4 bytes |
|           | interworking     |                    |         |
---------------------------------------------------------------
|     4     | ATM              |      0xF8          | 4 bytes |
|           | interworking     |                    |         |
---------------------------------------------------------------
|     8     | PPP              |      0xF8          | 4 bytes |
|           | interworking     |                    |         |
---------------------------------------------------------------
|     12    | Ethernet RX      |      0x22          | 1 byte  |
|           | Distributor Page |                    |         |
---------------------------------------------------------------
|     16    | ATM Globtal      |      0x28          | 1 byte  |
|           | Params Table     |                    |         |
---------------------------------------------------------------
|     20    | Insert Frame     |      0xF8          | 4 bytes |
---------------------------------------------------------------
</code></pre>
<p>Extended Modes</p>
<p>This is a double word bit array (64 bits) that defines special functionality<br>which has an impact on the softwarew drivers.  Each bit has its own impact<br>and has special instructions for the s/w associated with it.  This structure is<br>described in this table:</p>
<pre><code>-----------------------------------------------------------------------
| Bit #  |     Name     |   Description                               |
-----------------------------------------------------------------------
|   0    | General      | Indicates that prior to each host command   |
|        | push command | given by the application, the software must |
|        |              | assert a special host command (push command)|
|        |              | CECDR = 0x00800000.                         |
|        |              | CECR = 0x01c1000f.                          |
-----------------------------------------------------------------------
|   1    | UCC ATM      | Indicates that after issuing ATM RX INIT    |
|        | RX INIT      | command, the host must issue another special|
|        | push command | command (push command) and immediately      |
|        |              | following that re-issue the ATM RX INIT     |
|        |              | command. (This makes the sequence of        |
|        |              | initializing the ATM receiver a sequence of |
|        |              | three host commands)                        |
|        |              | CECDR = 0x00800000.                         |
|        |              | CECR = 0x01c1000f.                          |
-----------------------------------------------------------------------
|   2    | Add/remove   | Indicates that following the specific host  |
|        | command      | command: &quot;Add/Remove entry in Hash Lookup   |
|        | validation   | Table&quot; used in Interworking setup, the user |
|        |              | must issue another command.                 |
|        |              | CECDR = 0xce000003.                         |
|        |              | CECR = 0x01c10f58.                          |
-----------------------------------------------------------------------
|   3    | General push | Indicates that the s/w has to initialize    |
|        | command      | some pointers in the Ethernet thread pages  |
|        |              | which are used when Header Compression is   |
|        |              | activated.  The full details of these       |
|        |              | pointers is located in the software drivers.|
-----------------------------------------------------------------------
|   4    | General push | Indicates that after issuing Ethernet TX    |
|        | command      | INIT command, user must issue this command  |
|        |              | for each SNUM of Ethernet TX thread.        |
|        |              | CECDR = 0x00800003.                         |
|        |              | CECR = 0x7&#39;b&#123;0&#125;, 8&#39;b&#123;Enet TX thread SNUM&#125;,  |
|        |              |        1&#39;b&#123;1&#125;, 12&#39;b&#123;0&#125;, 4&#39;b&#123;1&#125;              |
-----------------------------------------------------------------------
| 5 - 31 |     N/A      | Reserved, set to zero.                      |
-----------------------------------------------------------------------
</code></pre>
<h1 id="V-Firmware-Structure-Layout"><a href="#V-Firmware-Structure-Layout" class="headerlink" title="V - Firmware Structure Layout"></a>V - Firmware Structure Layout</h1><p>QE microcode from Freescale is typically provided as a header file.  This<br>header file contains macros that define the microcode binary itself as well as<br>some other data used in uploading that microcode.  The format of these files<br>do not lend themselves to simple inclusion into other code.  Hence,<br>the need for a more portable format.  This section defines that format.</p>
<p>Instead of distributing a header file, the microcode and related data are<br>embedded into a binary blob.  This blob is passed to the qe_upload_firmware()<br>function, which parses the blob and performs everything necessary to upload<br>the microcode.</p>
<p>All integers are big-endian.  See the comments for function<br>qe_upload_firmware() for up-to-date implementation information.</p>
<p>This structure supports versioning, where the version of the structure is<br>embedded into the structure itself.  To ensure forward and backwards<br>compatibility, all versions of the structure must use the same ‘qe_header’<br>structure at the beginning.</p>
<p>‘header’ (type: struct qe_header):<br>    The ‘length’ field is the size, in bytes, of the entire structure,<br>    including all the microcode embedded in it, as well as the CRC (if<br>    present).</p>
<pre><code>The &#39;magic&#39; field is an array of three bytes that contains the letters
&#39;Q&#39;, &#39;E&#39;, and &#39;F&#39;.  This is an identifier that indicates that this
structure is a QE Firmware structure.

The &#39;version&#39; field is a single byte that indicates the version of this
structure.  If the layout of the structure should ever need to be
changed to add support for additional types of microcode, then the
version number should also be changed.
</code></pre>
<p>The ‘id’ field is a null-terminated string(suitable for printing) that<br>identifies the firmware.</p>
<p>The ‘count’ field indicates the number of ‘microcode’ structures.  There<br>must be one and only one ‘microcode’ structure for each RISC processor.<br>Therefore, this field also represents the number of RISC processors for this<br>SOC.</p>
<p>The ‘soc’ structure contains the SOC numbers and revisions used to match<br>the microcode to the SOC itself.  Normally, the microcode loader should<br>check the data in this structure with the SOC number and revisions, and<br>only upload the microcode if there’s a match.  However, this check is not<br>made on all platforms.</p>
<p>Although it is not recommended, you can specify ‘0’ in the soc.model<br>field to skip matching SOCs altogether.</p>
<p>The ‘model’ field is a 16-bit number that matches the actual SOC. The<br>‘major’ and ‘minor’ fields are the major and minor revision numbers,<br>respectively, of the SOC.</p>
<p>For example, to match the 8323, revision 1.0:<br>     soc.model = 8323<br>     soc.major = 1<br>     soc.minor = 0</p>
<p>‘padding’ is necessary for structure alignment.  This field ensures that the<br>‘extended_modes’ field is aligned on a 64-bit boundary.</p>
<p>‘extended_modes’ is a bitfield that defines special functionality which has an<br>impact on the device drivers.  Each bit has its own impact and has special<br>instructions for the driver associated with it.  This field is stored in<br>the QE library and available to any driver that calles qe_get_firmware_info().</p>
<p>‘vtraps’ is an array of 8 words that contain virtual trap values for each<br>virtual traps.  As with ‘extended_modes’, this field is stored in the QE<br>library and available to any driver that calles qe_get_firmware_info().</p>
<p>‘microcode’ (type: struct qe_microcode):<br>    For each RISC processor there is one ‘microcode’ structure.  The first<br>    ‘microcode’ structure is for the first RISC, and so on.</p>
<pre><code>The &#39;id&#39; field is a null-terminated string suitable for printing that
identifies this particular microcode.

&#39;traps&#39; is an array of 16 words that contain hardware trap values
for each of the 16 traps.  If trap[i] is 0, then this particular
trap is to be ignored (i.e. not written to TIBCR[i]).  The entire value
is written as-is to the TIBCR[i] register, so be sure to set the EN
and T_IBP bits if necessary.

&#39;eccr&#39; is the value to program into the ECCR register.

&#39;iram_offset&#39; is the offset into IRAM to start writing the
microcode.

&#39;count&#39; is the number of 32-bit words in the microcode.

&#39;code_offset&#39; is the offset, in bytes, from the beginning of this
structure where the microcode itself can be found.  The first
microcode binary should be located immediately after the &#39;microcode&#39;
array.

&#39;major&#39;, &#39;minor&#39;, and &#39;revision&#39; are the major, minor, and revision
version numbers, respectively, of the microcode.  If all values are 0,
then these fields are ignored.

&#39;reserved&#39; is necessary for structure alignment.  Since &#39;microcode&#39;
is an array, the 64-bit &#39;extended_modes&#39; field needs to be aligned
on a 64-bit boundary, and this can only happen if the size of
&#39;microcode&#39; is a multiple of 8 bytes.  To ensure that, we add
&#39;reserved&#39;.
</code></pre>
<p>After the last microcode is a 32-bit CRC.  It can be calculated using<br>this algorithm:</p>
<p>u32 crc32(const u8 *p, unsigned int len)<br>{<br>    unsigned int i;<br>    u32 crc = 0;</p>
<pre><code>while (len--) &#123;
   crc ^= *p++;
   for (i = 0; i &lt; 8; i++)
       crc = (crc &gt;&gt; 1) ^ ((crc &amp; 1) ? 0xedb88320 : 0);
&#125;
return crc;
</code></pre>
<p>}</p>
<h1 id="VI-Sample-Code-for-Creating-Firmware-Files"><a href="#VI-Sample-Code-for-Creating-Firmware-Files" class="headerlink" title="VI - Sample Code for Creating Firmware Files"></a>VI - Sample Code for Creating Firmware Files</h1><p>A Python program that creates firmware binaries from the header files normally<br>distributed by Freescale can be found on <a target="_blank" rel="noopener" href="http://opensource.freescale.com/">http://opensource.freescale.com</a>.</p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_qe_firmware/" title="Kernel-2.6.32-573.12.1.el6_qe_firmware" target="_blank" rel="external">http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_qe_firmware/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">oosTech by Sam Lee</span><small class="ml-1x"></small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    

  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_qlogicfas/" title="Kernel-2.6.32-573.12.1.el6_qlogicfas"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_qe/" title="Kernel-2.6.32-573.12.1.el6_qe"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,wechat"></div>
    
  </div>
  </div>
    <div class="container" align="left">
    <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
      <img src="/images/wechatp.png" itemprop="contentUrl">
      <span>欢迎关注公众号</span>
    </div>
    </div>
</nav>

  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>您能有收获就是我们最大的动力</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码捐赠</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码捐赠</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
	<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn" text-align: center >粤ICP备2021024811号</a>
        </div>
<!--    
    <div>
     <img src="/images/logo.png" width="140" height="140">
    </div>
-->
    </div>


        <!-- 不蒜子统计    //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <!--<span id="busuanzi_container_site_pv" style="display:inline;">-->本站总访问量<span id="busuanzi_value_site_pv" style="display:inline;></span>次</span>
        <span class="post-meta-divider">|</span>
  
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>







   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>











</body>
</html>