<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>Kernel-3.10.0-957.el7_fbcon | oosTech.com</title>
  <meta name="description" content="The Framebuffer ConsoleThe framebuffer console (fbcon), as its name implies, is a text  console running on top of the framebuffer device. It has the functionality ofany standard text console driver, s">
<meta property="og:type" content="article">
<meta property="og:title" content="Kernel-3.10.0-957.el7_fbcon">
<meta property="og:url" content="http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_fbcon/index.html">
<meta property="og:site_name" content="oosTech">
<meta property="og:description" content="The Framebuffer ConsoleThe framebuffer console (fbcon), as its name implies, is a text  console running on top of the framebuffer device. It has the functionality ofany standard text console driver, s">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:modified_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:author" content="Sam Lee">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_fbcon/index.html">
  
    <link rel="alternate" href="/atom.xml" title="oosTech" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img src="/images/avatar.png" width="400" height="400">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">oosTech by Sam Lee</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="站内搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">站点首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档文档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">文档分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">常用链接</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">共享白板</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告牌</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p> 欢迎来到oosTech ，我是一个Linux 拥趸：D。 目前正在用的Linux 版本是 Red Hat Enterprise Linux release 8.3 </p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">文档分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a><span class="category-list-count">830</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a><span class="category-list-count">1658</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-4-18-0-80-el8-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_4.18.0-80.el8_内核文档</a><span class="category-list-count">3937</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3270/" class="title">Kernel-3.10.0-957.el7_3270</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_devices/" class="title">Kernel-2.6.32-573.12.1.el6_devices</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3c509/" class="title">Kernel-3.10.0-957.el7_3c509</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_4CCs/" class="title">Kernel-3.10.0-957.el7_4CCs</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_53c700/" class="title">Kernel-3.10.0-957.el7_53c700</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#The-Framebuffer-Console"><span class="toc-number">1.</span> <span class="toc-text">The Framebuffer Console</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Notes-for-vesafb-users"><span class="toc-number">2.</span> <span class="toc-text">Notes for vesafb users:</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Samples"><span class="toc-number">3.</span> <span class="toc-text">Samples:</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Unbind-fbcon"><span class="toc-number">4.</span> <span class="toc-text">Unbind fbcon</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Change-this-to-where-your-actual-vgastate-file-is-located"><span class="toc-number">5.</span> <span class="toc-text">Change this to where your actual vgastate file is located</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Or-Use-VGASTATE-1-to-indicate-the-state-file-at-runtime"><span class="toc-number">6.</span> <span class="toc-text">Or Use VGASTATE&#x3D;$1 to indicate the state file at runtime</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#path-to-vbetool"><span class="toc-number">7.</span> <span class="toc-text">path to vbetool</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Bind-fbcon"><span class="toc-number">8.</span> <span class="toc-text">Bind fbcon</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Kernel-3.10.0-957.el7_fbcon" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Kernel-3.10.0-957.el7_fbcon
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/03/13/Kernel-3.10.0-957.el7_fbcon/" class="article-date">
	 published: <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
	</a>
</span>

        
	<a href="/2021/03/13/Kernel-3.10.0-957.el7_fbcon/" class="article-date">
	   updated: <time datetime="2021-03-12T16:00:00.000Z" itemprop="dateUpdated">2021-03-13</time>
	</a>


        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
  </span>

        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill"></i>
	    <!--<span id="busuanzi_container_page_pv" style="display:inline;">-->
			<span id="busuanzi_value_page_pv" style="display:inline;"></span>
		<!--</span>-->
	</span>



        <!--<span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/03/13/Kernel-3.10.0-957.el7_fbcon/#comments" class="article-comment-link">评论</a></span> -->
        
	
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h1 id="The-Framebuffer-Console"><a href="#The-Framebuffer-Console" class="headerlink" title="The Framebuffer Console"></a>The Framebuffer Console</h1><pre><code>The framebuffer console (fbcon), as its name implies, is a text
</code></pre>
<p>console running on top of the framebuffer device. It has the functionality of<br>any standard text console driver, such as the VGA console, with the added<br>features that can be attributed to the graphical nature of the framebuffer.</p>
<pre><code> In the x86 architecture, the framebuffer console is optional, and
</code></pre>
<p>some even treat it as a toy. For other architectures, it is the only available<br>display device, text or graphical.</p>
<pre><code> What are the features of fbcon?  The framebuffer console supports
</code></pre>
<p>high resolutions, varying font types, display rotation, primitive multihead,<br>etc. Theoretically, multi-colored fonts, blending, aliasing, and any feature<br>made available by the underlying graphics card are also possible.</p>
<p>A. Configuration</p>
<pre><code>The framebuffer console can be enabled by using your favorite kernel
</code></pre>
<p>configuration tool.  It is under Device Drivers-&gt;Graphics Support-&gt;Support for<br>framebuffer devices-&gt;Framebuffer Console Support. Select ‘y’ to compile<br>support statically, or ‘m’ for module support.  The module will be fbcon.</p>
<pre><code>In order for fbcon to activate, at least one framebuffer driver is
</code></pre>
<p>required, so choose from any of the numerous drivers available. For x86<br>systems, they almost universally have VGA cards, so vga16fb and vesafb will<br>always be available. However, using a chipset-specific driver will give you<br>more speed and features, such as the ability to change the video mode<br>dynamically.</p>
<pre><code>To display the penguin logo, choose any logo available in Logo
</code></pre>
<p>Configuration-&gt;Boot up logo.</p>
<pre><code>Also, you will need to select at least one compiled-in fonts, but if
</code></pre>
<p>you don’t do anything, the kernel configuration tool will select one for you,<br>usually an 8x16 font.</p>
<p>GOTCHA: A common bug report is enabling the framebuffer without enabling the<br>framebuffer console.  Depending on the driver, you may get a blanked or<br>garbled display, but the system still boots to completion.  If you are<br>fortunate to have a driver that does not alter the graphics chip, then you<br>will still get a VGA console.</p>
<p>B. Loading</p>
<p>Possible scenarios:</p>
<ol>
<li><p>Driver and fbcon are compiled statically</p>
<p>  Usually, fbcon will automatically take over your console. The notable<br>  exception is vesafb.  It needs to be explicitly activated with the<br>  vga= boot option parameter.</p>
</li>
<li><p>Driver is compiled statically, fbcon is compiled as a module</p>
<p>  Depending on the driver, you either get a standard console, or a<br>  garbled display, as mentioned above.  To get a framebuffer console,<br>  do a ‘modprobe fbcon’.</p>
</li>
<li><p>Driver is compiled as a module, fbcon is compiled statically</p>
<p>  You get your standard console.  Once the driver is loaded with<br>  ‘modprobe xxxfb’, fbcon automatically takes over the console with<br>  the possible exception of using the fbcon=map:n option. See below.</p>
</li>
<li><p>Driver and fbcon are compiled as a module.</p>
<p>  You can load them in any order. Once both are loaded, fbcon will take<br>  over the console.</p>
</li>
</ol>
<p>C. Boot options</p>
<pre><code>     The framebuffer console has several, largely unknown, boot options
     that can change its behavior.
</code></pre>
<ol>
<li><p>fbcon=font:<name></p>
<pre><code> Select the initial font to use. The value &#39;name&#39; can be any of the
 compiled-in fonts: VGA8x16, 7x14, 10x18, VGA8x8, MINI4x6, RomanLarge,
 SUN8x16, SUN12x22, ProFont6x11, Acorn8x8, PEARL8x8.
</code></pre>
<p> Note, not all drivers can handle font with widths not divisible by 8,</p>
<pre><code> such as vga16fb.
</code></pre>
</li>
<li><p>fbcon=scrollback:<value>[k]</p>
<pre><code> The scrollback buffer is memory that is used to preserve display
 contents that has already scrolled past your view.  This is accessed
 by using the Shift-PageUp key combination.  The value &#39;value&#39; is any
 integer. It defaults to 32KB.  The &#39;k&#39; suffix is optional, and will
 multiply the &#39;value&#39; by 1024.
</code></pre>
</li>
<li><p>fbcon=map:&lt;0123&gt;</p>
<pre><code> This is an interesting option. It tells which driver gets mapped to
 which console. The value &#39;0123&#39; is a sequence that gets repeated until
 the total length is 64 which is the number of consoles available. In
 the above example, it is expanded to 012301230123... and the mapping
 will be:

 tty | 1 2 3 4 5 6 7 8 9 ...
 fb  | 0 1 2 3 0 1 2 3 0 ...

 (&#39;cat /proc/fb&#39; should tell you what the fb numbers are)
</code></pre>
<p> One side effect that may be useful is using a map value that exceeds<br> the number of loaded fb drivers. For example, if only one driver is<br> available, fb0, adding fbcon=map:1 tells fbcon not to take over the<br> console.</p>
<p> Later on, when you want to map the console the to the framebuffer<br> device, you can use the con2fbmap utility.</p>
</li>
<li><p>fbcon=vc:<n1>-<n2></p>
<p> This option tells fbcon to take over only a range of consoles as<br> specified by the values ‘n1’ and ‘n2’. The rest of the consoles<br> outside the given range will still be controlled by the standard<br> console driver.</p>
<p> NOTE: For x86 machines, the standard console is the VGA console which<br> is typically located on the same video card.  Thus, the consoles that<br> are controlled by the VGA console will be garbled.</p>
</li>
<li><p>fbcon=rotate:<n></p>
<pre><code> This option changes the orientation angle of the console display. The
 value &#39;n&#39; accepts the following:

   0 - normal orientation (0 degree)
   1 - clockwise orientation (90 degrees)
   2 - upside down orientation (180 degrees)
   3 - counterclockwise orientation (270 degrees)
</code></pre>
<p> The angle can be changed anytime afterwards by ‘echoing’ the same<br> numbers to any one of the 2 attributes found in<br>  /sys/class/graphics/fbcon</p>
<pre><code> rotate     - rotate the display of the active console
 rotate_all - rotate the display of all consoles
</code></pre>
<p> Console rotation will only become available if Console Rotation<br> Support is compiled in your kernel.</p>
<p> NOTE: This is purely console rotation.  Any other applications that<br> use the framebuffer will remain at their ‘normal’orientation.<br> Actually, the underlying fb driver is totally ignorant of console<br> rotation.</p>
</li>
</ol>
<p>C. Attaching, Detaching and Unloading</p>
<p>Before going on on how to attach, detach and unload the framebuffer console, an<br>illustration of the dependencies may help.</p>
<p>The console layer, as with most subsystems, needs a driver that interfaces with<br>the hardware. Thus, in a VGA console:</p>
<p>console —&gt; VGA driver —&gt; hardware.</p>
<p>Assuming the VGA driver can be unloaded, one must first unbind the VGA driver<br>from the console layer before unloading the driver.  The VGA driver cannot be<br>unloaded if it is still bound to the console layer. (See<br>Documentation/console/console.txt for more information).</p>
<p>This is more complicated in the case of the framebuffer console (fbcon),<br>because fbcon is an intermediate layer between the console and the drivers:</p>
<p>console —&gt; fbcon —&gt; fbdev drivers —&gt; hardware</p>
<p>The fbdev drivers cannot be unloaded if it’s bound to fbcon, and fbcon cannot<br>be unloaded if it’s bound to the console layer.</p>
<p>So to unload the fbdev drivers, one must first unbind fbcon from the console,<br>then unbind the fbdev drivers from fbcon.  Fortunately, unbinding fbcon from<br>the console layer will automatically unbind framebuffer drivers from<br>fbcon. Thus, there is no need to explicitly unbind the fbdev drivers from<br>fbcon.</p>
<p>So, how do we unbind fbcon from the console? Part of the answer is in<br>Documentation/console/console.txt. To summarize:</p>
<p>Echo a value to the bind file that represents the framebuffer console<br>driver. So assuming vtcon1 represents fbcon, then:</p>
<p>echo 1 &gt; sys/class/vtconsole/vtcon1/bind - attach framebuffer console to<br>                                           console layer<br>echo 0 &gt; sys/class/vtconsole/vtcon1/bind - detach framebuffer console from<br>                                           console layer</p>
<p>If fbcon is detached from the console layer, your boot console driver (which is<br>usually VGA text mode) will take over.  A few drivers (rivafb and i810fb) will<br>restore VGA text mode for you.  With the rest, before detaching fbcon, you<br>must take a few additional steps to make sure that your VGA text mode is<br>restored properly. The following is one of the several methods that you can do:</p>
<ol>
<li><p>Download or install vbetool.  This utility is included with most<br>distributions nowadays, and is usually part of the suspend/resume tool.</p>
</li>
<li><p>In your kernel configuration, ensure that CONFIG_FRAMEBUFFER_CONSOLE is set<br>to ‘y’ or ‘m’. Enable one or more of your favorite framebuffer drivers.</p>
</li>
<li><p>Boot into text mode and as root run:</p>
<p> vbetool vbestate save &gt; <vga state file></p>
<p> The above command saves the register contents of your graphics<br> hardware to <vga state file>.  You need to do this step only once as<br> the state file can be reused.</p>
</li>
<li><p>If fbcon is compiled as a module, load fbcon by doing:</p>
<pre><code>modprobe fbcon
</code></pre>
</li>
<li><p>Now to detach fbcon:</p>
<pre><code>vbetool vbestate restore &lt; &lt;vga state file&gt; &amp;&amp; \
echo 0 &gt; /sys/class/vtconsole/vtcon1/bind
</code></pre>
</li>
<li><p>That’s it, you’re back to VGA mode. And if you compiled fbcon as a module,<br>you can unload it by ‘rmmod fbcon’</p>
</li>
<li><p>To reattach fbcon:</p>
<pre><code>echo 1 &gt; /sys/class/vtconsole/vtcon1/bind
</code></pre>
</li>
<li><p>Once fbcon is unbound, all drivers registered to the system will also<br>become unbound.  This means that fbcon and individual framebuffer drivers<br>can be unloaded or reloaded at will. Reloading the drivers or fbcon will<br>automatically bind the console, fbcon and the drivers together. Unloading<br>all the drivers without unloading fbcon will make it impossible for the<br>console to bind fbcon.</p>
</li>
</ol>
<h1 id="Notes-for-vesafb-users"><a href="#Notes-for-vesafb-users" class="headerlink" title="Notes for vesafb users:"></a>Notes for vesafb users:</h1><p>Unfortunately, if your bootline includes a vga=xxx parameter that sets the<br>hardware in graphics mode, such as when loading vesafb, vgacon will not load.<br>Instead, vgacon will replace the default boot console with dummycon, and you<br>won’t get any display after detaching fbcon. Your machine is still alive, so<br>you can reattach vesafb. However, to reattach vesafb, you need to do one of<br>the following:</p>
<p>Variation 1:</p>
<pre><code>a. Before detaching fbcon, do

   vbetool vbemode save &gt; &lt;vesa state file&gt; # do once for each vesafb mode,
                    # the file can be reused

b. Detach fbcon as in step 5.

c. Attach fbcon

    vbetool vbestate restore &lt; &lt;vesa state file&gt; &amp;&amp; \
echo 1 &gt; /sys/class/vtconsole/vtcon1/bind
</code></pre>
<p>Variation 2:</p>
<pre><code>a. Before detaching fbcon, do:
echo &lt;ID&gt; &gt; /sys/class/tty/console/bind


   vbetool vbemode get

b. Take note of the mode number

b. Detach fbcon as in step 5.

c. Attach fbcon:

   vbetool vbemode set &lt;mode number&gt; &amp;&amp; \
   echo 1 &gt; /sys/class/vtconsole/vtcon1/bind
</code></pre>
<h1 id="Samples"><a href="#Samples" class="headerlink" title="Samples:"></a>Samples:</h1><p>Here are 2 sample bash scripts that you can use to bind or unbind the<br>framebuffer console driver if you are in an X86 box:</p>
<hr>
<p>#!/bin/bash</p>
<h1 id="Unbind-fbcon"><a href="#Unbind-fbcon" class="headerlink" title="Unbind fbcon"></a>Unbind fbcon</h1><h1 id="Change-this-to-where-your-actual-vgastate-file-is-located"><a href="#Change-this-to-where-your-actual-vgastate-file-is-located" class="headerlink" title="Change this to where your actual vgastate file is located"></a>Change this to where your actual vgastate file is located</h1><h1 id="Or-Use-VGASTATE-1-to-indicate-the-state-file-at-runtime"><a href="#Or-Use-VGASTATE-1-to-indicate-the-state-file-at-runtime" class="headerlink" title="Or Use VGASTATE=$1 to indicate the state file at runtime"></a>Or Use VGASTATE=$1 to indicate the state file at runtime</h1><p>VGASTATE=/tmp/vgastate</p>
<h1 id="path-to-vbetool"><a href="#path-to-vbetool" class="headerlink" title="path to vbetool"></a>path to vbetool</h1><p>VBETOOL=/usr/local/bin</p>
<p>for (( i = 0; i &lt; 16; i++))<br>do<br>  if test -x /sys/class/vtconsole/vtcon$i; then<br>      if [ <code>cat /sys/class/vtconsole/vtcon$i/name | grep -c &quot;frame buffer&quot;</code> <br>           = 1 ]; then<br>        if test -x $VBETOOL/vbetool; then<br>           echo Unbinding vtcon$i<br>           $VBETOOL/vbetool vbestate restore &lt; $VGASTATE<br>           echo 0 &gt; /sys/class/vtconsole/vtcon$i/bind<br>        fi<br>      fi<br>  fi<br>done</p>
<hr>
<p>#!/bin/bash</p>
<h1 id="Bind-fbcon"><a href="#Bind-fbcon" class="headerlink" title="Bind fbcon"></a>Bind fbcon</h1><p>for (( i = 0; i &lt; 16; i++))<br>do<br>  if test -x /sys/class/vtconsole/vtcon$i; then<br>      if [ <code>cat /sys/class/vtconsole/vtcon$i/name | grep -c &quot;frame buffer&quot;</code> <br>           = 1 ]; then<br>      echo Unbinding vtcon$i<br>      echo 1 &gt; /sys/class/vtconsole/vtcon$i/bind<br>      fi<br>  fi<br>done</p>
<hr>
<p>–<br>Antonino Daplas <a href="mailto:&#97;&#x64;&#x61;&#112;&#x6c;&#97;&#115;&#64;&#112;&#x6f;&#x6c;&#46;&#110;&#101;&#116;">&#97;&#x64;&#x61;&#112;&#x6c;&#97;&#115;&#64;&#112;&#x6f;&#x6c;&#46;&#110;&#101;&#116;</a></p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_fbcon/" title="Kernel-3.10.0-957.el7_fbcon" target="_blank" rel="external">http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_fbcon/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">oosTech by Sam Lee</span><small class="ml-1x"></small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    

  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/03/13/Kernel-3.10.0-957.el7_fault_injection/" title="Kernel-3.10.0-957.el7_fault_injection"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/03/13/Kernel-3.10.0-957.el7_fg/" title="Kernel-3.10.0-957.el7_fg"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,wechat"></div>
    
  </div>
  </div>
    <div class="container" align="left">
    <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
      <img src="/images/wechatp.png" itemprop="contentUrl">
      <span>欢迎关注公众号</span>
    </div>
    </div>
</nav>

  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>您能有收获就是我们最大的动力</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码捐赠</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码捐赠</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
	<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn" text-align: center >粤ICP备2021024811号</a>
        </div>
<!--    
    <div>
     <img src="/images/logo.png" width="140" height="140">
    </div>
-->
    </div>


        <!-- 不蒜子统计    //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <!--<span id="busuanzi_container_site_pv" style="display:inline;">-->本站总访问量<span id="busuanzi_value_site_pv" style="display:inline;></span>次</span>
        <span class="post-meta-divider">|</span>
  
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>







   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>











</body>
</html>