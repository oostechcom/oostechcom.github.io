<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>Kernel-3.10.0-957.el7_atarikb | oosTech.com</title>
  <meta name="description" content="Intelligent Keyboard (ikbd) Protocol  Introduction  The Atari Corp. Intelligent Keyboard (ikbd) is a general purpose keyboardcontroller that is flexible enough that it can be used in a variety ofprodu">
<meta property="og:type" content="article">
<meta property="og:title" content="Kernel-3.10.0-957.el7_atarikb">
<meta property="og:url" content="http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_atarikbd/index.html">
<meta property="og:site_name" content="oosTech">
<meta property="og:description" content="Intelligent Keyboard (ikbd) Protocol  Introduction  The Atari Corp. Intelligent Keyboard (ikbd) is a general purpose keyboardcontroller that is flexible enough that it can be used in a variety ofprodu">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:modified_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:author" content="Sam Lee">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_atarikbd/index.html">
  
    <link rel="alternate" href="/atom.xml" title="oosTech" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img src="/images/avatar.png" width="400" height="400">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">oosTech by Sam Lee</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="站内搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">站点首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档文档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">文档分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">常用链接</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">共享白板</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告牌</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p> 欢迎来到oosTech ，我是一个Linux 拥趸：D。 目前正在用的Linux 版本是 Red Hat Enterprise Linux release 8.3 </p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">文档分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a><span class="category-list-count">830</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a><span class="category-list-count">1658</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-4-18-0-80-el8-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_4.18.0-80.el8_内核文档</a><span class="category-list-count">3937</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3270/" class="title">Kernel-3.10.0-957.el7_3270</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_devices/" class="title">Kernel-2.6.32-573.12.1.el6_devices</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3c509/" class="title">Kernel-3.10.0-957.el7_3c509</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_4CCs/" class="title">Kernel-3.10.0-957.el7_4CCs</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_53c700/" class="title">Kernel-3.10.0-957.el7_53c700</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Kernel-3.10.0-957.el7_atarikbd" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Kernel-3.10.0-957.el7_atarikb
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/03/13/Kernel-3.10.0-957.el7_atarikbd/" class="article-date">
	 published: <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
	</a>
</span>

        
	<a href="/2021/03/13/Kernel-3.10.0-957.el7_atarikbd/" class="article-date">
	   updated: <time datetime="2021-03-12T16:00:00.000Z" itemprop="dateUpdated">2021-03-13</time>
	</a>


        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
  </span>

        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill"></i>
	    <!--<span id="busuanzi_container_page_pv" style="display:inline;">-->
			<span id="busuanzi_value_page_pv" style="display:inline;"></span>
		<!--</span>-->
	</span>



        <!--<span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/03/13/Kernel-3.10.0-957.el7_atarikbd/#comments" class="article-comment-link">评论</a></span> -->
        
	
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p>Intelligent Keyboard (ikbd) Protocol</p>
<ol>
<li>Introduction</li>
</ol>
<p>The Atari Corp. Intelligent Keyboard (ikbd) is a general purpose keyboard<br>controller that is flexible enough that it can be used in a variety of<br>products without modification. The keyboard, with its microcontroller,<br>provides a convenient connection point for a mouse and switch-type joysticks.<br>The ikbd processor also maintains a time-of-day clock with one second<br>resolution.<br>The ikbd has been designed to be general enough that it can be used with a<br>variety of new computer products. Product variations in a number of<br>keyswitches, mouse resolution, etc. can be accommodated.<br>The ikbd communicates with the main processor over a high speed bi-directional<br>serial interface. It can function in a variety of modes to facilitate<br>different applications of the keyboard,  joysticks, or mouse. Limited use of<br>the controller is possible in applications in which only a unidirectional<br>communications medium is available by carefully designing the default modes.</p>
<ol start="3">
<li>Keyboard</li>
</ol>
<p>The keyboard always returns key make/break scan codes. The ikbd generates<br>keyboard scan codes for each key press and release. The key scan make (key<br>closure) codes start at 1, and are defined in Appendix A. For example, the<br>ISO key position in the scan code table should exist even if no keyswitch<br>exists in that position on a particular keyboard. The break code for each key<br>is obtained by ORing 0x80 with the make code.</p>
<p>The special codes 0xF6 through 0xFF are reserved for use as follows:<br>    0xF6            status report<br>    0xF7            absolute mouse position record<br>    0xF8-0xFB       relative mouse position records (lsbs determined by<br>                     mouse button states)<br>    0xFC            time-of-day<br>    0xFD            joystick report (both sticks)<br>    0xFE            joystick 0 event<br>    0xFF            joystick 1 event</p>
<p>The two shift keys return different scan codes in this mode. The ENTER key<br>and the RETurn key are also distinct.</p>
<ol start="4">
<li>Mouse</li>
</ol>
<p>The mouse port should be capable of supporting a mouse with resolution of<br>approximately 200 counts (phase changes or ‘clicks’) per inch of travel. The<br>mouse should be scanned at a rate that will permit accurate tracking at<br>velocities up to 10 inches per second.<br>The ikbd can report mouse motion in three distinctly different ways. It can<br>report relative motion, absolute motion in a coordinate system maintained<br>within the ikbd, or by converting mouse motion into keyboard cursor control<br>key equivalents.<br>The mouse buttons can be treated as part of the mouse or as additional<br>keyboard keys.</p>
<p>4.1 Relative Position Reporting</p>
<p>In relative position mode, the ikbd will return relative mouse position<br>records whenever a mouse event occurs. A mouse event consists of a mouse<br>button being pressed or released, or motion in either axis exceeding a<br>settable threshold of motion. Regardless of the threshold, all bits of<br>resolution are returned to the host computer.<br>Note that the ikbd may return mouse relative position reports with<br>significantly more than the threshold delta x or y. This may happen since no<br>relative mouse motion events will be generated: (a) while the keyboard has<br>been ‘paused’ ( the event will be stored until keyboard communications is<br>resumed) (b) while any event is being transmitted.</p>
<p>The relative mouse position record is a three byte record of the form<br>(regardless of keyboard mode):<br>    %111110xy           ; mouse position record flag<br>                        ; where y is the right button state<br>                        ; and x is the left button state<br>    X                   ; delta x as twos complement integer<br>    Y                   ; delta y as twos complement integer</p>
<p>Note that the value of the button state bits should be valid even if the<br>MOUSE BUTTON ACTION has set the buttons to act like part of the keyboard.<br>If the accumulated motion before the report packet is generated exceeds the<br>+127…-128 range, the motion is broken into multiple packets.<br>Note that the sign of the delta y reported is a function of the Y origin<br>selected.</p>
<p>4.2 Absolute Position reporting</p>
<p>The ikbd can also maintain absolute mouse position. Commands exist for<br>resetting the mouse position, setting X/Y scaling, and interrogating the<br>current mouse position.</p>
<p>4.3 Mouse Cursor Key Mode</p>
<p>The ikbd can translate mouse motion into the equivalent cursor keystrokes.<br>The number of mouse clicks per keystroke is independently programmable in<br>each axis. The ikbd internally maintains mouse motion information to the<br>highest resolution available, and merely generates a pair of cursor key events<br>for each multiple of the scale factor.<br>Mouse motion produces the cursor key make code immediately followed by the<br>break code for the appropriate cursor key. The mouse buttons produce scan<br>codes above those normally assigned for the largest envisioned keyboard (i.e.<br>LEFT=0x74 &amp; RIGHT=0x75).</p>
<ol start="5">
<li>Joystick</li>
</ol>
<p>5.1 Joystick Event Reporting</p>
<p>In this mode, the ikbd generates a record whenever the joystick position is<br>changed (i.e. for each opening or closing of a joystick switch or trigger).</p>
<p>The joystick event record is two bytes of the form:<br>    %1111111x           ; Joystick event marker<br>                        ; where x is Joystick 0 or 1<br>    %x000yyyy           ; where yyyy is the stick position<br>                        ; and x is the trigger</p>
<p>5.2 Joystick Interrogation</p>
<p>The current state of the joystick ports may be interrogated at any time in<br>this mode by sending an ‘Interrogate Joystick’ command to the ikbd.</p>
<p>The ikbd response to joystick interrogation is a three byte report of the form<br>    0xFD                ; joystick report header<br>    %x000yyyy           ; Joystick 0<br>    %x000yyyy           ; Joystick 1<br>                        ; where x is the trigger<br>                        ; and yyy is the stick position</p>
<p>5.3 Joystick Monitoring</p>
<p>A mode is available that devotes nearly all of the keyboard communications<br>time to reporting the state of the joystick ports at a user specifiable rate.<br>It remains in this mode until reset or commanded into another mode. The PAUSE<br>command in this mode not only stop the output but also temporarily stops<br>scanning the joysticks (samples are not queued).</p>
<p>5.4 Fire Button Monitoring</p>
<p>A mode is provided to permit monitoring a single input bit at a high rate. In<br>this mode the ikbd monitors the state of the Joystick 1 fire button at the<br>maximum rate permitted by the serial communication channel. The data is packed<br>8 bits per byte for transmission to the host. The ikbd remains in this mode<br>until reset or commanded into another mode. The PAUSE command in this mode not<br>only stops the output but also temporarily stops scanning the button (samples<br>are not queued).</p>
<p>5.5 Joystick Key Code Mode</p>
<p>The ikbd may be commanded to translate the use of either joystick into the<br>equivalent cursor control keystroke(s). The ikbd provides a single breakpoint<br>velocity joystick cursor.<br>Joystick events produce the make code, immediately followed by the break code<br>for the appropriate cursor motion keys. The trigger or fire buttons of the<br>joysticks produce pseudo key scan codes above those used by the largest key<br>matrix envisioned (i.e. JOYSTICK0=0x74, JOYSTICK1=0x75).</p>
<ol start="6">
<li>Time-of-Day Clock</li>
</ol>
<p>The ikbd also maintains a time-of-day clock for the system. Commands are<br>available to set and interrogate the timer-of-day clock. Time-keeping is<br>maintained down to a resolution of one second.</p>
<ol start="7">
<li>Status Inquiries</li>
</ol>
<p>The current state of ikbd modes and parameters may be found by sending status<br>inquiry commands that correspond to the ikbd set commands.</p>
<ol start="8">
<li>Power-Up Mode</li>
</ol>
<p>The keyboard controller will perform a simple self-test on power-up to detect<br>major controller faults (ROM checksum and RAM test) and such things as stuck<br>keys. Any keys down at power-up are presumed to be stuck, and their BREAK<br>(sic) code is returned (which without the preceding MAKE code is a flag for a<br>keyboard error). If the controller self-test completes without error, the code<br>0xF0 is returned. (This code will be used to indicate the version/release of<br>the ikbd controller. The first release of the ikbd is version 0xF0, should<br>there be a second release it will be 0xF1, and so on.)<br>The ikbd defaults to a mouse position reporting with threshold of 1 unit in<br>either axis and the Y=0 origin at the top of the screen, and joystick event<br>reporting mode for joystick 1, with both buttons being logically assigned to<br>the mouse. After any joystick command, the ikbd assumes that joysticks are<br>connected to both Joystick0 and Joystick1. Any mouse command (except MOUSE<br>DISABLE) then causes port 0 to again be scanned as if it were a mouse, and<br>both buttons are logically connected to it. If a mouse disable command is<br>received while port 0 is presumed to be a mouse, the button is logically<br>assigned to Joystick1 (until the mouse is reenabled by another mouse command).</p>
<ol start="9">
<li>ikbd Command Set</li>
</ol>
<p>This section contains a list of commands that can be sent to the ikbd. Command<br>codes (such as 0x00) which are not specified should perform no operation<br>(NOPs).</p>
<p>9.1 RESET</p>
<pre><code>0x80
0x01
</code></pre>
<p>N.B. The RESET command is the only two byte command understood by the ikbd.<br>Any byte following an 0x80 command byte other than 0x01 is ignored (and causes<br>the 0x80 to be ignored).<br>A reset may also be caused by sending a break lasting at least 200mS to the<br>ikbd.<br>Executing the RESET command returns the keyboard to its default (power-up)<br>mode and parameter settings. It does not affect the time-of-day clock.<br>The RESET command or function causes the ikbd to perform a simple self-test.<br>If the test is successful, the ikbd will send the code of 0xF0 within 300mS<br>of receipt of the RESET command (or the end of the break, or power-up). The<br>ikbd will then scan the key matrix for any stuck (closed) keys. Any keys found<br>closed will cause the break scan code to be generated (the break code arriving<br>without being preceded by the make code is a flag for a key matrix error).</p>
<p>9.2. SET MOUSE BUTTON ACTION</p>
<pre><code>0x07
%00000mss           ; mouse button action
                    ;       (m is presumed = 1 when in MOUSE KEYCODE mode)
                    ; mss=0xy, mouse button press or release causes mouse
                    ;  position report
                    ;  where y=1, mouse key press causes absolute report
                    ;  and x=1, mouse key release causes absolute report
                    ; mss=100, mouse buttons act like keys 
</code></pre>
<p>This command sets how the ikbd should treat the buttons on the mouse. The<br>default mouse button action mode is %00000000, the buttons are treated as part<br>of the mouse logically.<br>When buttons act like keys, LEFT=0x74 &amp; RIGHT=0x75.</p>
<p>9.3 SET RELATIVE MOUSE POSITION REPORTING</p>
<pre><code>0x08
</code></pre>
<p>Set relative mouse position reporting. (DEFAULT) Mouse position packets are<br>generated asynchronously by the ikbd whenever motion exceeds the setable<br>threshold in either axis (see SET MOUSE THRESHOLD). Depending upon the mouse<br>key mode, mouse position reports may also be generated when either mouse<br>button is pressed or released. Otherwise the mouse buttons behave as if they<br>were keyboard keys.</p>
<p>9.4 SET ABSOLUTE MOUSE POSITIONING</p>
<pre><code>0x09
XMSB                ; X maximum (in scaled mouse clicks)
XLSB
YMSB                ; Y maximum (in scaled mouse clicks)
YLSB
</code></pre>
<p>Set absolute mouse position maintenance. Resets the ikbd maintained X and Y<br>coordinates.<br>In this mode, the value of the internally maintained coordinates does NOT wrap<br>between 0 and large positive numbers. Excess motion below 0 is ignored. The<br>command sets the maximum positive value that can be attained in the scaled<br>coordinate system. Motion beyond that value is also ignored.</p>
<p>9.5 SET MOUSE KEYCODE MOSE</p>
<pre><code>0x0A
deltax              ; distance in X clicks to return (LEFT) or (RIGHT)
deltay              ; distance in Y clicks to return (UP) or (DOWN)
</code></pre>
<p>Set mouse monitoring routines to return cursor motion keycodes instead of<br>either RELATIVE or ABSOLUTE motion records. The ikbd returns the appropriate<br>cursor keycode after mouse travel exceeding the user specified deltas in<br>either axis. When the keyboard is in key scan code mode, mouse motion will<br>cause the make code immediately followed by the break code. Note that this<br>command is not affected by the mouse motion origin.</p>
<p>9..6 SET MOUSE THRESHOLD</p>
<pre><code>0x0B
X                   ; x threshold in mouse ticks (positive integers)
Y                   ; y threshold in mouse ticks (positive integers)
</code></pre>
<p>This command sets the threshold before a mouse event is generated. Note that<br>it does NOT affect the resolution of the data returned to the host. This<br>command is valid only in RELATIVE MOUSE POSITIONING mode. The thresholds<br>default to 1 at RESET (or power-up).</p>
<p>9.7 SET MOUSE SCALE</p>
<pre><code>0x0C
X                   ; horizontal mouse ticks per internal X
Y                   ; vertical mouse ticks per internal Y
</code></pre>
<p>This command sets the scale factor for the ABSOLUTE MOUSE POSITIONING mode.<br>In this mode, the specified number of mouse phase changes (‘clicks’) must<br>occur before the internally maintained coordinate is changed by one<br>(independently scaled for each axis). Remember that the mouse position<br>information is available only by interrogating the ikbd in the ABSOLUTE MOUSE<br>POSITIONING mode unless the ikbd has been commanded to report on button press<br>or release (see SET MOSE BUTTON ACTION).</p>
<p>9.8 INTERROGATE MOUSE POSITION</p>
<pre><code>0x0D
Returns:
        0xF7       ; absolute mouse position header
BUTTONS
        0000dcba   ; where a is right button down since last interrogation
                   ; b is right button up since last
                   ; c is left button down since last
                   ; d is left button up since last
        XMSB       ; X coordinate
        XLSB
        YMSB       ; Y coordinate
        YLSB
</code></pre>
<p>The INTERROGATE MOUSE POSITION command is valid when in the ABSOLUTE MOUSE<br>POSITIONING mode, regardless of the setting of the MOUSE BUTTON ACTION.</p>
<p>9.9 LOAD MOUSE POSITION</p>
<pre><code>0x0E
0x00                ; filler
XMSB                ; X coordinate
XLSB                ; (in scaled coordinate system)
YMSB                ; Y coordinate
YLSB
</code></pre>
<p>This command allows the user to preset the internally maintained absolute<br>mouse position.</p>
<p>9.10 SET Y=0 AT BOTTOM</p>
<pre><code>0x0F
</code></pre>
<p>This command makes the origin of the Y axis to be at the bottom of the<br>logical coordinate system internal to the ikbd for all relative or absolute<br>mouse motion. This causes mouse motion toward the user to be negative in sign<br>and away from the user to be positive.</p>
<p>9.11 SET Y=0 AT TOP</p>
<pre><code>0x10
</code></pre>
<p>Makes the origin of the Y axis to be at the top of the logical coordinate<br>system within the ikbd for all relative or absolute mouse motion. (DEFAULT)<br>This causes mouse motion toward the user to be positive in sign and away from<br>the user to be negative.</p>
<p>9.12 RESUME</p>
<pre><code>0x11
</code></pre>
<p>Resume sending data to the host. Since any command received by the ikbd after<br>its output has been paused also causes an implicit RESUME this command can be<br>thought of as a NO OPERATION command. If this command is received by the ikbd<br>and it is not PAUSED, it is simply ignored.</p>
<p>9.13 DISABLE MOUSE</p>
<pre><code>0x12
</code></pre>
<p>All mouse event reporting is disabled (and scanning may be internally<br>disabled). Any valid mouse mode command resumes mouse motion monitoring. (The<br>valid mouse mode commands are SET RELATIVE MOUSE POSITION REPORTING, SET<br>ABSOLUTE MOUSE POSITIONING, and SET MOUSE KEYCODE MODE. )<br>N.B. If the mouse buttons have been commanded to act like keyboard keys, this<br>command DOES affect their actions.</p>
<p>9.14 PAUSE OUTPUT</p>
<pre><code>0x13
</code></pre>
<p>Stop sending data to the host until another valid command is received. Key<br>matrix activity is still monitored and scan codes or ASCII characters enqueued<br>(up to the maximum supported by the microcontroller) to be sent when the host<br>allows the output to be resumed. If in the JOYSTICK EVENT REPORTING mode,<br>joystick events are also queued.<br>Mouse motion should be accumulated while the output is paused. If the ikbd is<br>in RELATIVE MOUSE POSITIONING REPORTING mode, motion is accumulated beyond the<br>normal threshold limits to produce the minimum number of packets necessary for<br>transmission when output is resumed. Pressing or releasing either mouse button<br>causes any accumulated motion to be immediately queued as packets, if the<br>mouse is in RELATIVE MOUSE POSITION REPORTING mode.<br>Because of the limitations of the microcontroller memory this command should<br>be used sparingly, and the output should not be shut of for more than <tbd><br>milliseconds at a time.<br>The output is stopped only at the end of the current ‘even’. If the PAUSE<br>OUTPUT command is received in the middle of a multiple byte report, the packet<br>will still be transmitted to conclusion and then the PAUSE will take effect.<br>When the ikbd is in either the JOYSTICK MONITORING mode or the FIRE BUTTON<br>MONITORING mode, the PAUSE OUTPUT command also temporarily stops the<br>monitoring process (i.e. the samples are not enqueued for transmission).</p>
<p>0.15 SET JOYSTICK EVENT REPORTING</p>
<pre><code>0x14
</code></pre>
<p>Enter JOYSTICK EVENT REPORTING mode (DEFAULT). Each opening or closure of a<br>joystick switch or trigger causes a joystick event record to be generated.</p>
<p>9.16 SET JOYSTICK INTERROGATION MODE</p>
<pre><code>0x15
</code></pre>
<p>Disables JOYSTICK EVENT REPORTING. Host must send individual JOYSTICK<br>INTERROGATE commands to sense joystick state.</p>
<p>9.17 JOYSTICK INTERROGATE</p>
<pre><code>0x16
</code></pre>
<p>Return a record indicating the current state of the joysticks. This command<br>is valid in either the JOYSTICK EVENT REPORTING mode or the JOYSTICK<br>INTERROGATION MODE.</p>
<p>9.18 SET JOYSTICK MONITORING</p>
<pre><code>0x17
rate                ; time between samples in hundredths of a second
Returns: (in packets of two as long as in mode)
        %000000xy   ; where y is JOYSTICK1 Fire button
                    ; and x is JOYSTICK0 Fire button
        %nnnnmmmm   ; where m is JOYSTICK1 state
                    ; and n is JOYSTICK0 state
</code></pre>
<p>Sets the ikbd to do nothing but monitor the serial command line, maintain the<br>time-of-day clock, and monitor the joystick. The rate sets the interval<br>between joystick samples.<br>N.B. The user should not set the rate higher than the serial communications<br>channel will allow the 2 bytes packets to be transmitted.</p>
<p>9.19 SET FIRE BUTTON MONITORING</p>
<pre><code>0x18
Returns: (as long as in mode)
        %bbbbbbbb   ; state of the JOYSTICK1 fire button packed
                    ; 8 bits per byte, the first sample if the MSB
</code></pre>
<p>Set the ikbd to do nothing but monitor the serial command line, maintain the<br>time-of-day clock, and monitor the fire button on Joystick 1. The fire button<br>is scanned at a rate that causes 8 samples to be made in the time it takes for<br>the previous byte to be sent to the host (i.e. scan rate = 8/10 * baud rate).<br>The sample interval should be as constant as possible.</p>
<p>9.20 SET JOYSTICK KEYCODE MODE</p>
<pre><code>0x19
RX                  ; length of time (in tenths of seconds) until
                    ; horizontal velocity breakpoint is reached
RY                  ; length of time (in tenths of seconds) until
                    ; vertical velocity breakpoint is reached
TX                  ; length (in tenths of seconds) of joystick closure
                    ; until horizontal cursor key is generated before RX
                    ; has elapsed
TY                  ; length (in tenths of seconds) of joystick closure
                    ; until vertical cursor key is generated before RY
                    ; has elapsed
VX                  ; length (in tenths of seconds) of joystick closure
                    ; until horizontal cursor keystrokes are generated
                    ; after RX has elapsed
VY                  ; length (in tenths of seconds) of joystick closure
                    ; until vertical cursor keystrokes are generated
                    ; after RY has elapsed
</code></pre>
<p>In this mode, joystick 0 is scanned in a way that simulates cursor keystrokes.<br>On initial closure, a keystroke pair (make/break) is generated. Then up to Rn<br>tenths of seconds later, keystroke pairs are generated every Tn tenths of<br>seconds. After the Rn breakpoint is reached, keystroke pairs are generated<br>every Vn tenths of seconds. This provides a velocity (auto-repeat) breakpoint<br>feature.<br>Note that by setting RX and/or Ry to zero, the velocity feature can be<br>disabled. The values of TX and TY then become meaningless, and the generation<br>of cursor ‘keystrokes’ is set by VX and VY.</p>
<p>9.21 DISABLE JOYSTICKS</p>
<pre><code>0x1A
</code></pre>
<p>Disable the generation of any joystick events (and scanning may be internally<br>disabled). Any valid joystick mode command resumes joystick monitoring. (The<br>joystick mode commands are SET JOYSTICK EVENT REPORTING, SET JOYSTICK<br>INTERROGATION MODE, SET JOYSTICK MONITORING, SET FIRE BUTTON MONITORING, and<br>SET JOYSTICK KEYCODE MODE.)</p>
<p>9.22 TIME-OF-DAY CLOCK SET</p>
<pre><code>0x1B
YY                  ; year (2 least significant digits)
MM                  ; month
DD                  ; day
hh                  ; hour
mm                  ; minute
ss                  ; second
</code></pre>
<p>All time-of-day data should be sent to the ikbd in packed BCD format.<br>Any digit that is not a valid BCD digit should be treated as a ‘don’t care’<br>and not alter that particular field of the date or time. This permits setting<br>only some subfields of the time-of-day clock.</p>
<p>9.23 INTERROGATE TIME-OF-DAT CLOCK</p>
<pre><code>0x1C
Returns:
        0xFC        ; time-of-day event header
        YY          ; year (2 least significant digits)
        MM          ; month
        DD          ; day
        hh          ; hour
        mm          ; minute
        ss          ; second

All time-of-day is sent in packed BCD format.
</code></pre>
<p>9.24 MEMORY LOAD</p>
<pre><code>0x20
ADRMSB              ; address in controller
ADRLSB              ; memory to be loaded
NUM                 ; number of bytes (0-128)
&#123; data &#125;
</code></pre>
<p>This command permits the host to load arbitrary values into the ikbd<br>controller memory. The time between data bytes must be less than 20ms.</p>
<p>9.25 MEMORY READ</p>
<pre><code>0x21
ADRMSB              ; address in controller
ADRLSB              ; memory to be read
Returns:
        0xF6        ; status header
        0x20        ; memory access
        &#123; data &#125;    ; 6 data bytes starting at ADR
</code></pre>
<p>This command permits the host to read from the ikbd controller memory.</p>
<p>9.26 CONTROLLER EXECUTE</p>
<pre><code>0x22
ADRMSB              ; address of subroutine in
ADRLSB              ; controller memory to be called
</code></pre>
<p>This command allows the host to command the execution of a subroutine in the<br>ikbd controller memory.</p>
<p>9.27 STATUS INQUIRIES</p>
<pre><code>Status commands are formed by inclusively ORing 0x80 with the
relevant SET command.

Example:
0x88 (or 0x89 or 0x8A)  ; request mouse mode
Returns:
        0xF6        ; status response header
        mode        ; 0x08 is RELATIVE
                    ; 0x09 is ABSOLUTE
                    ; 0x0A is KEYCODE
        param1      ; 0 is RELATIVE
                    ; XMSB maximum if ABSOLUTE
                    ; DELTA X is KEYCODE
        param2      ; 0 is RELATIVE
                    ; YMSB maximum if ABSOLUTE
                    ; DELTA Y is KEYCODE
        param3      ; 0 if RELATIVE
                    ; or KEYCODE
                    ; YMSB is ABSOLUTE
        param4      ; 0 if RELATIVE
                    ; or KEYCODE
                    ; YLSB is ABSOLUTE
        0           ; pad
        0
</code></pre>
<p>The STATUS INQUIRY commands request the ikbd to return either the current mode<br>or the parameters associated with a given command. All status reports are<br>padded to form 8 byte long return packets. The responses to the status<br>requests are designed so that the host may store them away (after stripping<br>off the status report header byte) and later send them back as commands to<br>ikbd to restore its state. The 0 pad bytes will be treated as NOPs by the<br>ikbd.</p>
<pre><code>Valid STATUS INQUIRY commands are:

        0x87    mouse button action
        0x88    mouse mode
        0x89
        0x8A
        0x8B    mnouse threshold
        0x8C    mouse scale
        0x8F    mouse vertical coordinates
        0x90    ( returns       0x0F Y=0 at bottom
                        0x10 Y=0 at top )
        0x92    mouse enable/disable
                ( returns       0x00 enabled)
                        0x12 disabled )
        0x94    joystick mode
        0x95
        0x96
        0x9A    joystick enable/disable
                ( returns       0x00 enabled
                        0x1A disabled )
</code></pre>
<p>It is the (host) programmer’s responsibility to have only one unanswered<br>inquiry in process at a time.<br>STATUS INQUIRY commands are not valid if the ikbd is in JOYSTICK MONITORING<br>mode or FIRE BUTTON MONITORING mode.</p>
<ol start="10">
<li>SCAN CODES</li>
</ol>
<p>The key scan codes returned by the ikbd are chosen to simplify the<br>implementation of GSX.</p>
<p>GSX Standard Keyboard Mapping.</p>
<p>Hex    Keytop<br>01    Esc<br>02    1<br>03    2<br>04    3<br>05    4<br>06    5<br>07    6<br>08    7<br>09    8<br>0A    9<br>0B    0<br>0C    -<br>0D    ==<br>0E    BS<br>0F    TAB<br>10    Q<br>11    W<br>12    E<br>13    R<br>14    T<br>15    Y<br>16    U<br>17    I<br>18    O<br>19    P<br>1A    [<br>1B    ]<br>1C    RET<br>1D    CTRL<br>1E    A<br>1F    S<br>20    D<br>21    F<br>22    G<br>23    H<br>24    J<br>25    K<br>26    L<br>27    ;<br>28    ‘<br>29    `<br>2A    (LEFT) SHIFT<br>2B    <br>2C    Z<br>2D    X<br>2E    C<br>2F    V<br>30    B<br>31    N<br>32    M<br>33    ,<br>34    .<br>35    /<br>36    (RIGHT) SHIFT<br>37    { NOT USED }<br>38    ALT<br>39    SPACE BAR<br>3A    CAPS LOCK<br>3B    F1<br>3C    F2<br>3D    F3<br>3E    F4<br>3F    F5<br>40    F6<br>41    F7<br>42    F8<br>43    F9<br>44    F10<br>45    { NOT USED }<br>46    { NOT USED }<br>47    HOME<br>48    UP ARROW<br>49    { NOT USED }<br>4A    KEYPAD -<br>4B    LEFT ARROW<br>4C    { NOT USED }<br>4D    RIGHT ARROW<br>4E    KEYPAD +<br>4F    { NOT USED }<br>50    DOWN ARROW<br>51    { NOT USED }<br>52    INSERT<br>53    DEL<br>54    { NOT USED }<br>5F    { NOT USED }<br>60    ISO KEY<br>61    UNDO<br>62    HELP<br>63    KEYPAD (<br>64    KEYPAD /<br>65    KEYPAD *<br>66    KEYPAD *<br>67    KEYPAD 7<br>68    KEYPAD 8<br>69    KEYPAD 9<br>6A    KEYPAD 4<br>6B    KEYPAD 5<br>6C    KEYPAD 6<br>6D    KEYPAD 1<br>6E    KEYPAD 2<br>6F    KEYPAD 3<br>70    KEYPAD 0<br>71    KEYPAD .<br>72    KEYPAD ENTER</p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_atarikbd/" title="Kernel-3.10.0-957.el7_atarikb" target="_blank" rel="external">http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_atarikbd/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">oosTech by Sam Lee</span><small class="ml-1x"></small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    

  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/03/13/Kernel-3.10.0-957.el7_atomic_ops/" title="Kernel-3.10.0-957.el7_atomic_ops"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/03/13/Kernel-3.10.0-957.el7_assoc_array/" title="Kernel-3.10.0-957.el7_assoc_array"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,wechat"></div>
    
  </div>
  </div>
    <div class="container" align="left">
    <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
      <img src="/images/wechatp.png" itemprop="contentUrl">
      <span>欢迎关注公众号</span>
    </div>
    </div>
</nav>

  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>您能有收获就是我们最大的动力</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码捐赠</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码捐赠</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
	<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn" text-align: center >粤ICP备2021024811号</a>
        </div>
<!--    
    <div>
     <img src="/images/logo.png" width="140" height="140">
    </div>
-->
    </div>


        <!-- 不蒜子统计    //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <!--<span id="busuanzi_container_site_pv" style="display:inline;">-->本站总访问量<span id="busuanzi_value_site_pv" style="display:inline;></span>次</span>
        <span class="post-meta-divider">|</span>
  
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>







   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>











</body>
</html>