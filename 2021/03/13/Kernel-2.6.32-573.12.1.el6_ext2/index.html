<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>Kernel-2.6.32-573.12.1.el6_ext2 | oosTech.com</title>
  <meta name="description" content="The Second Extended Filesystemext2 was originally released in January 1993.  Written by R&#39;emy Card,Theodore Ts’o and Stephen Tweedie, it was a major rewrite of theExtended Filesystem.  It is curre">
<meta property="og:type" content="article">
<meta property="og:title" content="Kernel-2.6.32-573.12.1.el6_ext2">
<meta property="og:url" content="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_ext2/index.html">
<meta property="og:site_name" content="oosTech">
<meta property="og:description" content="The Second Extended Filesystemext2 was originally released in January 1993.  Written by R&#39;emy Card,Theodore Ts’o and Stephen Tweedie, it was a major rewrite of theExtended Filesystem.  It is curre">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:modified_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:author" content="Sam Lee">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_ext2/index.html">
  
    <link rel="alternate" href="/atom.xml" title="oosTech" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img src="/images/avatar.png" width="400" height="400">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">oosTech by Sam Lee</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="站内搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">站点首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档文档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">文档分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">常用链接</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">共享白板</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告牌</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p> 欢迎来到oosTech ，我是一个Linux 拥趸：D。 目前正在用的Linux 版本是 Red Hat Enterprise Linux release 8.3 </p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">文档分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a><span class="category-list-count">830</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a><span class="category-list-count">1658</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-4-18-0-80-el8-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_4.18.0-80.el8_内核文档</a><span class="category-list-count">3937</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3270/" class="title">Kernel-3.10.0-957.el7_3270</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_devices/" class="title">Kernel-2.6.32-573.12.1.el6_devices</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3c509/" class="title">Kernel-3.10.0-957.el7_3c509</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_4CCs/" class="title">Kernel-3.10.0-957.el7_4CCs</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_53c700/" class="title">Kernel-3.10.0-957.el7_53c700</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#The-Second-Extended-Filesystem"><span class="toc-number">1.</span> <span class="toc-text">The Second Extended Filesystem</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Options"><span class="toc-number">2.</span> <span class="toc-text">Options</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Specification"><span class="toc-number">3.</span> <span class="toc-text">Specification</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Blocks"><span class="toc-number">3.1.</span> <span class="toc-text">Blocks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Block-Groups"><span class="toc-number">3.2.</span> <span class="toc-text">Block Groups</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Superblock"><span class="toc-number">3.3.</span> <span class="toc-text">The Superblock</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Inodes"><span class="toc-number">3.4.</span> <span class="toc-text">Inodes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Directories"><span class="toc-number">3.5.</span> <span class="toc-text">Directories</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Special-files"><span class="toc-number">3.6.</span> <span class="toc-text">Special files</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reserved-Space"><span class="toc-number">3.7.</span> <span class="toc-text">Reserved Space</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Filesystem-check"><span class="toc-number">3.8.</span> <span class="toc-text">Filesystem check</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Feature-Compatibility"><span class="toc-number">3.9.</span> <span class="toc-text">Feature Compatibility</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Metadata"><span class="toc-number">3.10.</span> <span class="toc-text">Metadata</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Limitations"><span class="toc-number">3.11.</span> <span class="toc-text">Limitations</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Journaling"><span class="toc-number">3.12.</span> <span class="toc-text">Journaling</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#References"><span class="toc-number">4.</span> <span class="toc-text">References</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Kernel-2.6.32-573.12.1.el6_ext2" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Kernel-2.6.32-573.12.1.el6_ext2
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_ext2/" class="article-date">
	 published: <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
	</a>
</span>

        
	<a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_ext2/" class="article-date">
	   updated: <time datetime="2021-03-12T16:00:00.000Z" itemprop="dateUpdated">2021-03-13</time>
	</a>


        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
  </span>

        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill"></i>
	    <!--<span id="busuanzi_container_page_pv" style="display:inline;">-->
			<span id="busuanzi_value_page_pv" style="display:inline;"></span>
		<!--</span>-->
	</span>



        <!--<span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_ext2/#comments" class="article-comment-link">评论</a></span> -->
        
	
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h1 id="The-Second-Extended-Filesystem"><a href="#The-Second-Extended-Filesystem" class="headerlink" title="The Second Extended Filesystem"></a>The Second Extended Filesystem</h1><p>ext2 was originally released in January 1993.  Written by R&#39;emy Card,<br>Theodore Ts’o and Stephen Tweedie, it was a major rewrite of the<br>Extended Filesystem.  It is currently still (April 2001) the predominant<br>filesystem in use by Linux.  There are also implementations available<br>for NetBSD, FreeBSD, the GNU HURD, Windows 95/98/NT, OS/2 and RISC OS.</p>
<h1 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h1><p>Most defaults are determined by the filesystem superblock, and can be<br>set using tune2fs(8). Kernel-determined defaults are indicated by (*).</p>
<p>bsddf            (*)    Makes <code>df&#39; act like BSD. minixdf                Makes </code>df’ act like Minix.</p>
<p>check=none, nocheck    (*)    Don’t do extra checking of bitmaps on mount<br>                (check=normal and check=strict options removed)</p>
<p>debug                Extra debugging information is sent to the<br>                kernel syslog.  Useful for developers.</p>
<p>errors=continue            Keep going on a filesystem error.<br>errors=remount-ro        Remount the filesystem read-only on an error.<br>errors=panic            Panic and halt the machine if an error occurs.</p>
<p>grpid, bsdgroups        Give objects the same group ID as their parent.<br>nogrpid, sysvgroups        New objects have the group ID of their creator.</p>
<p>nouid32                Use 16-bit UIDs and GIDs.</p>
<p>oldalloc            Enable the old block allocator. Orlov should<br>                have better performance, we’d like to get some<br>                feedback if it’s the contrary for you.<br>orlov            (*)    Use the Orlov block allocator.<br>                (See <a target="_blank" rel="noopener" href="http://lwn.net/Articles/14633/">http://lwn.net/Articles/14633/</a> and<br>                <a target="_blank" rel="noopener" href="http://lwn.net/Articles/14446/">http://lwn.net/Articles/14446/</a>.)</p>
<p>resuid=n            The user ID which may use the reserved blocks.<br>resgid=n            The group ID which may use the reserved blocks.</p>
<p>sb=n                Use alternate superblock at this location.</p>
<p>user_xattr            Enable “user.” POSIX Extended Attributes<br>                (requires CONFIG_EXT2_FS_XATTR).<br>                See also <a target="_blank" rel="noopener" href="http://acl.bestbits.at/">http://acl.bestbits.at</a><br>nouser_xattr            Don’t support “user.” extended attributes.</p>
<p>acl                Enable POSIX Access Control Lists support<br>                (requires CONFIG_EXT2_FS_POSIX_ACL).<br>                See also <a target="_blank" rel="noopener" href="http://acl.bestbits.at/">http://acl.bestbits.at</a><br>noacl                Don’t support POSIX ACLs.</p>
<p>nobh                Do not attach buffer_heads to file pagecache.</p>
<p>xip                Use execute in place (no caching) if possible</p>
<p>grpquota,noquota,quota,usrquota    Quota options are silently ignored by ext2.</p>
<h1 id="Specification"><a href="#Specification" class="headerlink" title="Specification"></a>Specification</h1><p>ext2 shares many properties with traditional Unix filesystems.  It has<br>the concepts of blocks, inodes and directories.  It has space in the<br>specification for Access Control Lists (ACLs), fragments, undeletion and<br>compression though these are not yet implemented (some are available as<br>separate patches).  There is also a versioning mechanism to allow new<br>features (such as journalling) to be added in a maximally compatible<br>manner.</p>
<h2 id="Blocks"><a href="#Blocks" class="headerlink" title="Blocks"></a>Blocks</h2><p>The space in the device or file is split up into blocks.  These are<br>a fixed size, of 1024, 2048 or 4096 bytes (8192 bytes on Alpha systems),<br>which is decided when the filesystem is created.  Smaller blocks mean<br>less wasted space per file, but require slightly more accounting overhead,<br>and also impose other limits on the size of files and the filesystem.</p>
<h2 id="Block-Groups"><a href="#Block-Groups" class="headerlink" title="Block Groups"></a>Block Groups</h2><p>Blocks are clustered into block groups in order to reduce fragmentation<br>and minimise the amount of head seeking when reading a large amount<br>of consecutive data.  Information about each block group is kept in a<br>descriptor table stored in the block(s) immediately after the superblock.<br>Two blocks near the start of each group are reserved for the block usage<br>bitmap and the inode usage bitmap which show which blocks and inodes<br>are in use.  Since each bitmap is limited to a single block, this means<br>that the maximum size of a block group is 8 times the size of a block.</p>
<p>The block(s) following the bitmaps in each block group are designated<br>as the inode table for that block group and the remainder are the data<br>blocks.  The block allocation algorithm attempts to allocate data blocks<br>in the same block group as the inode which contains them.</p>
<h2 id="The-Superblock"><a href="#The-Superblock" class="headerlink" title="The Superblock"></a>The Superblock</h2><p>The superblock contains all the information about the configuration of<br>the filing system.  The primary copy of the superblock is stored at an<br>offset of 1024 bytes from the start of the device, and it is essential<br>to mounting the filesystem.  Since it is so important, backup copies of<br>the superblock are stored in block groups throughout the filesystem.<br>The first version of ext2 (revision 0) stores a copy at the start of<br>every block group, along with backups of the group descriptor block(s).<br>Because this can consume a considerable amount of space for large<br>filesystems, later revisions can optionally reduce the number of backup<br>copies by only putting backups in specific groups (this is the sparse<br>superblock feature).  The groups chosen are 0, 1 and powers of 3, 5 and 7.</p>
<p>The information in the superblock contains fields such as the total<br>number of inodes and blocks in the filesystem and how many are free,<br>how many inodes and blocks are in each block group, when the filesystem<br>was mounted (and if it was cleanly unmounted), when it was modified,<br>what version of the filesystem it is (see the Revisions section below)<br>and which OS created it.</p>
<p>If the filesystem is revision 1 or higher, then there are extra fields,<br>such as a volume name, a unique identification number, the inode size,<br>and space for optional filesystem features to store configuration info.</p>
<p>All fields in the superblock (as in all other ext2 structures) are stored<br>on the disc in little endian format, so a filesystem is portable between<br>machines without having to know what machine it was created on.</p>
<h2 id="Inodes"><a href="#Inodes" class="headerlink" title="Inodes"></a>Inodes</h2><p>The inode (index node) is a fundamental concept in the ext2 filesystem.<br>Each object in the filesystem is represented by an inode.  The inode<br>structure contains pointers to the filesystem blocks which contain the<br>data held in the object and all of the metadata about an object except<br>its name.  The metadata about an object includes the permissions, owner,<br>group, flags, size, number of blocks used, access time, change time,<br>modification time, deletion time, number of links, fragments, version<br>(for NFS) and extended attributes (EAs) and/or Access Control Lists (ACLs).</p>
<p>There are some reserved fields which are currently unused in the inode<br>structure and several which are overloaded.  One field is reserved for the<br>directory ACL if the inode is a directory and alternately for the top 32<br>bits of the file size if the inode is a regular file (allowing file sizes<br>larger than 2GB).  The translator field is unused under Linux, but is used<br>by the HURD to reference the inode of a program which will be used to<br>interpret this object.  Most of the remaining reserved fields have been<br>used up for both Linux and the HURD for larger owner and group fields,<br>The HURD also has a larger mode field so it uses another of the remaining<br>fields to store the extra more bits.</p>
<p>There are pointers to the first 12 blocks which contain the file’s data<br>in the inode.  There is a pointer to an indirect block (which contains<br>pointers to the next set of blocks), a pointer to a doubly-indirect<br>block (which contains pointers to indirect blocks) and a pointer to a<br>trebly-indirect block (which contains pointers to doubly-indirect blocks).</p>
<p>The flags field contains some ext2-specific flags which aren’t catered<br>for by the standard chmod flags.  These flags can be listed with lsattr<br>and changed with the chattr command, and allow specific filesystem<br>behaviour on a per-file basis.  There are flags for secure deletion,<br>undeletable, compression, synchronous updates, immutability, append-only,<br>dumpable, no-atime, indexed directories, and data-journaling.  Not all<br>of these are supported yet.</p>
<h2 id="Directories"><a href="#Directories" class="headerlink" title="Directories"></a>Directories</h2><p>A directory is a filesystem object and has an inode just like a file.<br>It is a specially formatted file containing records which associate<br>each name with an inode number.  Later revisions of the filesystem also<br>encode the type of the object (file, directory, symlink, device, fifo,<br>socket) to avoid the need to check the inode itself for this information<br>(support for taking advantage of this feature does not yet exist in<br>Glibc 2.2).</p>
<p>The inode allocation code tries to assign inodes which are in the same<br>block group as the directory in which they are first created.</p>
<p>The current implementation of ext2 uses a singly-linked list to store<br>the filenames in the directory; a pending enhancement uses hashing of the<br>filenames to allow lookup without the need to scan the entire directory.</p>
<p>The current implementation never removes empty directory blocks once they<br>have been allocated to hold more files.</p>
<h2 id="Special-files"><a href="#Special-files" class="headerlink" title="Special files"></a>Special files</h2><p>Symbolic links are also filesystem objects with inodes.  They deserve<br>special mention because the data for them is stored within the inode<br>itself if the symlink is less than 60 bytes long.  It uses the fields<br>which would normally be used to store the pointers to data blocks.<br>This is a worthwhile optimisation as it we avoid allocating a full<br>block for the symlink, and most symlinks are less than 60 characters long.</p>
<p>Character and block special devices never have data blocks assigned to<br>them.  Instead, their device number is stored in the inode, again reusing<br>the fields which would be used to point to the data blocks.</p>
<h2 id="Reserved-Space"><a href="#Reserved-Space" class="headerlink" title="Reserved Space"></a>Reserved Space</h2><p>In ext2, there is a mechanism for reserving a certain number of blocks<br>for a particular user (normally the super-user).  This is intended to<br>allow for the system to continue functioning even if non-privileged users<br>fill up all the space available to them (this is independent of filesystem<br>quotas).  It also keeps the filesystem from filling up entirely which<br>helps combat fragmentation.</p>
<h2 id="Filesystem-check"><a href="#Filesystem-check" class="headerlink" title="Filesystem check"></a>Filesystem check</h2><p>At boot time, most systems run a consistency check (e2fsck) on their<br>filesystems.  The superblock of the ext2 filesystem contains several<br>fields which indicate whether fsck should actually run (since checking<br>the filesystem at boot can take a long time if it is large).  fsck will<br>run if the filesystem was not cleanly unmounted, if the maximum mount<br>count has been exceeded or if the maximum time between checks has been<br>exceeded.</p>
<h2 id="Feature-Compatibility"><a href="#Feature-Compatibility" class="headerlink" title="Feature Compatibility"></a>Feature Compatibility</h2><p>The compatibility feature mechanism used in ext2 is sophisticated.<br>It safely allows features to be added to the filesystem, without<br>unnecessarily sacrificing compatibility with older versions of the<br>filesystem code.  The feature compatibility mechanism is not supported by<br>the original revision 0 (EXT2_GOOD_OLD_REV) of ext2, but was introduced in<br>revision 1.  There are three 32-bit fields, one for compatible features<br>(COMPAT), one for read-only compatible (RO_COMPAT) features and one for<br>incompatible (INCOMPAT) features.</p>
<p>These feature flags have specific meanings for the kernel as follows:</p>
<p>A COMPAT flag indicates that a feature is present in the filesystem,<br>but the on-disk format is 100% compatible with older on-disk formats, so<br>a kernel which didn’t know anything about this feature could read/write<br>the filesystem without any chance of corrupting the filesystem (or even<br>making it inconsistent).  This is essentially just a flag which says<br>“this filesystem has a (hidden) feature” that the kernel or e2fsck may<br>want to be aware of (more on e2fsck and feature flags later).  The ext3<br>HAS_JOURNAL feature is a COMPAT flag because the ext3 journal is simply<br>a regular file with data blocks in it so the kernel does not need to<br>take any special notice of it if it doesn’t understand ext3 journaling.</p>
<p>An RO_COMPAT flag indicates that the on-disk format is 100% compatible<br>with older on-disk formats for reading (i.e. the feature does not change<br>the visible on-disk format).  However, an old kernel writing to such a<br>filesystem would/could corrupt the filesystem, so this is prevented. The<br>most common such feature, SPARSE_SUPER, is an RO_COMPAT feature because<br>sparse groups allow file data blocks where superblock/group descriptor<br>backups used to live, and ext2_free_blocks() refuses to free these blocks,<br>which would leading to inconsistent bitmaps.  An old kernel would also<br>get an error if it tried to free a series of blocks which crossed a group<br>boundary, but this is a legitimate layout in a SPARSE_SUPER filesystem.</p>
<p>An INCOMPAT flag indicates the on-disk format has changed in some<br>way that makes it unreadable by older kernels, or would otherwise<br>cause a problem if an old kernel tried to mount it.  FILETYPE is an<br>INCOMPAT flag because older kernels would think a filename was longer<br>than 256 characters, which would lead to corrupt directory listings.<br>The COMPRESSION flag is an obvious INCOMPAT flag - if the kernel<br>doesn’t understand compression, you would just get garbage back from<br>read() instead of it automatically decompressing your data.  The ext3<br>RECOVER flag is needed to prevent a kernel which does not understand the<br>ext3 journal from mounting the filesystem without replaying the journal.</p>
<p>For e2fsck, it needs to be more strict with the handling of these<br>flags than the kernel.  If it doesn’t understand ANY of the COMPAT,<br>RO_COMPAT, or INCOMPAT flags it will refuse to check the filesystem,<br>because it has no way of verifying whether a given feature is valid<br>or not.  Allowing e2fsck to succeed on a filesystem with an unknown<br>feature is a false sense of security for the user.  Refusing to check<br>a filesystem with unknown features is a good incentive for the user to<br>update to the latest e2fsck.  This also means that anyone adding feature<br>flags to ext2 also needs to update e2fsck to verify these features.</p>
<h2 id="Metadata"><a href="#Metadata" class="headerlink" title="Metadata"></a>Metadata</h2><p>It is frequently claimed that the ext2 implementation of writing<br>asynchronous metadata is faster than the ffs synchronous metadata<br>scheme but less reliable.  Both methods are equally resolvable by their<br>respective fsck programs.</p>
<p>If you’re exceptionally paranoid, there are 3 ways of making metadata<br>writes synchronous on ext2:</p>
<p>per-file if you have the program source: use the O_SYNC flag to open()<br>per-file if you don’t have the source: use “chattr +S” on the file<br>per-filesystem: add the “sync” option to mount (or in /etc/fstab)</p>
<p>the first and last are not ext2 specific but do force the metadata to<br>be written synchronously.  See also Journaling below.</p>
<h2 id="Limitations"><a href="#Limitations" class="headerlink" title="Limitations"></a>Limitations</h2><p>There are various limits imposed by the on-disk layout of ext2.  Other<br>limits are imposed by the current implementation of the kernel code.<br>Many of the limits are determined at the time the filesystem is first<br>created, and depend upon the block size chosen.  The ratio of inodes to<br>data blocks is fixed at filesystem creation time, so the only way to<br>increase the number of inodes is to increase the size of the filesystem.<br>No tools currently exist which can change the ratio of inodes to blocks.</p>
<p>Most of these limits could be overcome with slight changes in the on-disk<br>format and using a compatibility flag to signal the format change (at<br>the expense of some compatibility).</p>
<p>Filesystem block size:     1kB        2kB        4kB        8kB</p>
<p>File size limit:          16GB      256GB     2048GB     2048GB<br>Filesystem size limit:  2047GB     8192GB    16384GB    32768GB</p>
<p>There is a 2.4 kernel limit of 2048GB for a single block device, so no<br>filesystem larger than that can be created at this time.  There is also<br>an upper limit on the block size imposed by the page size of the kernel,<br>so 8kB blocks are only allowed on Alpha systems (and other architectures<br>which support larger pages).</p>
<p>There is an upper limit of 32000 subdirectories in a single directory.</p>
<p>There is a “soft” upper limit of about 10-15k files in a single directory<br>with the current linear linked-list directory implementation.  This limit<br>stems from performance problems when creating and deleting (and also<br>finding) files in such large directories.  Using a hashed directory index<br>(under development) allows 100k-1M+ files in a single directory without<br>performance problems (although RAM size becomes an issue at this point).</p>
<p>The (meaningless) absolute upper limit of files in a single directory<br>(imposed by the file size, the realistic limit is obviously much less)<br>is over 130 trillion files.  It would be higher except there are not<br>enough 4-character names to make up unique directory entries, so they<br>have to be 8 character filenames, even then we are fairly close to<br>running out of unique filenames.</p>
<h2 id="Journaling"><a href="#Journaling" class="headerlink" title="Journaling"></a>Journaling</h2><p>A journaling extension to the ext2 code has been developed by Stephen<br>Tweedie.  It avoids the risks of metadata corruption and the need to<br>wait for e2fsck to complete after a crash, without requiring a change<br>to the on-disk ext2 layout.  In a nutshell, the journal is a regular<br>file which stores whole metadata (and optionally data) blocks that have<br>been modified, prior to writing them into the filesystem.  This means<br>it is possible to add a journal to an existing ext2 filesystem without<br>the need for data conversion.</p>
<p>When changes to the filesystem (e.g. a file is renamed) they are stored in<br>a transaction in the journal and can either be complete or incomplete at<br>the time of a crash.  If a transaction is complete at the time of a crash<br>(or in the normal case where the system does not crash), then any blocks<br>in that transaction are guaranteed to represent a valid filesystem state,<br>and are copied into the filesystem.  If a transaction is incomplete at<br>the time of the crash, then there is no guarantee of consistency for<br>the blocks in that transaction so they are discarded (which means any<br>filesystem changes they represent are also lost).<br>Check Documentation/filesystems/ext3.txt if you want to read more about<br>ext3 and journaling.</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><p>The kernel source    file:/usr/src/linux/fs/ext2/<br>e2fsprogs (e2fsck)    <a target="_blank" rel="noopener" href="http://e2fsprogs.sourceforge.net/">http://e2fsprogs.sourceforge.net/</a><br>Design &amp; Implementation    <a target="_blank" rel="noopener" href="http://e2fsprogs.sourceforge.net/ext2intro.html">http://e2fsprogs.sourceforge.net/ext2intro.html</a><br>Journaling (ext3)    <a href="ftp://ftp.uk.linux.org/pub/linux/sct/fs/jfs/">ftp://ftp.uk.linux.org/pub/linux/sct/fs/jfs/</a><br>Filesystem Resizing    <a target="_blank" rel="noopener" href="http://ext2resize.sourceforge.net/">http://ext2resize.sourceforge.net/</a><br>Compression (*)        <a target="_blank" rel="noopener" href="http://e2compr.sourceforge.net/">http://e2compr.sourceforge.net/</a></p>
<p>Implementations for:<br>Windows 95/98/NT/2000    <a target="_blank" rel="noopener" href="http://www.chrysocome.net/explore2fs">http://www.chrysocome.net/explore2fs</a><br>Windows 95 (<em>)        <a target="_blank" rel="noopener" href="http://www.yipton.net/content.html#FSDEXT2">http://www.yipton.net/content.html#FSDEXT2</a><br>DOS client (</em>)        <a href="ftp://metalab.unc.edu/pub/Linux/system/filesystems/ext2/">ftp://metalab.unc.edu/pub/Linux/system/filesystems/ext2/</a><br>OS/2 (+)        <a href="ftp://metalab.unc.edu/pub/Linux/system/filesystems/ext2/">ftp://metalab.unc.edu/pub/Linux/system/filesystems/ext2/</a><br>RISC OS client        <a target="_blank" rel="noopener" href="http://www.esw-heim.tu-clausthal.de/~marco/smorbrod/IscaFS/">http://www.esw-heim.tu-clausthal.de/~marco/smorbrod/IscaFS/</a></p>
<p>(*) no longer actively developed/supported (as of Apr 2001)<br>(+) no longer actively developed/supported (as of Mar 2009)</p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_ext2/" title="Kernel-2.6.32-573.12.1.el6_ext2" target="_blank" rel="external">http://www.oostech.com/2021/03/13/Kernel-2.6.32-573.12.1.el6_ext2/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">oosTech by Sam Lee</span><small class="ml-1x"></small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    

  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_ext4/" title="Kernel-2.6.32-573.12.1.el6_ext4"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_err_inject/" title="Kernel-2.6.32-573.12.1.el6_err_inject"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,wechat"></div>
    
  </div>
  </div>
    <div class="container" align="left">
    <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
      <img src="/images/wechatp.png" itemprop="contentUrl">
      <span>欢迎关注公众号</span>
    </div>
    </div>
</nav>

  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>您能有收获就是我们最大的动力</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码捐赠</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码捐赠</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
	<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn" text-align: center >粤ICP备2021024811号</a>
        </div>
<!--    
    <div>
     <img src="/images/logo.png" width="140" height="140">
    </div>
-->
    </div>


        <!-- 不蒜子统计    //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <!--<span id="busuanzi_container_site_pv" style="display:inline;">-->本站总访问量<span id="busuanzi_value_site_pv" style="display:inline;></span>次</span>
        <span class="post-meta-divider">|</span>
  
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>







   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>











</body>
</html>