<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>Kernel-3.10.0-957.el7_sym53c8xx_2 | oosTech.com</title>
  <meta name="description" content="The Linux SYM-2 driver documentation file Written by Gerard Roudier &amp;#103;&amp;#x72;&amp;#x6f;&amp;#117;&amp;#x64;&amp;#105;&amp;#101;&amp;#x72;&amp;#x40;&amp;#102;&amp;#x72;&amp;#x65;&amp;#x65;&amp;#46;&amp;#102;&amp;#114;21 Rue Carnot95170 DEUIL LA BARRE - F">
<meta property="og:type" content="article">
<meta property="og:title" content="Kernel-3.10.0-957.el7_sym53c8xx_2">
<meta property="og:url" content="http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_sym53c8xx_2/index.html">
<meta property="og:site_name" content="oosTech">
<meta property="og:description" content="The Linux SYM-2 driver documentation file Written by Gerard Roudier &amp;#103;&amp;#x72;&amp;#x6f;&amp;#117;&amp;#x64;&amp;#105;&amp;#101;&amp;#x72;&amp;#x40;&amp;#102;&amp;#x72;&amp;#x65;&amp;#x65;&amp;#46;&amp;#102;&amp;#114;21 Rue Carnot95170 DEUIL LA BARRE - F">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:modified_time" content="2021-03-12T16:00:00.000Z">
<meta property="article:author" content="Sam Lee">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_sym53c8xx_2/index.html">
  
    <link rel="alternate" href="/atom.xml" title="oosTech" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img src="/images/avatar.png" width="400" height="400">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">oosTech by Sam Lee</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="站内搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">站点首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档文档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">文档分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">常用链接</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">共享白板</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告牌</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p> 欢迎来到oosTech ，我是一个Linux 拥趸：D。 目前正在用的Linux 版本是 Red Hat Enterprise Linux release 8.3 </p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">文档分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a><span class="category-list-count">830</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a><span class="category-list-count">1658</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-4-18-0-80-el8-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_4.18.0-80.el8_内核文档</a><span class="category-list-count">3937</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3270/" class="title">Kernel-3.10.0-957.el7_3270</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-2-6-32-573-12-1-el6-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_2.6.32-573.12.1.el6_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-2.6.32-573.12.1.el6_devices/" class="title">Kernel-2.6.32-573.12.1.el6_devices</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_3c509/" class="title">Kernel-3.10.0-957.el7_3c509</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_4CCs/" class="title">Kernel-3.10.0-957.el7_4CCs</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/13/Kernel-3.10.0-957.el7_53c700/" class="title">Kernel-3.10.0-957.el7_53c700</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#2004-10-09"><span class="toc-number">1.</span> <span class="toc-text">2004-10-09</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#typical-data-at-NVRAM-address-0x100-53c810a-NVRAM"><span class="toc-number">1.1.</span> <span class="toc-text">typical data at NVRAM address 0x100 (53c810a NVRAM)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#default-set-up-is-identical-for-53c810a-and-53c875-NVRAM"><span class="toc-number">1.2.</span> <span class="toc-text">default set up is identical for 53c810a and 53c875 NVRAM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#default-set-up-is-identical-for-53c810a-and-53c875-NVRAM-1"><span class="toc-number">1.3.</span> <span class="toc-text">default set up is identical for 53c810a and 53c875 NVRAM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#default-set-up-is-identical-for-53c810a-and-53c875-NVRAM-2"><span class="toc-number">1.4.</span> <span class="toc-text">default set up is identical for 53c810a and 53c875 NVRAM</span></a></li></ol></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Kernel-3.10.0-957.el7_sym53c8xx_2" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      Kernel-3.10.0-957.el7_sym53c8xx_2
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/03/13/Kernel-3.10.0-957.el7_sym53c8xx_2/" class="article-date">
	 published: <time datetime="2021-03-12T16:00:00.000Z" itemprop="datePublished">2021-03-13</time>
	</a>
</span>

        
	<a href="/2021/03/13/Kernel-3.10.0-957.el7_sym53c8xx_2/" class="article-date">
	   updated: <time datetime="2021-03-12T16:00:00.000Z" itemprop="dateUpdated">2021-03-13</time>
	</a>


        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Kernel-3-10-0-957-el7-%E5%86%85%E6%A0%B8%E6%96%87%E6%A1%A3/">Kernel_3.10.0-957.el7_内核文档</a>
  </span>

        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill"></i>
	    <!--<span id="busuanzi_container_page_pv" style="display:inline;">-->
			<span id="busuanzi_value_page_pv" style="display:inline;"></span>
		<!--</span>-->
	</span>



        <!--<span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/03/13/Kernel-3.10.0-957.el7_sym53c8xx_2/#comments" class="article-comment-link">评论</a></span> -->
        
	
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p>The Linux SYM-2 driver documentation file</p>
<p>Written by Gerard Roudier <a href="mailto:&#103;&#x72;&#x6f;&#117;&#x64;&#105;&#101;&#x72;&#x40;&#102;&#x72;&#x65;&#x65;&#46;&#102;&#114;">&#103;&#x72;&#x6f;&#117;&#x64;&#105;&#101;&#x72;&#x40;&#102;&#x72;&#x65;&#x65;&#46;&#102;&#114;</a><br>21 Rue Carnot<br>95170 DEUIL LA BARRE - FRANCE</p>
<p>Updated by Matthew Wilcox <a href="mailto:&#x6d;&#97;&#x74;&#x74;&#104;&#101;&#119;&#64;&#x77;&#x69;&#x6c;&#x2e;&#x63;&#x78;">&#x6d;&#97;&#x74;&#x74;&#104;&#101;&#119;&#64;&#x77;&#x69;&#x6c;&#x2e;&#x63;&#x78;</a></p>
<h1 id="2004-10-09"><a href="#2004-10-09" class="headerlink" title="2004-10-09"></a>2004-10-09</h1><ol>
<li> Introduction</li>
<li> Supported chips and SCSI features</li>
<li>Advantages of this driver for newer chips.<br>   3.1 Optimized SCSI SCRIPTS<br>   3.2 New features appeared with the SYM53C896</li>
<li> Memory mapped I/O versus normal I/O</li>
<li> Tagged command queueing</li>
<li> Parity checking</li>
<li> Profiling information</li>
<li>Control commands<br>   8.1  Set minimum synchronous period<br>   8.2  Set wide size<br>   8.3  Set maximum number of concurrent tagged commands<br>   8.4  Set debug mode<br>   8.5  Set flag (no_disc)<br>   8.6  Set verbose level<br>   8.7  Reset all logical units of a target<br>   8.8  Abort all tasks of all logical units of a target</li>
<li> Configuration parameters</li>
<li>Boot setup commands<br>  10.1 Syntax<br>  10.2 Available arguments<pre><code>     10.2.1  Default number of tagged commands
     10.2.2  Burst max
     10.2.3  LED support
     10.2.4  Differential mode
     10.2.5  IRQ mode
     10.2.6  Check SCSI BUS 
     10.2.7  Suggest a default SCSI id for hosts
     10.2.8  Verbosity level
     10.2.9  Debug mode
     10.2.10 Settle delay
     10.2.11 Serial NVRAM
     10.2.12 Exclude a host from being attached
</code></pre>
  10.3 Converting from old options<br>  10.4 SCSI BUS checking boot option</li>
<li>SCSI problem troubleshooting<br>  15.1 Problem tracking<br>  15.2 Understanding hardware error reports</li>
<li>Serial NVRAM support (by Richard Waltham)<br>  17.1 Features<br>  17.2 Symbios NVRAM layout<br>  17.3 Tekram  NVRAM layout</li>
</ol>
<p>===============================================================================</p>
<ol>
<li>Introduction</li>
</ol>
<p>This driver supports the whole SYM53C8XX family of PCI-SCSI controllers.<br>It also support the subset of LSI53C10XX PCI-SCSI controllers that are based<br>on the SYM53C8XX SCRIPTS language.</p>
<p>It replaces the sym53c8xx+ncr53c8xx driver bundle and shares its core code<br>with the FreeBSD SYM-2 driver. The `glue’ that allows this driver to work<br>under Linux is contained in 2 files named sym_glue.h and sym_glue.c.<br>Other drivers files are intended not to depend on the Operating System<br>on which the driver is used.</p>
<p>The history of this driver can be summarized as follows:</p>
<p>1993: ncr driver written for 386bsd and FreeBSD by:<br>          Wolfgang Stanglmeier        <a href="mailto:&#119;&#111;&#108;&#102;&#64;&#99;&#111;&#x6c;&#x6f;&#x67;&#110;&#101;&#46;&#x64;&#x65;">&#119;&#111;&#108;&#102;&#64;&#99;&#111;&#x6c;&#x6f;&#x67;&#110;&#101;&#46;&#x64;&#x65;</a><br>          Stefan Esser                <a href="mailto:&#x73;&#x65;&#64;&#x6d;&#x69;&#46;&#85;&#x6e;&#x69;&#x2d;&#x4b;&#111;&#x65;&#x6c;&#110;&#46;&#x64;&#101;">&#x73;&#x65;&#64;&#x6d;&#x69;&#46;&#85;&#x6e;&#x69;&#x2d;&#x4b;&#111;&#x65;&#x6c;&#110;&#46;&#x64;&#101;</a></p>
<p>1996: port of the ncr driver to Linux-1.2.13 and rename it ncr53c8xx.<br>          Gerard Roudier</p>
<p>1998: new sym53c8xx driver for Linux based on LOAD/STORE instruction and that<br>      adds full support for the 896 but drops support for early NCR devices.<br>          Gerard Roudier</p>
<p>1999: port of the sym53c8xx driver to FreeBSD and support for the LSI53C1010<br>      33 MHz and 66MHz Ultra-3 controllers. The new driver is named `sym’.<br>          Gerard Roudier</p>
<p>2000: Add support for early NCR devices to FreeBSD `sym’ driver.<br>      Break the driver into several sources and separate the OS glue<br>      code from the core code that can be shared among different O/Ses.<br>      Write a glue code for Linux.<br>          Gerard Roudier</p>
<p>2004: Remove FreeBSD compatibility code.  Remove support for versions of<br>      Linux before 2.6.  Start using Linux facilities.</p>
<p>This README file addresses the Linux version of the driver. Under FreeBSD,<br>the driver documentation is the sym.8 man page.</p>
<p>Information about new chips is available at LSILOGIC web server:</p>
<pre><code>      http://www.lsilogic.com/
</code></pre>
<p>SCSI standard documentations are available at T10 site:</p>
<pre><code>      http://www.t10.org/
</code></pre>
<p>Useful SCSI tools written by Eric Youngdale are part of most Linux<br>distributions:<br>   scsiinfo:    command line tool<br>   scsi-config: TCL/Tk tool using scsiinfo</p>
<ol start="2">
<li>Supported chips and SCSI features</li>
</ol>
<p>The following features are supported for all chips:</p>
<pre><code>Synchronous negotiation
Disconnection
Tagged command queuing
SCSI parity checking
PCI Master parity checking
</code></pre>
<p>Other features depends on chip capabilities.<br>The driver notably uses optimized SCRIPTS for devices that support<br>LOAD/STORE and handles PHASE MISMATCH from SCRIPTS for devices that<br>support the corresponding feature.</p>
<p>The following table shows some characteristics of the chip family.</p>
<pre><code>   On board                                   LOAD/STORE   HARDWARE
</code></pre>
<p>Chip   SDMS BIOS   Wide   SCSI std.   Max. sync   SCRIPTS      PHASE MISMATCH</p>
<hr>
<p>810        N         N      FAST10    10 MB/s        N             N<br>810A       N         N      FAST10    10 MB/s        Y             N<br>815        Y         N      FAST10    10 MB/s        N             N<br>825        Y         Y      FAST10    20 MB/s        N             N<br>825A       Y         Y      FAST10    20 MB/s        Y             N<br>860        N         N      FAST20    20 MB/s        Y             N<br>875        Y         Y      FAST20    40 MB/s        Y             N<br>875A       Y         Y      FAST20    40 MB/s        Y             Y<br>876        Y         Y      FAST20    40 MB/s        Y             N<br>895        Y         Y      FAST40    80 MB/s        Y             N<br>895A       Y         Y      FAST40    80 MB/s        Y             Y<br>896        Y         Y      FAST40    80 MB/s        Y             Y<br>897        Y         Y      FAST40    80 MB/s        Y             Y<br>1510D      Y         Y      FAST40    80 MB/s        Y             Y<br>1010       Y         Y      FAST80   160 MB/s        Y             Y<br>1010_66*   Y         Y      FAST80   160 MB/s        Y             Y</p>
<ul>
<li>Chip supports 33MHz and 66MHz PCI bus clock.</li>
</ul>
<p>Summary of other supported features:</p>
<p>Module:                allow to load the driver<br>Memory mapped I/O:     increases performance<br>Control commands:      write operations to the proc SCSI file system<br>Debugging information: written to syslog (expert only)<br>Scatter / gather<br>Shared interrupt<br>Boot setup commands<br>Serial NVRAM:          Symbios and Tekram formats</p>
<ol start="3">
<li>Advantages of this driver for newer chips.</li>
</ol>
<p>3.1 Optimized SCSI SCRIPTS.</p>
<p>All chips except the 810, 815 and 825, support new SCSI SCRIPTS instructions<br>named LOAD and STORE that allow to move up to 1 DWORD from/to an IO register<br>to/from memory much faster that the MOVE MEMORY instruction that is supported<br>by the 53c7xx and 53c8xx family.</p>
<p>The LOAD/STORE instructions support absolute and DSA relative addressing<br>modes. The SCSI SCRIPTS had been entirely rewritten using LOAD/STORE instead<br>of MOVE MEMORY instructions.</p>
<p>Due to the lack of LOAD/STORE SCRIPTS instructions by earlier chips, this<br>driver also incorporates a different SCRIPTS set based on MEMORY MOVE, in<br>order to provide support for the entire SYM53C8XX chips family.</p>
<p>3.2 New features appeared with the SYM53C896</p>
<p>Newer chips (see above) allows handling of the phase mismatch context from<br>SCRIPTS (avoids the phase mismatch interrupt that stops the SCSI processor<br>until the C code has saved the context of the transfer).</p>
<p>The 896 and 1010 chips support 64 bit PCI transactions and addressing,<br>while the 895A supports 32 bit PCI transactions and 64 bit addressing.<br>The SCRIPTS processor of these chips is not true 64 bit, but uses segment<br>registers for bit 32-63. Another interesting feature is that LOAD/STORE<br>instructions that address the on-chip RAM (8k) remain internal to the chip.</p>
<ol start="4">
<li>Memory mapped I/O versus normal I/O</li>
</ol>
<p>Memory mapped I/O has less latency than normal I/O and is the recommended<br>way for doing IO with PCI devices. Memory mapped I/O seems to work fine on<br>most hardware configurations, but some poorly designed chipsets may break<br>this feature. A configuration option is provided for normal I/O to be<br>used but the driver defaults to MMIO.</p>
<ol start="5">
<li>Tagged command queueing</li>
</ol>
<p>Queuing more than 1 command at a time to a device allows it to perform<br>optimizations based on actual head positions and its mechanical<br>characteristics. This feature may also reduce average command latency.<br>In order to really gain advantage of this feature, devices must have<br>a reasonable cache size (No miracle is to be expected for a low-end<br>hard disk with 128 KB or less).<br>Some known old SCSI devices do not properly support tagged command queuing.<br>Generally, firmware revisions that fix this kind of problems are available<br>at respective vendor web/ftp sites.<br>All I can say is that I never have had problem with tagged queuing using<br>this driver and its predecessors. Hard disks that behaved correctly for<br>me using tagged commands are the following:</p>
<ul>
<li>IBM S12 0662</li>
<li>Conner 1080S</li>
<li>Quantum Atlas I</li>
<li>Quantum Atlas II</li>
<li>Seagate Cheetah I</li>
<li>Quantum Viking II</li>
<li>IBM DRVS</li>
<li>Quantum Atlas IV</li>
<li>Seagate Cheetah II</li>
</ul>
<p>If your controller has NVRAM, you can configure this feature per target<br>from the user setup tool. The Tekram Setup program allows to tune the<br>maximum number of queued commands up to 32. The Symbios Setup only allows<br>to enable or disable this feature.</p>
<p>The maximum number of simultaneous tagged commands queued to a device<br>is currently set to 16 by default.  This value is suitable for most SCSI<br>disks.  With large SCSI disks (&gt;= 2GB, cache &gt;= 512KB, average seek time<br>&lt;= 10 ms), using a larger value may give better performances.</p>
<p>This driver supports up to 255 commands per device, and but using more than<br>64 is generally not worth-while, unless you are using a very large disk or<br>disk arrays. It is noticeable that most of recent hard disks seem not to<br>accept more than 64 simultaneous commands. So, using more than 64 queued<br>commands is probably just resource wasting.</p>
<p>If your controller does not have NVRAM or if it is managed by the SDMS<br>BIOS/SETUP, you can configure tagged queueing feature and device queue<br>depths from the boot command-line. For example:</p>
<p>  sym53c8xx=tags:4/t2t3q15-t4q7/t1u0q32</p>
<p>will set tagged commands queue depths as follow:</p>
<ul>
<li>target 2  all luns  on controller 0 –&gt; 15</li>
<li>target 3  all luns  on controller 0 –&gt; 15</li>
<li>target 4  all luns  on controller 0 –&gt;  7</li>
<li>target 1  lun 0     on controller 1 –&gt; 32</li>
<li>all other target/lun                –&gt;  4</li>
</ul>
<p>In some special conditions, some SCSI disk firmwares may return a<br>QUEUE FULL status for a SCSI command. This behaviour is managed by the<br>driver using the following heuristic:</p>
<ul>
<li><p>Each time a QUEUE FULL status is returned, tagged queue depth is reduced<br>to the actual number of disconnected commands. </p>
</li>
<li><p>Every 200 successfully completed SCSI commands, if allowed by the<br>current limit, the maximum number of queueable commands is incremented.</p>
</li>
</ul>
<p>Since QUEUE FULL status reception and handling is resource wasting, the<br>driver notifies by default this problem to user by indicating the actual<br>number of commands used and their status, as well as its decision on the<br>device queue depth change.<br>The heuristic used by the driver in handling QUEUE FULL ensures that the<br>impact on performances is not too bad. You can get rid of the messages by<br>setting verbose level to zero, as follow:</p>
<p>1st method: boot your system using ‘sym53c8xx=verb:0’ option.<br>2nd method: apply “setverbose 0” control command to the proc fs entry<br>            corresponding to your controller after boot-up.</p>
<ol start="6">
<li>Parity checking</li>
</ol>
<p>The driver supports SCSI parity checking and PCI bus master parity<br>checking.  These features must be enabled in order to ensure safe<br>data transfers.  Some flawed devices or mother boards may have problems<br>with parity.  The options to defeat parity checking have been removed<br>from the driver.</p>
<ol start="7">
<li>Profiling information</li>
</ol>
<p>This driver does not provide profiling information as did its predecessors.<br>This feature was not this useful and added complexity to the code.<br>As the driver code got more complex, I have decided to remove everything<br>that didn’t seem actually useful.</p>
<ol start="8">
<li>Control commands</li>
</ol>
<p>Control commands can be sent to the driver with write operations to<br>the proc SCSI file system. The generic command syntax is the<br>following:</p>
<pre><code>  echo &quot;&lt;verb&gt; &lt;parameters&gt;&quot; &gt;/proc/scsi/sym53c8xx/0
  (assumes controller number is 0)
</code></pre>
<p>Using “all” for “<target>“ parameter with the commands below will<br>apply to all targets of the SCSI chain (except the controller).</p>
<p>Available commands:</p>
<p>8.1 Set minimum synchronous period factor</p>
<pre><code>setsync &lt;target&gt; &lt;period factor&gt;

target:    target number
period:    minimum synchronous period.
           Maximum speed = 1000/(4*period factor) except for special
           cases below.

Specify a period of 0, to force asynchronous transfer mode.

   9 means 12.5 nano-seconds synchronous period
  10 means 25 nano-seconds synchronous period
  11 means 30 nano-seconds synchronous period
  12 means 50 nano-seconds synchronous period
</code></pre>
<p>8.2 Set wide size</p>
<pre><code>setwide &lt;target&gt; &lt;size&gt;

target:    target number
size:      0=8 bits, 1=16bits
</code></pre>
<p>8.3 Set maximum number of concurrent tagged commands</p>
<pre><code>settags &lt;target&gt; &lt;tags&gt;

target:    target number
tags:      number of concurrent tagged commands
           must not be greater than configured (default: 16)
</code></pre>
<p>8.4 Set debug mode</p>
<pre><code>setdebug &lt;list of debug flags&gt;

Available debug flags:
    alloc:   print info about memory allocations (ccb, lcb)
    queue:   print info about insertions into the command start queue
    result:  print sense data on CHECK CONDITION status
    scatter: print info about the scatter process
    scripts: print info about the script binding process
tiny:    print minimal debugging information
timing:  print timing information of the NCR chip
nego:    print information about SCSI negotiations
phase:   print information on script interruptions

Use &quot;setdebug&quot; with no argument to reset debug flags.
</code></pre>
<p>8.5 Set flag (no_disc)</p>
<pre><code>setflag &lt;target&gt; &lt;flag&gt;

target:    target number

For the moment, only one flag is available:

    no_disc:   not allow target to disconnect.

Do not specify any flag in order to reset the flag. For example:
- setflag 4
  will reset no_disc flag for target 4, so will allow it disconnections.
- setflag all
  will allow disconnection for all devices on the SCSI bus.
</code></pre>
<p>8.6 Set verbose level</p>
<pre><code>setverbose #level

The driver default verbose level is 1. This command allows to change 
th driver verbose level after boot-up.
</code></pre>
<p>8.7 Reset all logical units of a target</p>
<pre><code>resetdev &lt;target&gt;

target:    target number
The driver will try to send a BUS DEVICE RESET message to the target.
</code></pre>
<p>8.8 Abort all tasks of all logical units of a target</p>
<pre><code>cleardev &lt;target&gt;

target:    target number
The driver will try to send a ABORT message to all the logical units 
of the target.
</code></pre>
<ol start="9">
<li>Configuration parameters</li>
</ol>
<p>Under kernel configuration tools (make menuconfig, for example), it is<br>possible to change some default driver configuration parameters.<br>If the firmware of all your devices is perfect enough, all the<br>features supported by the driver can be enabled at start-up. However,<br>if only one has a flaw for some SCSI feature, you can disable the<br>support by the driver of this feature at linux start-up and enable<br>this feature after boot-up only for devices that support it safely.</p>
<p>Configuration parameters:</p>
<p>Use normal IO                         (default answer: n)<br>    Answer “y” if you suspect your mother board to not allow memory mapped I/O.<br>    May slow down performance a little.</p>
<p>Default tagged command queue depth    (default answer: 16)<br>    Entering 0 defaults to tagged commands not being used.<br>    This parameter can be specified from the boot command line.</p>
<p>Maximum number of queued commands     (default answer: 32)<br>    This option allows you to specify the maximum number of tagged commands<br>    that can be queued to a device. The maximum supported value is 255.</p>
<p>Synchronous transfers frequency       (default answer: 80)<br>    This option allows you to specify the frequency in MHz the driver<br>    will use at boot time for synchronous data transfer negotiations.<br>    0 means “asynchronous data transfers”.</p>
<ol start="10">
<li>Boot setup commands</li>
</ol>
<p>10.1 Syntax</p>
<p>Setup commands can be passed to the driver either at boot time or as<br>parameters to modprobe, as described in Documentation/kernel-parameters.txt</p>
<p>Example of boot setup command under lilo prompt:</p>
<p>lilo: linux root=/dev/sda2 sym53c8xx.cmd_per_lun=4 sym53c8xx.sync=10 sym53c8xx.debug=0x200</p>
<ul>
<li>enable tagged commands, up to 4 tagged commands queued.</li>
<li>set synchronous negotiation speed to 10 Mega-transfers / second.</li>
<li>set DEBUG_NEGO flag.</li>
</ul>
<p>The following command will install the driver module with the same<br>options as above.</p>
<pre><code>modprobe sym53c8xx cmd_per_lun=4 sync=10 debug=0x200
</code></pre>
<p>10.2 Available arguments</p>
<p>10.2.1  Default number of tagged commands<br>        cmd_per_lun=0 (or cmd_per_lun=1) tagged command queuing disabled<br>        cmd_per_lun=#tags (#tags &gt; 1) tagged command queuing enabled<br>  #tags will be truncated to the max queued commands configuration parameter.</p>
<p>10.2.2 Burst max<br>        burst=0    burst disabled<br>        burst=255  get burst length from initial IO register settings.<br>        burst=#x   burst enabled (1&lt;&lt;#x burst transfers max)<br>  #x is an integer value which is log base 2 of the burst transfers max.<br>  By default the driver uses the maximum value supported by the chip.</p>
<p>10.2.3 LED support<br>        led=1      enable  LED support<br>        led=0      disable LED support<br>  Do not enable LED support if your scsi board does not use SDMS BIOS.<br>  (See ‘Configuration parameters’)</p>
<p>10.2.4 Differential mode<br>        diff=0    never set up diff mode<br>        diff=1    set up diff mode if BIOS set it<br>        diff=2    always set up diff mode<br>        diff=3    set diff mode if GPIO3 is not set</p>
<p>10.2.5 IRQ mode<br>        irqm=0     always open drain<br>        irqm=1     same as initial settings (assumed BIOS settings)<br>        irqm=2     always totem pole</p>
<p>10.2.6 Check SCSI BUS<br>        buschk=<option bits></p>
<pre><code>Available option bits:
    0x0:   No check.
    0x1:   Check and do not attach the controller on error.  
    0x2:   Check and just warn on error.
</code></pre>
<p>10.2.7 Suggest a default SCSI id for hosts<br>        hostid=255    no id suggested.<br>        hostid=#x   (0 &lt; x &lt; 7) x suggested for hosts SCSI id.</p>
<pre><code>If a host SCSI id is available from the NVRAM, the driver will ignore 
any value suggested as boot option. Otherwise, if a suggested value 
different from 255 has been supplied, it will use it. Otherwise, it will 
try to deduce the value previously set in the hardware and use value 
7 if the hardware value is zero.
</code></pre>
<p>10.2.8  Verbosity level<br>        verb=0     minimal<br>        verb=1     normal<br>        verb=2     too much</p>
<p>10.2.9 Debug mode<br>        debug=0     clear debug flags<br>        debug=#x   set debug flags<br>  #x is an integer value combining the following power-of-2 values:<br>  DEBUG_ALLOC       0x1<br>  DEBUG_PHASE       0x2<br>  DEBUG_POLL        0x4<br>  DEBUG_QUEUE       0x8<br>  DEBUG_RESULT     0x10<br>  DEBUG_SCATTER    0x20<br>  DEBUG_SCRIPT     0x40<br>  DEBUG_TINY       0x80<br>  DEBUG_TIMING    0x100<br>  DEBUG_NEGO      0x200<br>  DEBUG_TAGS      0x400<br>  DEBUG_FREEZE    0x800<br>  DEBUG_RESTART  0x1000</p>
<p>  You can play safely with DEBUG_NEGO. However, some of these flags may<br>  generate bunches of syslog messages. </p>
<p>10.2.10 Settle delay<br>        settle=n    delay for n seconds</p>
<p>  After a bus reset, the driver will delay for n seconds before talking<br>  to any device on the bus.  The default is 3 seconds and safe mode will<br>  default it to 10.</p>
<p>10.2.11 Serial NVRAM<br>    NB: option not currently implemented.<br>        nvram=n     do not look for serial NVRAM<br>        nvram=y     test controllers for onboard serial NVRAM<br>        (alternate binary form)<br>        nvram=<bits options><br>        0x01   look for NVRAM  (equivalent to nvram=y)<br>        0x02   ignore NVRAM “Synchronous negotiation” parameters for all devices<br>        0x04   ignore NVRAM “Wide negotiation”  parameter for all devices<br>        0x08   ignore NVRAM “Scan at boot time” parameter for all devices<br>        0x80   also attach controllers set to OFF in the NVRAM (sym53c8xx only)</p>
<p>10.2.12 Exclude a host from being attached<br>        excl=<io_address>,…</p>
<pre><code>Prevent host at a given io address from being attached.
For example &#39;excl=0xb400,0xc000&#39; indicate to the 
driver not to attach hosts at address 0xb400 and 0xc000.
</code></pre>
<p>10.3 Converting from old style options</p>
<p>Previously, the sym2 driver accepted arguments of the form<br>    sym53c8xx=tags:4,sync:10,debug:0x200</p>
<p>As a result of the new module parameters, this is no longer available.<br>Most of the options have remained the same, but tags has become<br>cmd_per_lun to reflect its different purposes.  The sample above would<br>be specified as:<br>    modprobe sym53c8xx cmd_per_lun=4 sync=10 debug=0x200</p>
<p>or on the kernel boot line as:<br>    sym53c8xx.cmd_per_lun=4 sym53c8xx.sync=10 sym53c8xx.debug=0x200</p>
<p>10.4 SCSI BUS checking boot option.</p>
<p>When this option is set to a non-zero value, the driver checks SCSI lines<br>logic state, 100 micro-seconds after having asserted the SCSI RESET line.<br>The driver just reads SCSI lines and checks all lines read FALSE except RESET.<br>Since SCSI devices shall release the BUS at most 800 nano-seconds after SCSI<br>RESET has been asserted, any signal to TRUE may indicate a SCSI BUS problem.<br>Unfortunately, the following common SCSI BUS problems are not detected:</p>
<ul>
<li>Only 1 terminator installed.</li>
<li>Misplaced terminators.</li>
<li>Bad quality terminators.<br>On the other hand, either bad cabling, broken devices, not conformant<br>devices, … may cause a SCSI signal to be wrong when te driver reads it.</li>
</ul>
<ol start="15">
<li>SCSI problem troubleshooting</li>
</ol>
<p>15.1 Problem tracking</p>
<p>Most SCSI problems are due to a non conformant SCSI bus or too buggy<br>devices.  If unfortunately you have SCSI problems, you can check the<br>following things:</p>
<ul>
<li>SCSI bus cables</li>
<li>terminations at both end of the SCSI chain</li>
<li>linux syslog messages (some of them may help you)</li>
</ul>
<p>If you do not find the source of problems, you can configure the<br>driver or devices in the NVRAM with minimal features.</p>
<ul>
<li>only asynchronous data transfers</li>
<li>tagged commands disabled</li>
<li>disconnections not allowed</li>
</ul>
<p>Now, if your SCSI bus is ok, your system has every chance to work<br>with this safe configuration but performances will not be optimal.</p>
<p>If it still fails, then you can send your problem description to<br>appropriate mailing lists or news-groups.  Send me a copy in order to<br>be sure I will receive it.  Obviously, a bug in the driver code is<br>possible.</p>
<p>  My current email address: Gerard Roudier <a href="mailto:&#103;&#114;&#111;&#117;&#x64;&#x69;&#x65;&#114;&#64;&#x66;&#x72;&#101;&#x65;&#46;&#x66;&#114;">&#103;&#114;&#111;&#117;&#x64;&#x69;&#x65;&#114;&#64;&#x66;&#x72;&#101;&#x65;&#46;&#x66;&#114;</a></p>
<p>Allowing disconnections is important if you use several devices on<br>your SCSI bus but often causes problems with buggy devices.<br>Synchronous data transfers increases throughput of fast devices like<br>hard disks.  Good SCSI hard disks with a large cache gain advantage of<br>tagged commands queuing.</p>
<p>15.2 Understanding hardware error reports</p>
<p>When the driver detects an unexpected error condition, it may display a<br>message of the following pattern.</p>
<p>sym0:1: ERROR (0:48) (1-21-65) (f/95/0) @ (script 7c0:19000000).<br>sym0: script cmd = 19000000<br>sym0: regdump: da 10 80 95 47 0f 01 07 75 01 81 21 80 01 09 00.</p>
<p>Some fields in such a message may help you understand the cause of the<br>problem, as follows:</p>
<p>sym0:1: ERROR (0:48) (1-21-65) (f/95/0) @ (script 7c0:19000000).<br>…..A………B.C….D.E..F….G.H..I…….J…..K…L…….</p>
<p>Field A : target number.<br>  SCSI ID of the device the controller was talking with at the moment the<br>  error occurs.</p>
<p>Field B : DSTAT io register (DMA STATUS)<br>  Bit 0x40 : MDPE Master Data Parity Error<br>             Data parity error detected on the PCI BUS.<br>  Bit 0x20 : BF   Bus Fault<br>             PCI bus fault condition detected<br>  Bit 0x01 : IID  Illegal Instruction Detected<br>             Set by the chip when it detects an Illegal Instruction format<br>             on some condition that makes an instruction illegal.<br>  Bit 0x80 : DFE Dma Fifo Empty<br>             Pure status bit that does not indicate an error.<br>  If the reported DSTAT value contains a combination of MDPE (0x40),<br>  BF (0x20), then the cause may be likely due to a PCI BUS problem.</p>
<p>Field C : SIST io register (SCSI Interrupt Status)<br>  Bit 0x08 : SGE  SCSI GROSS ERROR<br>             Indicates that the chip detected a severe error condition<br>             on the SCSI BUS that prevents the SCSI protocol from functioning<br>             properly.<br>  Bit 0x04 : UDC  Unexpected Disconnection<br>             Indicates that the device released the SCSI BUS when the chip<br>             was not expecting this to happen. A device may behave so to<br>             indicate the SCSI initiator that an error condition not reportable              using the SCSI protocol has occurred.<br>  Bit 0x02 : RST  SCSI BUS Reset<br>             Generally SCSI targets do not reset the SCSI BUS, although any<br>             device on the BUS can reset it at any time.<br>  Bit 0x01 : PAR  Parity<br>             SCSI parity error detected.<br>  On a faulty SCSI BUS, any error condition among SGE (0x08), UDC (0x04) and<br>  PAR (0x01) may be detected by the chip. If your SCSI system sometimes<br>  encounters such error conditions, especially SCSI GROSS ERROR, then a SCSI<br>  BUS problem is likely the cause of these errors.</p>
<p>For fields D,E,F,G and H, you may look into the sym53c8xx_defs.h file<br>that contains some minimal comments on IO register bits.<br>Field D : SOCL  Scsi Output Control Latch<br>          This register reflects the state of the SCSI control lines the<br>          chip want to drive or compare against.<br>Field E : SBCL  Scsi Bus Control Lines<br>          Actual value of control lines on the SCSI BUS.<br>Field F : SBDL  Scsi Bus Data Lines<br>          Actual value of data lines on the SCSI BUS.<br>Field G : SXFER  SCSI Transfer<br>          Contains the setting of the Synchronous Period for output and<br>          the current Synchronous offset (offset 0 means asynchronous).<br>Field H : SCNTL3 Scsi Control Register 3<br>          Contains the setting of timing values for both asynchronous and<br>          synchronous data transfers.<br>Field I : SCNTL4 Scsi Control Register 4<br>          Only meaningful for 53C1010 Ultra3 controllers.</p>
<p>Understanding Fields J, K, L and dumps requires to have good knowledge of<br>SCSI standards, chip cores functionnals and internal driver data structures.<br>You are not required to decode and understand them, unless you want to help<br>maintain the driver code.</p>
<ol start="17">
<li>Serial NVRAM (added by Richard Waltham: <a href="mailto:&#x64;&#111;&#x72;&#x6d;&#111;&#117;&#x73;&#101;&#64;&#x66;&#97;&#114;&#115;&#114;&#x6f;&#x62;&#x74;&#x2e;&#100;&#x65;&#109;&#x6f;&#x6e;&#x2e;&#x63;&#x6f;&#46;&#117;&#107;">&#x64;&#111;&#x72;&#x6d;&#111;&#117;&#x73;&#101;&#64;&#x66;&#97;&#114;&#115;&#114;&#x6f;&#x62;&#x74;&#x2e;&#100;&#x65;&#109;&#x6f;&#x6e;&#x2e;&#x63;&#x6f;&#46;&#117;&#107;</a>)</li>
</ol>
<p>17.1 Features</p>
<p>Enabling serial NVRAM support enables detection of the serial NVRAM included<br>on Symbios and some Symbios compatible host adaptors, and Tekram boards. The<br>serial NVRAM is used by Symbios and Tekram to hold set up parameters for the<br>host adaptor and its attached drives.</p>
<p>The Symbios NVRAM also holds data on the boot order of host adaptors in a<br>system with more than one host adaptor.  This information is no longer used<br>as it’s fundamentally incompatible with the hotplug PCI model.</p>
<p>Tekram boards using Symbios chips, DC390W/F/U, which have NVRAM are detected<br>and this is used to distinguish between Symbios compatible and Tekram host<br>adaptors. This is used to disable the Symbios compatible “diff” setting<br>incorrectly set on Tekram boards if the CONFIG_SCSI_53C8XX_SYMBIOS_COMPAT<br>configuration parameter is set enabling both Symbios and Tekram boards to be<br>used together with the Symbios cards using all their features, including<br>“diff” support. (“led pin” support for Symbios compatible cards can remain<br>enabled when using Tekram cards. It does nothing useful for Tekram host<br>adaptors but does not cause problems either.)</p>
<p>The parameters the driver is able to get from the NVRAM depend on the<br>data format used, as follow:</p>
<pre><code>                             Tekram format      Symbios format
</code></pre>
<p>General and host parameters<br>    Boot order                         N                   Y<br>    Host SCSI ID                       Y                   Y<br>    SCSI parity checking               Y                   Y<br>    Verbose boot messages              N                   Y<br>SCSI devices parameters<br>    Synchronous transfer speed         Y                   Y<br>    Wide 16 / Narrow                   Y                   Y<br>    Tagged Command Queuing enabled     Y                   Y<br>    Disconnections enabled             Y                   Y<br>    Scan at boot time                  N                   Y</p>
<p>In order to speed up the system boot, for each device configured without<br>the “scan at boot time” option, the driver forces an error on the<br>first TEST UNIT READY command received for this device.</p>
<p>17.2 Symbios NVRAM layout</p>
<h2 id="typical-data-at-NVRAM-address-0x100-53c810a-NVRAM"><a href="#typical-data-at-NVRAM-address-0x100-53c810a-NVRAM" class="headerlink" title="typical data at NVRAM address 0x100 (53c810a NVRAM)"></a>typical data at NVRAM address 0x100 (53c810a NVRAM)</h2><p>00 00<br>64 01<br>8e 0b</p>
<p>00 30 00 00 00 00 07 00 00 00 00 00 00 00 07 04 10 04 00 00 </p>
<p>04 00 0f 00 00 10 00 50 00 00 01 00 00 62<br>04 00 03 00 00 10 00 58 00 00 01 00 00 63<br>04 00 01 00 00 10 00 48 00 00 01 00 00 61<br>00 00 00 00 00 00 00 00 00 00 00 00 00 00 </p>
<p>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00 </p>
<p>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00 </p>
<p>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00 </p>
<p>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00 </p>
<p>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00<br>00 00 00 00 00 00 00 00 </p>
<p>fe fe<br>00 00<br>00 00</p>
<hr>
<p>NVRAM layout details</p>
<p>NVRAM Address 0x000-0x0ff not used<br>              0x100-0x26f initialised data<br>              0x270-0x7ff not used</p>
<p>general layout</p>
<pre><code>    header  -   6 bytes,
    data    - 356 bytes (checksum is byte sum of this data)
    trailer -   6 bytes
              ---
    total     368 bytes
</code></pre>
<p>data area layout</p>
<pre><code>    controller set up  -  20 bytes
    boot configuration -  56 bytes (4x14 bytes)
    device set up      - 128 bytes (16x8 bytes)
    unused (spare?)    - 152 bytes (19x8 bytes)
                         ---
    total                356 bytes
</code></pre>
<hr>
<p>header</p>
<p>00 00   - ?? start marker<br>64 01   - byte count (lsb/msb excludes header/trailer)<br>8e 0b   - checksum (lsb/msb excludes header/trailer)</p>
<hr>
<p>controller set up</p>
<p>00 30 00 00 00 00 07 00 00 00 00 00 00 00 07 04 10 04 00 00<br>                   |     |           |     |<br>                   |     |           |      – host ID<br>                   |     |           |<br>                   |     |            –Removable Media Support<br>                   |     |               0x00 = none<br>                   |     |               0x01 = Bootable Device<br>                   |     |               0x02 = All with Media<br>                   |     |<br>                   |      –flag bits 2<br>                   |        0x00000001= scan order hi-&gt;low<br>                   |            (default 0x00 - scan low-&gt;hi)<br>                    –flag bits 1<br>                       0x00000001 scam enable<br>                       0x00000010 parity enable<br>                       0x00000100 verbose boot msgs</p>
<p>remaining bytes unknown - they do not appear to change in my<br>current set up for any of the controllers.</p>
<p>default set up is identical for 53c810a and 53c875 NVRAM<br>(Removable Media added Symbios BIOS version 4.09)</p>
<hr>
<p>boot configuration</p>
<p>boot order set by order of the devices in this table</p>
<p>04 00 0f 00 00 10 00 50 00 00 01 00 00 62 – 1st controller<br>04 00 03 00 00 10 00 58 00 00 01 00 00 63    2nd controller<br>04 00 01 00 00 10 00 48 00 00 01 00 00 61    3rd controller<br>00 00 00 00 00 00 00 00 00 00 00 00 00 00    4th controller<br>       |  |  |  |     |        |     |  |<br>       |  |  |  |     |        |      —- PCI io port adr<br>       |  |  |  |     |         –0x01 init/scan at boot time<br>       |  |  |  |      –PCI device/function number (0xdddddfff)<br>       |  |   —– ?? PCI vendor ID (lsb/msb)<br>        —-PCI device ID (lsb/msb)</p>
<p>?? use of this data is a guess but seems reasonable</p>
<p>remaining bytes unknown - they do not appear to change in my<br>current set up</p>
<h2 id="default-set-up-is-identical-for-53c810a-and-53c875-NVRAM"><a href="#default-set-up-is-identical-for-53c810a-and-53c875-NVRAM" class="headerlink" title="default set up is identical for 53c810a and 53c875 NVRAM"></a>default set up is identical for 53c810a and 53c875 NVRAM</h2><p>device set up (up to 16 devices - includes controller)</p>
<p>0f 00 08 08 64 00 0a 00 - id 0<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00 </p>
<p>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00<br>0f 00 08 08 64 00 0a 00 - id 15<br> |     |  |  |     |  |<br> |     |  |  |      —-timeout (lsb/msb)<br> |     |  |   –synch period (0x?? 40 Mtrans/sec- fast 40) (probably 0x28)<br> |     |  |                  (0x30 20 Mtrans/sec- fast 20)<br> |     |  |                  (0x64 10 Mtrans/sec- fast )<br> |     |  |                  (0xc8  5 Mtrans/sec)<br> |     |  |                  (0x00  asynchronous)<br> |     |   – ?? max sync offset (0x08 in NVRAM on 53c810a)<br> |     |                         (0x10 in NVRAM on 53c875)<br> |      –device bus width (0x08 narrow)<br> |                         (0x10 16 bit wide)<br>  –flag bits<br>    0x00000001 - disconnect enabled<br>    0x00000010 - scan at boot time<br>    0x00000100 - scan luns<br>    0x00001000 - queue tags enabled</p>
<p>remaining bytes unknown - they do not appear to change in my<br>current set up</p>
<p>?? use of this data is a guess but seems reasonable<br>(but it could be max bus width)</p>
<p>default set up for 53c810a NVRAM<br>default set up for 53c875 NVRAM - bus width     - 0x10<br>                                - sync offset ? - 0x10<br>                                - sync period   - 0x30</p>
<hr>
<p>?? spare device space (32 bit bus ??)</p>
<p>00 00 00 00 00 00 00 00  (19x8bytes)<br>.<br>.<br>00 00 00 00 00 00 00 00</p>
<h2 id="default-set-up-is-identical-for-53c810a-and-53c875-NVRAM-1"><a href="#default-set-up-is-identical-for-53c810a-and-53c875-NVRAM-1" class="headerlink" title="default set up is identical for 53c810a and 53c875 NVRAM"></a>default set up is identical for 53c810a and 53c875 NVRAM</h2><p>trailer</p>
<p>fe fe   - ? end marker ?<br>00 00<br>00 00</p>
<h2 id="default-set-up-is-identical-for-53c810a-and-53c875-NVRAM-2"><a href="#default-set-up-is-identical-for-53c810a-and-53c875-NVRAM-2" class="headerlink" title="default set up is identical for 53c810a and 53c875 NVRAM"></a>default set up is identical for 53c810a and 53c875 NVRAM</h2><p>17.3 Tekram NVRAM layout</p>
<p>nvram 64x16 (1024 bit)</p>
<p>Drive settings</p>
<p>Drive ID 0-15 (addr 0x0yyyy0 = device setup, yyyy = ID)<br>              (addr 0x0yyyy1 = 0x0000)</p>
<pre><code>x x x x  x x x x  x x x x  x x x x
           | | |      | |  | | | |
           | | |      | |  | | |  ----- parity check   0 - off
           | | |      | |  | | |                       1 - on
           | | |      | |  | | |
           | | |      | |  | |  ------- sync neg       0 - off
           | | |      | |  | |                         1 - on
           | | |      | |  | |
           | | |      | |  |  --------- disconnect     0 - off
           | | |      | |  |                           1 - on
           | | |      | |  |
           | | |      | |   ----------- start cmd      0 - off
           | | |      | |                              1 - on
           | | |      | |
           | | |      |  -------------- tagged cmds    0 - off
           | | |      |                                1 - on
           | | |      | 
           | | |       ---------------- wide neg       0 - off
           | | |                                       1 - on
           | | |
            --------------------------- sync rate      0 - 10.0 Mtrans/sec
                                                       1 -  8.0
                                                       2 -  6.6
                                                       3 -  5.7
                                                       4 -  5.0
                                                       5 -  4.0
                                                       6 -  3.0
                                                       7 -  2.0
                                                       7 -  2.0
                                                       8 - 20.0
                                                       9 - 16.7
                                                       a - 13.9
                                                       b - 11.9
</code></pre>
<p>Global settings</p>
<p>Host flags 0 (addr 0x100000, 32) </p>
<pre><code>x x x x  x x x x  x x x x  x x x x
| | | |  | | | |           | | | |
| | | |  | | | |            ----------- host ID    0x00 - 0x0f
| | | |  | | | |
| | | |  | | |  ----------------------- support for    0 - off
| | | |  | | |                          &gt; 2 drives     1 - on
| | | |  | | | 
| | | |  | |  ------------------------- support drives 0 - off
| | | |  | |                            &gt; 1Gbytes      1 - on
| | | |  | |
| | | |  |  --------------------------- bus reset on   0 - off
| | | |  |                                power on     1 - on
| | | |  |
| | | |   ----------------------------- active neg     0 - off
| | | |                                                1 - on
| | | |
| | |  -------------------------------- imm seek       0 - off
| | |                                                  1 - on
| | |
| |  ---------------------------------- scan luns      0 - off
| |                                                    1 - on
| |
 -------------------------------------- removable      0 - disable
                                        as BIOS dev    1 - boot device
                                                       2 - all
</code></pre>
<p>Host flags 1 (addr 0x100001, 33)</p>
<pre><code>x x x x  x x x x  x x x x  x x x x
           | | |             | | | 
           | | |              --------- boot delay     0 -   3 sec
           | | |                                       1 -   5
           | | |                                       2 -  10
           | | |                                       3 -  20
           | | |                                       4 -  30
           | | |                                       5 -  60
           | | |                                       6 - 120
           | | |
            --------------------------- max tag cmds   0 -  2
                                                       1 -  4
                                                       2 -  8
                                                       3 - 16
                                                       4 - 32
</code></pre>
<p>Host flags 2 (addr 0x100010, 34)</p>
<pre><code>x x x x  x x x x  x x x x  x x x x
                                 |
                                  ----- F2/F6 enable   0 - off ???
                                                       1 - on  ???
</code></pre>
<p>checksum (addr 0x111111)</p>
<p>checksum = 0x1234 - (sum addr 0-63)</p>
<hr>
<p>default nvram data:</p>
<p>0x0037 0x0000 0x0037 0x0000 0x0037 0x0000 0x0037 0x0000<br>0x0037 0x0000 0x0037 0x0000 0x0037 0x0000 0x0037 0x0000<br>0x0037 0x0000 0x0037 0x0000 0x0037 0x0000 0x0037 0x0000<br>0x0037 0x0000 0x0037 0x0000 0x0037 0x0000 0x0037 0x0000 </p>
<p>0x0f07 0x0400 0x0001 0x0000 0x0000 0x0000 0x0000 0x0000<br>0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0x0000<br>0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0x0000<br>0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0xfbbc</p>
<p>===============================================================================<br>End of Linux SYM-2 driver documentation file</p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_sym53c8xx_2/" title="Kernel-3.10.0-957.el7_sym53c8xx_2" target="_blank" rel="external">http://www.oostech.com/2021/03/13/Kernel-3.10.0-957.el7_sym53c8xx_2/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">oosTech by Sam Lee</span><small class="ml-1x"></small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    

  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/03/13/Kernel-3.10.0-957.el7_unevictable-lru/" title="Kernel-3.10.0-957.el7_unevictable-lru"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/03/13/Kernel-3.10.0-957.el7_sentelic/" title="Kernel-3.10.0-957.el7_sentelic"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,wechat"></div>
    
  </div>
  </div>
    <div class="container" align="left">
    <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
      <img src="/images/wechatp.png" itemprop="contentUrl">
      <span>欢迎关注公众号</span>
    </div>
    </div>
</nav>

  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>您能有收获就是我们最大的动力</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码捐赠</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">不管多少都是对分享的肯定</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码捐赠</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://google.com/" target="_blank" title="Google" data-toggle=tooltip data-placement=top><i class="icon icon-google"></i></a></li>
        
        <li><a href="https://twitter.com/" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
	<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn" text-align: center >粤ICP备2021024811号</a>
        </div>
<!--    
    <div>
     <img src="/images/logo.png" width="140" height="140">
    </div>
-->
    </div>


        <!-- 不蒜子统计    //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <!--<span id="busuanzi_container_site_pv" style="display:inline;">-->本站总访问量<span id="busuanzi_value_site_pv" style="display:inline;></span>次</span>
        <span class="post-meta-divider">|</span>
  
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>







   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>











</body>
</html>